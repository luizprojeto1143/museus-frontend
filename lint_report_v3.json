[{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\App.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\api\\client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\LanguageSwitcher.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\accessibility\\AccessibilityMenu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\accessibility\\AccessibilityProvider.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":28,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":28,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, createContext, useContext } from 'react';\r\n\r\ninterface AccessibilitySettings {\r\n    fontSize: 'small' | 'normal' | 'large' | 'xlarge';\r\n    highContrast: boolean;\r\n    reducedMotion: boolean;\r\n    dyslexicFont: boolean;\r\n}\r\n\r\ninterface AccessibilityContextValue {\r\n    settings: AccessibilitySettings;\r\n    setFontSize: (size: AccessibilitySettings['fontSize']) => void;\r\n    toggleHighContrast: () => void;\r\n    toggleReducedMotion: () => void;\r\n    toggleDyslexicFont: () => void;\r\n    resetSettings: () => void;\r\n}\r\n\r\nconst defaultSettings: AccessibilitySettings = {\r\n    fontSize: 'normal',\r\n    highContrast: false,\r\n    reducedMotion: false,\r\n    dyslexicFont: false\r\n};\r\n\r\nconst AccessibilityContext = createContext<AccessibilityContextValue | null>(null);\r\n\r\nexport const useAccessibility = () => {\r\n    const context = useContext(AccessibilityContext);\r\n    if (!context) {\r\n        throw new Error('useAccessibility must be used within AccessibilityProvider');\r\n    }\r\n    return context;\r\n};\r\n\r\nexport const AccessibilityProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    const [settings, setSettings] = useState<AccessibilitySettings>(() => {\r\n        const saved = localStorage.getItem('accessibility-settings');\r\n        return saved ? JSON.parse(saved) : defaultSettings;\r\n    });\r\n\r\n    useEffect(() => {\r\n        localStorage.setItem('accessibility-settings', JSON.stringify(settings));\r\n\r\n        // Apply to document\r\n        const root = document.documentElement;\r\n\r\n        // Font size\r\n        const fontSizes = { small: '14px', normal: '16px', large: '18px', xlarge: '20px' };\r\n        root.style.setProperty('--base-font-size', fontSizes[settings.fontSize]);\r\n\r\n        // High contrast\r\n        if (settings.highContrast) {\r\n            root.classList.add('high-contrast');\r\n        } else {\r\n            root.classList.remove('high-contrast');\r\n        }\r\n\r\n        // Reduced motion\r\n        if (settings.reducedMotion) {\r\n            root.classList.add('reduced-motion');\r\n        } else {\r\n            root.classList.remove('reduced-motion');\r\n        }\r\n\r\n        // Dyslexic font\r\n        if (settings.dyslexicFont) {\r\n            root.classList.add('dyslexic-font');\r\n        } else {\r\n            root.classList.remove('dyslexic-font');\r\n        }\r\n    }, [settings]);\r\n\r\n    const setFontSize = (size: AccessibilitySettings['fontSize']) => {\r\n        setSettings(prev => ({ ...prev, fontSize: size }));\r\n    };\r\n\r\n    const toggleHighContrast = () => {\r\n        setSettings(prev => ({ ...prev, highContrast: !prev.highContrast }));\r\n    };\r\n\r\n    const toggleReducedMotion = () => {\r\n        setSettings(prev => ({ ...prev, reducedMotion: !prev.reducedMotion }));\r\n    };\r\n\r\n    const toggleDyslexicFont = () => {\r\n        setSettings(prev => ({ ...prev, dyslexicFont: !prev.dyslexicFont }));\r\n    };\r\n\r\n    const resetSettings = () => {\r\n        setSettings(defaultSettings);\r\n    };\r\n\r\n    return (\r\n        <AccessibilityContext.Provider value={{\r\n            settings,\r\n            setFontSize,\r\n            toggleHighContrast,\r\n            toggleReducedMotion,\r\n            toggleDyslexicFont,\r\n            resetSettings\r\n        }}>\r\n            {children}\r\n            <style>{`\r\n                :root {\r\n                    --base-font-size: 16px;\r\n                }\r\n                \r\n                html {\r\n                    font-size: var(--base-font-size);\r\n                }\r\n                \r\n                /* High Contrast Mode */\r\n                .high-contrast {\r\n                    --bg-page: #000000 !important;\r\n                    --bg-card: #1a1a1a !important;\r\n                    --fg-main: #ffffff !important;\r\n                    --fg-muted: #e0e0e0 !important;\r\n                    --primary-color: #00ff00 !important;\r\n                    --accent-color: #ffff00 !important;\r\n                }\r\n                \r\n                .high-contrast * {\r\n                    border-color: #ffffff !important;\r\n                }\r\n                \r\n                .high-contrast a,\r\n                .high-contrast button {\r\n                    text-decoration: underline !important;\r\n                }\r\n                \r\n                /* Reduced Motion */\r\n                .reduced-motion *,\r\n                .reduced-motion *::before,\r\n                .reduced-motion *::after {\r\n                    animation-duration: 0.001ms !important;\r\n                    animation-iteration-count: 1 !important;\r\n                    transition-duration: 0.001ms !important;\r\n                }\r\n                \r\n                /* Dyslexic-Friendly Font */\r\n                .dyslexic-font {\r\n                    font-family: 'OpenDyslexic', 'Comic Sans MS', sans-serif !important;\r\n                    letter-spacing: 0.05em;\r\n                    word-spacing: 0.1em;\r\n                    line-height: 1.8;\r\n                }\r\n                \r\n                /* Focus Styles - Always Visible */\r\n                *:focus {\r\n                    outline: 3px solid var(--primary-color, #3b82f6) !important;\r\n                    outline-offset: 2px !important;\r\n                }\r\n                \r\n                *:focus:not(:focus-visible) {\r\n                    outline: none !important;\r\n                }\r\n                \r\n                *:focus-visible {\r\n                    outline: 3px solid var(--primary-color, #3b82f6) !important;\r\n                    outline-offset: 2px !important;\r\n                }\r\n            `}</style>\r\n        </AccessibilityContext.Provider>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\accessibility\\AudioDescriptionPlayer.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\accessibility\\AudioDescriptionPlayer.tsx:19:7\n  17 |       // Reset state on src change\n  18 |       // eslint-disable-next-line react-hooks/set-state-in-effect\n> 19 |       setIsPlaying(false);\n     |       ^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  20 |       setCurrentTime(0);\n  21 |     }\n  22 |   }, [src]);","line":19,"column":7,"nodeType":null,"endLine":19,"endColumn":19,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\accessibility\\LibrasPlayer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\accessibility\\SkipLinks.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\accessibility\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\gamification\\ChallengeWidget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\navigation\\NavigateButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\navigation\\NavigationModal.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has missing dependencies: 'calculateRoute' and 'userLocation'. Either include them or remove the dependency array.","line":290,"column":8,"nodeType":"ArrayExpression","endLine":290,"endColumn":17,"suggestions":[{"desc":"Update the dependencies array to be: [calculateRoute, profile, userLocation]","fix":{"range":[10679,10688],"text":"[calculateRoute, profile, userLocation]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef, useCallback } from \"react\";\r\n// import { useTranslation } from \"react-i18next\";\r\nimport L from \"leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport {\r\n    getDirections,\r\n    formatDistance,\r\n    formatDuration,\r\n    getGoogleMapsUrl,\r\n    NavigationRoute,\r\n    NavigationProfile\r\n} from \"../../services/navigationService\";\r\n\r\ninterface NavigationModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    destination: {\r\n        lat: number;\r\n        lng: number;\r\n        name: string;\r\n    };\r\n}\r\n\r\n// Calculate distance between two points (Haversine)\r\nfunction getDistanceBetweenPoints(\r\n    lat1: number, lon1: number,\r\n    lat2: number, lon2: number\r\n): number {\r\n    const R = 6371e3;\r\n    const œÜ1 = (lat1 * Math.PI) / 180;\r\n    const œÜ2 = (lat2 * Math.PI) / 180;\r\n    const ŒîœÜ = ((lat2 - lat1) * Math.PI) / 180;\r\n    const ŒîŒª = ((lon2 - lon1) * Math.PI) / 180;\r\n\r\n    const a = Math.sin(ŒîœÜ / 2) * Math.sin(ŒîœÜ / 2) +\r\n        Math.cos(œÜ1) * Math.cos(œÜ2) * Math.sin(ŒîŒª / 2) * Math.sin(ŒîŒª / 2);\r\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n    return R * c;\r\n}\r\n\r\nexport const NavigationModal: React.FC<NavigationModalProps> = ({\r\n    isOpen,\r\n    onClose,\r\n    destination\r\n}) => {\r\n\r\n    const mapRef = useRef<HTMLDivElement>(null);\r\n    const mapInstanceRef = useRef<L.Map | null>(null);\r\n    const routeLayerRef = useRef<L.Polyline | null>(null);\r\n    const userMarkerRef = useRef<L.Marker | null>(null);\r\n    const watchIdRef = useRef<number | null>(null);\r\n\r\n    const [userLocation, setUserLocation] = useState<{ lat: number; lng: number } | null>(null);\r\n    const [route, setRoute] = useState<NavigationRoute | null>(null);\r\n    const [profile, setProfile] = useState<NavigationProfile>(\"foot-walking\");\r\n    const [loading, setLoading] = useState(false);\r\n    const [error, setError] = useState<string | null>(null);\r\n    const [gettingLocation, setGettingLocation] = useState(true);\r\n\r\n    // Real-time navigation state\r\n    const [isNavigating, setIsNavigating] = useState(false);\r\n    const [remainingDistance, setRemainingDistance] = useState<number>(0);\r\n    const [currentStepIndex, setCurrentStepIndex] = useState(0);\r\n    const [hasArrived, setHasArrived] = useState(false);\r\n\r\n    // Get current step\r\n    const currentStep = route?.steps?.[currentStepIndex];\r\n    const nextStep = route?.steps?.[currentStepIndex + 1];\r\n\r\n    // Calculate remaining distance to destination\r\n    const updateRemainingDistance = useCallback((userLat: number, userLng: number) => {\r\n        const dist = getDistanceBetweenPoints(userLat, userLng, destination.lat, destination.lng);\r\n        setRemainingDistance(dist);\r\n\r\n        // Check if arrived (within 20 meters)\r\n        if (dist < 20) {\r\n            setHasArrived(true);\r\n            // Vibrate if supported\r\n            if (navigator.vibrate) {\r\n                navigator.vibrate([200, 100, 200]);\r\n            }\r\n        }\r\n    }, [destination]);\r\n\r\n    // Update current step based on position\r\n    const updateCurrentStep = useCallback((userLat: number, userLng: number) => {\r\n        if (!route?.steps || route.steps.length === 0) return;\r\n\r\n        // Simple heuristic: move to next step when close to it\r\n        // In a real app, this would use the route geometry to determine progress\r\n        const distToDest = getDistanceBetweenPoints(userLat, userLng, destination.lat, destination.lng);\r\n\r\n        // Calculate progress percentage\r\n        const totalDist = route.distance;\r\n        const progressPct = 1 - (distToDest / totalDist);\r\n\r\n        // Estimate which step we're on based on progress\r\n        const estimatedStep = Math.floor(progressPct * route.steps.length);\r\n        if (estimatedStep > currentStepIndex && estimatedStep < route.steps.length) {\r\n            setCurrentStepIndex(estimatedStep);\r\n        }\r\n    }, [route, currentStepIndex, destination]);\r\n\r\n    // Start real-time tracking\r\n    const startNavigation = useCallback(() => {\r\n        if (!navigator.geolocation) {\r\n            setError(\"Geolocaliza√ß√£o n√£o suportada\");\r\n            return;\r\n        }\r\n\r\n        setIsNavigating(true);\r\n        setHasArrived(false);\r\n        setCurrentStepIndex(0);\r\n\r\n        // Watch position for real-time updates\r\n        watchIdRef.current = navigator.geolocation.watchPosition(\r\n            (position) => {\r\n                const newLoc = {\r\n                    lat: position.coords.latitude,\r\n                    lng: position.coords.longitude\r\n                };\r\n                setUserLocation(newLoc);\r\n                updateRemainingDistance(newLoc.lat, newLoc.lng);\r\n                updateCurrentStep(newLoc.lat, newLoc.lng);\r\n            },\r\n            (err) => {\r\n                console.error(\"Erro GPS:\", err);\r\n                setError(\"Erro ao rastrear localiza√ß√£o\");\r\n            },\r\n            {\r\n                enableHighAccuracy: true,\r\n                timeout: 10000,\r\n                maximumAge: 1000 // Update every second\r\n            }\r\n        );\r\n    }, [updateRemainingDistance, updateCurrentStep]);\r\n\r\n    // Stop navigation\r\n    const stopNavigation = useCallback(() => {\r\n        if (watchIdRef.current !== null) {\r\n            navigator.geolocation.clearWatch(watchIdRef.current);\r\n            watchIdRef.current = null;\r\n        }\r\n        setIsNavigating(false);\r\n    }, []);\r\n\r\n    // Cleanup on unmount\r\n    useEffect(() => {\r\n        return () => {\r\n            stopNavigation();\r\n        };\r\n    }, [stopNavigation]);\r\n\r\n    // Get initial location\r\n    useEffect(() => {\r\n        if (!isOpen) return;\r\n\r\n        setGettingLocation(true);\r\n        if (navigator.geolocation) {\r\n            navigator.geolocation.getCurrentPosition(\r\n                (position) => {\r\n                    const loc = {\r\n                        lat: position.coords.latitude,\r\n                        lng: position.coords.longitude\r\n                    };\r\n                    setUserLocation(loc);\r\n                    setRemainingDistance(getDistanceBetweenPoints(loc.lat, loc.lng, destination.lat, destination.lng));\r\n                    setGettingLocation(false);\r\n                },\r\n                (err) => {\r\n                    console.error(\"Erro ao obter localiza√ß√£o:\", err);\r\n                    setError(\"N√£o foi poss√≠vel obter sua localiza√ß√£o.\");\r\n                    setGettingLocation(false);\r\n                },\r\n                { enableHighAccuracy: true }\r\n            );\r\n        } else {\r\n            setError(\"Geolocaliza√ß√£o n√£o suportada\");\r\n            setGettingLocation(false);\r\n        }\r\n    }, [isOpen, destination]);\r\n\r\n    // Initialize map\r\n    useEffect(() => {\r\n        if (!isOpen || !mapRef.current) return;\r\n\r\n        if (mapInstanceRef.current) {\r\n            mapInstanceRef.current.remove();\r\n        }\r\n\r\n        const map = L.map(mapRef.current).setView([destination.lat, destination.lng], 15);\r\n\r\n        L.tileLayer(\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\", {\r\n            attribution: \"¬© OSM\"\r\n        }).addTo(map);\r\n\r\n        // Destination marker\r\n        const destIcon = L.divIcon({\r\n            className: \"dest-marker\",\r\n            html: `<div style=\"background: #ef4444; color: white; padding: 6px 10px; border-radius: 16px; font-weight: bold; white-space: nowrap; box-shadow: 0 2px 8px rgba(0,0,0,0.3); font-size: 12px;\">üìç ${destination.name.substring(0, 15)}</div>`,\r\n            iconAnchor: [40, 35]\r\n        });\r\n        L.marker([destination.lat, destination.lng], { icon: destIcon }).addTo(map);\r\n\r\n        mapInstanceRef.current = map;\r\n\r\n        return () => {\r\n            if (mapInstanceRef.current) {\r\n                mapInstanceRef.current.remove();\r\n                mapInstanceRef.current = null;\r\n            }\r\n        };\r\n    }, [isOpen, destination]);\r\n\r\n    // Update user marker position\r\n    useEffect(() => {\r\n        if (!mapInstanceRef.current || !userLocation) return;\r\n\r\n        const userIcon = L.divIcon({\r\n            className: \"user-marker\",\r\n            html: '<div style=\"width: 20px; height: 20px; background: #3b82f6; border: 3px solid white; border-radius: 50%; box-shadow: 0 2px 8px rgba(0,0,0,0.3);\"></div>',\r\n            iconAnchor: [10, 10]\r\n        });\r\n\r\n        if (userMarkerRef.current) {\r\n            userMarkerRef.current.setLatLng([userLocation.lat, userLocation.lng]);\r\n        } else {\r\n            userMarkerRef.current = L.marker([userLocation.lat, userLocation.lng], { icon: userIcon }).addTo(mapInstanceRef.current);\r\n\r\n            // Fit bounds\r\n            const bounds = L.latLngBounds(\r\n                [userLocation.lat, userLocation.lng],\r\n                [destination.lat, destination.lng]\r\n            );\r\n            mapInstanceRef.current.fitBounds(bounds, { padding: [50, 50] });\r\n        }\r\n\r\n        // Center on user if navigating\r\n        if (isNavigating) {\r\n            mapInstanceRef.current.setView([userLocation.lat, userLocation.lng], 17);\r\n        }\r\n    }, [userLocation, destination, isNavigating]);\r\n\r\n    // Calculate route\r\n    const calculateRoute = useCallback(async () => {\r\n        if (!userLocation) return;\r\n\r\n        setLoading(true);\r\n        setError(null);\r\n\r\n        try {\r\n            const routeData = await getDirections(userLocation, destination, profile);\r\n            setRoute(routeData);\r\n            setRemainingDistance(routeData.distance);\r\n\r\n            // Draw route\r\n            if (mapInstanceRef.current && routeData.geometry?.coordinates) {\r\n                if (routeLayerRef.current) {\r\n                    mapInstanceRef.current.removeLayer(routeLayerRef.current);\r\n                }\r\n\r\n                const coords = routeData.geometry.coordinates.map(\r\n                    (c: [number, number]) => [c[1], c[0]] as [number, number]\r\n                );\r\n                routeLayerRef.current = L.polyline(coords, {\r\n                    color: profile === \"driving-car\" ? \"#3b82f6\" : profile === \"cycling-regular\" ? \"#10b981\" : \"#8b5cf6\",\r\n                    weight: 6,\r\n                    opacity: 0.9\r\n                }).addTo(mapInstanceRef.current);\r\n            }\r\n        } catch (err: unknown) {\r\n            console.error(\"Erro rota:\", err);\r\n            setError(\"Erro ao calcular rota\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [userLocation, destination, profile]);\r\n\r\n    // Recalculate when location or profile changes\r\n    useEffect(() => {\r\n        if (userLocation && !route) {\r\n            calculateRoute();\r\n        }\r\n    }, [userLocation, calculateRoute, route]);\r\n\r\n    useEffect(() => {\r\n        if (userLocation) {\r\n            calculateRoute();\r\n        }\r\n    }, [profile]);\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div\r\n            style={{\r\n                position: \"fixed\",\r\n                top: 0,\r\n                left: 0,\r\n                right: 0,\r\n                bottom: 0,\r\n                background: \"#1a1a1a\",\r\n                zIndex: 9999,\r\n                display: \"flex\",\r\n                flexDirection: \"column\"\r\n            }}\r\n        >\r\n            {/* Header */}\r\n            <div style={{\r\n                padding: \"0.75rem 1rem\",\r\n                background: isNavigating ? \"#10b981\" : \"var(--bg-card)\",\r\n                display: \"flex\",\r\n                justifyContent: \"space-between\",\r\n                alignItems: \"center\"\r\n            }}>\r\n                <div>\r\n                    <h2 style={{ margin: 0, fontSize: \"1rem\", color: isNavigating ? \"white\" : \"inherit\" }}>\r\n                        {hasArrived ? \"üéâ Voc√™ chegou!\" : isNavigating ? \"üß≠ Navegando...\" : \"üìç Como Chegar\"}\r\n                    </h2>\r\n                    <p style={{ margin: 0, fontSize: \"0.8rem\", opacity: 0.8, color: isNavigating ? \"white\" : \"var(--text-secondary)\" }}>\r\n                        {destination.name}\r\n                    </p>\r\n                </div>\r\n                <button\r\n                    onClick={() => { stopNavigation(); onClose(); }}\r\n                    style={{\r\n                        background: \"rgba(255,255,255,0.2)\",\r\n                        border: \"none\",\r\n                        color: \"white\",\r\n                        fontSize: \"1.2rem\",\r\n                        cursor: \"pointer\",\r\n                        padding: \"0.5rem\",\r\n                        borderRadius: \"50%\"\r\n                    }}\r\n                >\r\n                    ‚úï\r\n                </button>\r\n            </div>\r\n\r\n            {/* Current Instruction (when navigating) */}\r\n            {isNavigating && currentStep && !hasArrived && (\r\n                <div style={{\r\n                    padding: \"1rem\",\r\n                    background: \"#2563eb\",\r\n                    color: \"white\"\r\n                }}>\r\n                    <div style={{ fontSize: \"1.2rem\", fontWeight: \"bold\", marginBottom: \"0.25rem\" }}>\r\n                        {currentStep.instruction}\r\n                    </div>\r\n                    {nextStep && (\r\n                        <div style={{ fontSize: \"0.85rem\", opacity: 0.8 }}>\r\n                            Depois: {nextStep.instruction}\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            )}\r\n\r\n            {/* Transport Mode (when not navigating) */}\r\n            {!isNavigating && (\r\n                <div style={{\r\n                    padding: \"0.5rem 1rem\",\r\n                    background: \"var(--bg-card)\",\r\n                    display: \"flex\",\r\n                    gap: \"0.5rem\",\r\n                    justifyContent: \"center\"\r\n                }}>\r\n                    {[\r\n                        { id: \"foot-walking\" as NavigationProfile, icon: \"üö∂\", label: \"A p√©\" },\r\n                        { id: \"driving-car\" as NavigationProfile, icon: \"üöó\", label: \"Carro\" },\r\n                        { id: \"cycling-regular\" as NavigationProfile, icon: \"üö¥\", label: \"Bike\" }\r\n                    ].map((mode) => (\r\n                        <button\r\n                            key={mode.id}\r\n                            onClick={() => setProfile(mode.id)}\r\n                            style={{\r\n                                padding: \"0.4rem 0.8rem\",\r\n                                borderRadius: \"16px\",\r\n                                border: profile === mode.id ? \"2px solid var(--primary)\" : \"1px solid #444\",\r\n                                background: profile === mode.id ? \"var(--primary)\" : \"transparent\",\r\n                                color: profile === mode.id ? \"#000\" : \"white\",\r\n                                cursor: \"pointer\",\r\n                                fontSize: \"0.9rem\"\r\n                            }}\r\n                        >\r\n                            {mode.icon} {mode.label}\r\n                        </button>\r\n                    ))}\r\n                </div>\r\n            )}\r\n\r\n            {/* Map */}\r\n            <div ref={mapRef} style={{ flex: 1, minHeight: \"200px\" }} />\r\n\r\n            {/* Bottom Panel */}\r\n            <div style={{\r\n                padding: \"1rem\",\r\n                background: \"var(--bg-card)\",\r\n                borderTop: \"1px solid #333\"\r\n            }}>\r\n                {gettingLocation ? (\r\n                    <p style={{ textAlign: \"center\" }}>üì° Obtendo localiza√ß√£o...</p>\r\n                ) : error ? (\r\n                    <p style={{ textAlign: \"center\", color: \"#ef4444\" }}>{error}</p>\r\n                ) : loading ? (\r\n                    <p style={{ textAlign: \"center\" }}>üîÑ Calculando rota...</p>\r\n                ) : hasArrived ? (\r\n                    <div style={{ textAlign: \"center\" }}>\r\n                        <div style={{ fontSize: \"2rem\", marginBottom: \"0.5rem\" }}>üéâ</div>\r\n                        <p style={{ fontWeight: \"bold\", marginBottom: \"1rem\" }}>Voc√™ chegou ao destino!</p>\r\n                        <button className=\"btn btn-primary\" onClick={() => { stopNavigation(); onClose(); }}>\r\n                            Fechar\r\n                        </button>\r\n                    </div>\r\n                ) : (\r\n                    <div>\r\n                        {/* Distance & Time */}\r\n                        <div style={{ display: \"flex\", justifyContent: \"space-around\", marginBottom: \"1rem\" }}>\r\n                            <div style={{ textAlign: \"center\" }}>\r\n                                <div style={{ fontSize: \"1.4rem\", fontWeight: \"bold\", color: \"var(--primary)\" }}>\r\n                                    {formatDistance(isNavigating ? remainingDistance : (route?.distance || 0))}\r\n                                </div>\r\n                                <div style={{ fontSize: \"0.75rem\", color: \"var(--text-secondary)\" }}>\r\n                                    {isNavigating ? \"Restante\" : \"Dist√¢ncia\"}\r\n                                </div>\r\n                            </div>\r\n                            <div style={{ textAlign: \"center\" }}>\r\n                                <div style={{ fontSize: \"1.4rem\", fontWeight: \"bold\", color: \"var(--primary)\" }}>\r\n                                    {formatDuration(route?.duration || 0)}\r\n                                </div>\r\n                                <div style={{ fontSize: \"0.75rem\", color: \"var(--text-secondary)\" }}>\r\n                                    Tempo est.\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Action Buttons */}\r\n                        <div style={{ display: \"flex\", gap: \"0.5rem\" }}>\r\n                            {!isNavigating ? (\r\n                                <>\r\n                                    <button\r\n                                        className=\"btn btn-primary\"\r\n                                        style={{ flex: 1 }}\r\n                                        onClick={startNavigation}\r\n                                    >\r\n                                        üöÄ Iniciar Navega√ß√£o\r\n                                    </button>\r\n                                    <a\r\n                                        href={getGoogleMapsUrl(destination.lat, destination.lng, profile === \"driving-car\" ? \"driving\" : \"walking\")}\r\n                                        target=\"_blank\"\r\n                                        rel=\"noopener noreferrer\"\r\n                                        className=\"btn btn-secondary\"\r\n                                        style={{ padding: \"0.75rem\" }}\r\n                                    >\r\n                                        üó∫Ô∏è\r\n                                    </a>\r\n                                </>\r\n                            ) : (\r\n                                <button\r\n                                    className=\"btn btn-secondary\"\r\n                                    style={{ flex: 1 }}\r\n                                    onClick={stopNavigation}\r\n                                >\r\n                                    ‚èπÔ∏è Parar Navega√ß√£o\r\n                                </button>\r\n                            )}\r\n                        </div>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\pwa\\OfflineComponents.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\pwa\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\shop\\ShopComponents.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\ui\\Button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\ui\\ConfirmModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\ui\\EmptyState.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\ui\\FavoriteButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\ui\\NewsletterForm.tsx","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":40,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":40,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1282,1285],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1282,1285],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\ui\\Skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\ui\\StarRating.tsx","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":174,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":174,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5473,5476],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5473,5476],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\components\\ui\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\hooks\\usePWA.ts","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\hooks\\usePWA.ts:55:13\n  53 |         // Check if already installed\n  54 |         if (window.matchMedia('(display-mode: standalone)').matches) {\n> 55 |             setIsInstalled(true);\n     |             ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  56 |         }\n  57 |\n  58 |         const handleBeforeInstall = (e: Event) => {","line":55,"column":13,"nodeType":null,"endLine":55,"endColumn":27}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\r\n\r\ninterface BeforeInstallPromptEvent extends Event {\r\n    readonly platforms: string[];\r\n    readonly userChoice: Promise<{\r\n        outcome: 'accepted' | 'dismissed';\r\n        platform: string;\r\n    }>;\r\n    prompt(): Promise<void>;\r\n}\r\n\r\n/**\r\n * Hook to detect online/offline status\r\n */\r\nexport const useOnlineStatus = () => {\r\n    const [isOnline, setIsOnline] = useState(navigator.onLine);\r\n    const [wasOffline, setWasOffline] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const handleOnline = () => {\r\n            setIsOnline(true);\r\n            if (wasOffline) {\r\n                // Show reconnection message\r\n                setWasOffline(false);\r\n            }\r\n        };\r\n\r\n        const handleOffline = () => {\r\n            setIsOnline(false);\r\n            setWasOffline(true);\r\n        };\r\n\r\n        window.addEventListener('online', handleOnline);\r\n        window.addEventListener('offline', handleOffline);\r\n\r\n        return () => {\r\n            window.removeEventListener('online', handleOnline);\r\n            window.removeEventListener('offline', handleOffline);\r\n        };\r\n    }, [wasOffline]);\r\n\r\n    return { isOnline, wasOffline };\r\n};\r\n\r\n/**\r\n * Hook to check if PWA is installed\r\n */\r\nexport const usePWAInstall = () => {\r\n    const [installPrompt, setInstallPrompt] = useState<BeforeInstallPromptEvent | null>(null);\r\n    const [isInstalled, setIsInstalled] = useState(false);\r\n\r\n    useEffect(() => {\r\n        // Check if already installed\r\n        if (window.matchMedia('(display-mode: standalone)').matches) {\r\n            setIsInstalled(true);\r\n        }\r\n\r\n        const handleBeforeInstall = (e: Event) => {\r\n            e.preventDefault();\r\n            setInstallPrompt(e as BeforeInstallPromptEvent);\r\n        };\r\n\r\n        const handleAppInstalled = () => {\r\n            setIsInstalled(true);\r\n            setInstallPrompt(null);\r\n        };\r\n\r\n        window.addEventListener('beforeinstallprompt', handleBeforeInstall);\r\n        window.addEventListener('appinstalled', handleAppInstalled);\r\n\r\n        return () => {\r\n            window.removeEventListener('beforeinstallprompt', handleBeforeInstall);\r\n            window.removeEventListener('appinstalled', handleAppInstalled);\r\n        };\r\n    }, []);\r\n\r\n    const promptInstall = async () => {\r\n        if (!installPrompt) return false;\r\n\r\n        installPrompt.prompt();\r\n        const { outcome } = await installPrompt.userChoice;\r\n\r\n        if (outcome === 'accepted') {\r\n            setInstallPrompt(null);\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n\r\n    return { isInstalled, canInstall: !!installPrompt, promptInstall };\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\hooks\\useTTS.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\hooks\\useTerminology.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\i18n\\config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\AdminLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\certificates\\CertificateEditor.tsx","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":30,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":30,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1260,1263],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1260,1263],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\certificates\\CertificateRuleForm.tsx","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-hooks/exhaustive-deps').","line":35,"column":9,"severity":1,"nodeType":null,"fix":{"range":[1369,1424],"text":" "}}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[411,414],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[411,414],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[533,536],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[533,536],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[854,857],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[854,857],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"import React, { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { api } from '../../../api/client';\r\nimport { Button } from '../../../components/ui/Button';\r\n\r\nexport const CertificateRuleForm: React.FC = () => {\r\n    const navigate = useNavigate();\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    const [templates, setTemplates] = useState<any[]>([]);\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    const [trails, setTrails] = useState<any[]>([]);\r\n\r\n    // Form State\r\n    const [name, setName] = useState('');\r\n    const [triggerType, setTriggerType] = useState('TRAIL_COMPLETED');\r\n    const [templateId, setTemplateId] = useState('');\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    const [conditions, setConditions] = useState<any>({});\r\n\r\n    const loadData = async () => {\r\n        try {\r\n            const [tplRes, trailRes] = await Promise.all([\r\n                api.get('/certificate-templates'),\r\n                api.get('/admin/trails') // Assuming generic trail list endpoint exists\r\n            ]);\r\n            setTemplates(tplRes.data);\r\n            setTrails(trailRes.data);\r\n        } catch (err) {\r\n            console.error(\"Failed to load data\", err);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        loadData();\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    const handleSave = async () => {\r\n        try {\r\n            await api.post('/certificate-rules', {\r\n                name,\r\n                triggerType,\r\n                actionTemplateId: templateId,\r\n                conditions,\r\n                active: true\r\n            });\r\n            navigate('/admin/certificates/rules');\r\n        } catch (err) {\r\n            console.error(err);\r\n            alert(\"Erro ao salvar regra\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-6 max-w-2xl bg-white rounded-lg shadow m-6\">\r\n            <h1 className=\"text-2xl font-bold mb-6\">Nova Regra de Automa√ß√£o</h1>\r\n\r\n            <div className=\"space-y-4\">\r\n                <div>\r\n                    <label className=\"block text-sm font-medium mb-1\">Nome da Regra</label>\r\n                    <input\r\n                        className=\"w-full p-2 border rounded\"\r\n                        value={name}\r\n                        onChange={e => setName(e.target.value)}\r\n                        placeholder=\"Ex: Certificado Trilha Hist√≥rica\"\r\n                    />\r\n                </div>\r\n\r\n                <div>\r\n                    <label className=\"block text-sm font-medium mb-1\">Gatilho (Quando emitir?)</label>\r\n                    <select\r\n                        className=\"w-full p-2 border rounded\"\r\n                        value={triggerType}\r\n                        onChange={e => setTriggerType(e.target.value)}\r\n                    >\r\n                        <option value=\"TRAIL_COMPLETED\">Ao completar uma Trilha</option>\r\n                        <option value=\"EVENT_ATTENDED\">Ao participar de um Evento</option>\r\n                        <option value=\"XP_THRESHOLD\">Ao atingir X pontos de XP</option>\r\n                    </select>\r\n                </div>\r\n\r\n                {/* Conditional Inputs based on Trigger */}\r\n                {triggerType === 'TRAIL_COMPLETED' && (\r\n                    <div className=\"p-4 bg-gray-50 rounded border\">\r\n                        <label className=\"block text-sm font-medium mb-1\">Qual Trilha?</label>\r\n                        <select\r\n                            className=\"w-full p-2 border rounded\"\r\n                            onChange={e => setConditions({ ...conditions, trail_id: e.target.value })}\r\n                        >\r\n                            <option value=\"\">Qualquer Trilha</option>\r\n                            {trails.map(t => (\r\n                                <option key={t.id} value={t.id}>{t.title}</option>\r\n                            ))}\r\n                        </select>\r\n                    </div>\r\n                )}\r\n\r\n                {triggerType === 'XP_THRESHOLD' && (\r\n                    <div className=\"p-4 bg-gray-50 rounded border\">\r\n                        <label className=\"block text-sm font-medium mb-1\">M√≠nimo de XP</label>\r\n                        <input\r\n                            type=\"number\"\r\n                            className=\"w-full p-2 border rounded\"\r\n                            onChange={e => setConditions({ ...conditions, min_xp: Number(e.target.value) })}\r\n                            placeholder=\"Ex: 1000\"\r\n                        />\r\n                    </div>\r\n                )}\r\n\r\n                <div>\r\n                    <label className=\"block text-sm font-medium mb-1\">Modelo de Certificado</label>\r\n                    <select\r\n                        className=\"w-full p-2 border rounded\"\r\n                        value={templateId}\r\n                        onChange={e => setTemplateId(e.target.value)}\r\n                    >\r\n                        <option value=\"\">Selecione um modelo...</option>\r\n                        {templates.map(t => (\r\n                            <option key={t.id} value={t.id}>{t.name}</option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n\r\n                <div className=\"pt-4\">\r\n                    <Button onClick={handleSave} disabled={!name || !templateId}>\r\n                        Salvar Regra Autom√°tica\r\n                    </Button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\certificates\\CertificateRules.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[382,385],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[382,385],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\certificates\\CertificateRules.tsx:21:9\n  19 |\n  20 |     useEffect(() => {\n> 21 |         loadRules();\n     |         ^^^^^^^^^ Avoid calling setState() directly within an effect\n  22 |     }, []);\n  23 |\n  24 |     return (","line":21,"column":9,"nodeType":null,"endLine":21,"endColumn":18}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { api } from '../../../api/client';\r\nimport { Button } from '../../../components/ui/Button';\r\nimport { Plus, Trash, Zap } from 'lucide-react';\r\n\r\nexport const CertificateRules: React.FC = () => {\r\n    const navigate = useNavigate();\r\n    const [rules, setRules] = useState<any[]>([]);\r\n\r\n    const loadRules = async () => {\r\n        try {\r\n            const res = await api.get('/certificate-rules');\r\n            setRules(res.data);\r\n        } catch (err) {\r\n            console.error(err);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        loadRules();\r\n    }, []);\r\n\r\n    return (\r\n        <div className=\"p-6\">\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n                <h1 className=\"text-2xl font-bold\">Automa√ß√£o de Certificados</h1>\r\n                <Button onClick={() => navigate('/admin/certificates/rules/new')}>\r\n                    <Plus size={20} className=\"mr-2\" /> Nova Regra\r\n                </Button>\r\n            </div>\r\n\r\n            <div className=\"bg-white rounded-lg shadow overflow-hidden\">\r\n                <table className=\"w-full\">\r\n                    <thead className=\"bg-gray-50 border-b\">\r\n                        <tr>\r\n                            <th className=\"text-left p-4\">Nome da Regra</th>\r\n                            <th className=\"text-left p-4\">Gatilho</th>\r\n                            <th className=\"text-left p-4\">Modelo</th>\r\n                            <th className=\"text-left p-4\">Status</th>\r\n                            <th className=\"text-right p-4\">A√ß√µes</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {rules.map(rule => (\r\n                            <tr key={rule.id} className=\"border-b hover:bg-gray-50\">\r\n                                <td className=\"p-4 font-medium\">{rule.name}</td>\r\n                                <td className=\"p-4\">\r\n                                    <span className=\"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs\">\r\n                                        {rule.triggerType}\r\n                                    </span>\r\n                                </td>\r\n                                <td className=\"p-4\">{rule.actionTemplate?.name || '---'}</td>\r\n                                <td className=\"p-4\">\r\n                                    {rule.active ? (\r\n                                        <span className=\"text-green-600 font-bold flex items-center\">\r\n                                            <Zap size={14} className=\"mr-1\" /> Ativo\r\n                                        </span>\r\n                                    ) : (\r\n                                        <span className=\"text-gray-400\">Inativo</span>\r\n                                    )}\r\n                                </td>\r\n                                <td className=\"p-4 text-right\">\r\n                                    <button className=\"text-red-500 hover:text-red-700\">\r\n                                        <Trash size={18} />\r\n                                    </button>\r\n                                </td>\r\n                            </tr>\r\n                        ))}\r\n                        {rules.length === 0 && (\r\n                            <tr>\r\n                                <td colSpan={5} className=\"p-8 text-center text-gray-500\">\r\n                                    Nenhuma regra de automa√ß√£o criada.\r\n                                </td>\r\n                            </tr>\r\n                        )}\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\certificates\\CertificateTemplates.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":8,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":8,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[348,351],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[348,351],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\certificates\\CertificateTemplates.tsx:20:9\n  18 |\n  19 |     useEffect(() => {\n> 20 |         loadTemplates();\n     |         ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  21 |     }, []);\n  22 |\n  23 |     const handleDelete = async (id: string) => {","line":20,"column":9,"nodeType":null,"endLine":20,"endColumn":22}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { api } from '../../../api/client';\r\nimport { Plus, Edit, Trash, FileText } from 'lucide-react';\r\n\r\nexport const CertificateTemplates: React.FC = () => {\r\n    const navigate = useNavigate();\r\n    const [templates, setTemplates] = useState<any[]>([]);\r\n\r\n    const loadTemplates = async () => {\r\n        try {\r\n            const res = await api.get('/certificate-templates');\r\n            setTemplates(res.data);\r\n        } catch (err) {\r\n            console.error(err);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        loadTemplates();\r\n    }, []);\r\n\r\n    const handleDelete = async (id: string) => {\r\n        if (!confirm('Deseja excluir este modelo?')) return;\r\n        try {\r\n            await api.delete(`/certificate-templates/${id}`);\r\n            loadTemplates(); // Reload\r\n        } catch {\r\n            alert('Erro ao excluir');\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-6\">\r\n            <div className=\"flex justify-between items-center mb-6\">\r\n                <h1 className=\"section-title text-2xl\">Modelos de Certificado</h1>\r\n                <div className=\"space-x-2\">\r\n                    <button className=\"btn btn-secondary\" onClick={() => navigate('/admin/certificates/rules')}>\r\n                        ü§ñ Regras e Automa√ß√£o\r\n                    </button>\r\n                    <button className=\"btn btn-primary\" onClick={() => navigate('/admin/certificates/new')}>\r\n                        <Plus size={20} className=\"mr-2\" /> Novo Modelo\r\n                    </button>\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                {templates.map(t => (\r\n                    <div key={t.id} className=\"card hover:border-[var(--accent-gold)] transition-colors group\">\r\n                        <div\r\n                            className=\"h-40 bg-[var(--bg-elevated-soft)] rounded mb-4 bg-cover bg-center border border-[var(--border-subtle)]\"\r\n                            style={{ backgroundImage: t.backgroundUrl ? `url(${t.backgroundUrl})` : 'none' }}\r\n                        >\r\n                            {!t.backgroundUrl && (\r\n                                <div className=\"h-full flex items-center justify-center text-[var(--fg-muted)] opacity-50\">\r\n                                    <FileText size={48} />\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                        <h3 className=\"card-title text-lg\">{t.name}</h3>\r\n                        <p className=\"text-sm text-[var(--fg-muted)] mb-4\">{t.elements?.length || 0} elementos</p>\r\n\r\n                        <div className=\"flex gap-2\">\r\n                            <button\r\n                                onClick={() => navigate(`/admin/certificates/edit/${t.id}`)}\r\n                                className=\"flex-1 btn btn-secondary py-2 justify-center hover:bg-[var(--accent-gold)] hover:text-[var(--bg-page)]\"\r\n                            >\r\n                                <Edit size={16} className=\"mr-2\" /> Editar\r\n                            </button>\r\n                            <button\r\n                                onClick={() => handleDelete(t.id)}\r\n                                className=\"p-2 btn btn-secondary text-red-500 hover:bg-red-500/20 border-red-500/30\"\r\n                            >\r\n                                <Trash size={16} />\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n\r\n                {templates.length === 0 && (\r\n                    <div className=\"col-span-3 text-center py-20 bg-[var(--bg-elevated)] rounded-lg border-2 border-dashed border-[var(--border-subtle)]\">\r\n                        <h3 className=\"text-xl text-[var(--fg-muted)] font-serif mb-4\">Nenhum modelo criado ainda</h3>\r\n                        <button onClick={() => navigate('/admin/certificates/new')} className=\"btn btn-primary\">\r\n                            Criar Primeiro Modelo\r\n                        </button>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\certificates\\components\\CertificateCanvas.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\certificates\\components\\CertificateCanvas.tsx:79:9\n  77 |             if (el) domTargets.push(el as HTMLElement);\n  78 |         });\n> 79 |         setTargets(domTargets);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  80 |     }, [selectedIds, elements]);\n  81 |\n  82 |     // Handle element selection","line":79,"column":9,"nodeType":null,"endLine":79,"endColumn":19}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useRef, useEffect, useState } from 'react';\r\nimport Moveable from 'react-moveable';\r\nimport Selecto from 'react-selecto';\r\nimport { useCertificate } from '../context/CertificateContext';\r\nimport { CertificateElement } from '../types';\r\nimport { QrCode } from 'lucide-react';\r\n\r\ninterface ElementRendererProps {\r\n    element: CertificateElement;\r\n    onSelect: (id: string) => void;\r\n}\r\n\r\nconst ElementRenderer: React.FC<ElementRendererProps> = ({ element, onSelect }) => {\r\n    const handleClick = (e: React.MouseEvent) => {\r\n        e.stopPropagation(); // Prevent container click from clearing selection\r\n        onSelect(element.id);\r\n    };\r\n\r\n    return (\r\n        <div\r\n            className=\"certificate-element\"\r\n            style={{\r\n                position: 'absolute',\r\n                left: 0,\r\n                top: 0,\r\n                transform: `translate(${element.x}px, ${element.y}px) rotate(${element.rotate || 0}deg)`,\r\n                width: element.width,\r\n                height: element.height,\r\n                fontSize: element.fontSize,\r\n                fontFamily: element.fontFamily,\r\n                color: element.color,\r\n                textAlign: element.align as React.CSSProperties['textAlign'],\r\n                opacity: element.opacity ?? 1,\r\n                whiteSpace: 'pre-wrap',\r\n                lineHeight: 1.2,\r\n                cursor: 'pointer',\r\n                touchAction: 'none',\r\n                userSelect: 'none',\r\n                display: element.type === 'qrcode' ? 'flex' : 'block',\r\n                flexDirection: 'column',\r\n                alignItems: element.type === 'qrcode' ? 'center' : undefined,\r\n                justifyContent: element.type === 'qrcode' ? 'center' : undefined,\r\n                background: element.type === 'qrcode' ? 'linear-gradient(135deg, #1a1a1a 0%, #000 100%)' : 'transparent',\r\n                borderRadius: element.type === 'qrcode' ? '8px' : undefined,\r\n            }}\r\n            data-id={element.id}\r\n            onClick={handleClick}\r\n        >\r\n            {element.type === 'qrcode' ? (\r\n                <>\r\n                    <QrCode size={element.width ? element.width * 0.5 : 24} color=\"rgba(255,255,255,0.6)\" />\r\n                    <span style={{ fontSize: '10px', marginTop: '4px', opacity: 0.6, color: 'white' }}>QR Code</span>\r\n                </>\r\n            ) : (\r\n                element.text\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport const CertificateCanvas: React.FC = () => {\r\n    const {\r\n        elements, selectedIds, setSelectedIds, updateElement,\r\n        backgroundUrl, zoom, saveSnapshot\r\n    } = useCertificate();\r\n\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const moveableRef = useRef<Moveable>(null);\r\n    const selectoRef = useRef<Selecto>(null);\r\n    const [targets, setTargets] = useState<(HTMLElement | SVGElement)[]>([]);\r\n\r\n    // Sync targets when selection changes\r\n    useEffect(() => {\r\n        const domTargets: (HTMLElement | SVGElement)[] = [];\r\n        selectedIds.forEach(id => {\r\n            const el = document.querySelector(`[data-id=\"${id}\"]`);\r\n            if (el) domTargets.push(el as HTMLElement);\r\n        });\r\n        setTargets(domTargets);\r\n    }, [selectedIds, elements]);\r\n\r\n    // Handle element selection\r\n    const handleElementSelect = (id: string) => {\r\n        setSelectedIds([id]);\r\n    };\r\n\r\n    // Handle container click (clear selection)\r\n    const handleContainerClick = () => {\r\n        setSelectedIds([]);\r\n    };\r\n\r\n    const styles = {\r\n        wrapper: {\r\n            flex: 1,\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            position: 'relative' as const,\r\n            overflow: 'hidden',\r\n            padding: '32px',\r\n            background: 'radial-gradient(ellipse at center, #1f1610 0%, #0f0a04 100%)',\r\n            minWidth: 0,\r\n        },\r\n        gridPattern: {\r\n            position: 'absolute' as const,\r\n            inset: 0,\r\n            pointerEvents: 'none' as const,\r\n            backgroundImage: 'radial-gradient(#d4af37 0.5px, transparent 0.5px)',\r\n            backgroundSize: '32px 32px',\r\n            opacity: 0.08,\r\n        },\r\n        ambientGlow: {\r\n            position: 'absolute' as const,\r\n            top: '50%',\r\n            left: '50%',\r\n            transform: 'translate(-50%, -50%)',\r\n            width: '800px',\r\n            height: '600px',\r\n            borderRadius: '50%',\r\n            pointerEvents: 'none' as const,\r\n            background: 'radial-gradient(ellipse, rgba(212,175,55,0.05) 0%, transparent 70%)',\r\n        },\r\n        canvasContainer: {\r\n            position: 'relative' as const,\r\n        },\r\n        canvasShadow: {\r\n            position: 'absolute' as const,\r\n            inset: 0,\r\n            borderRadius: '8px',\r\n            pointerEvents: 'none' as const,\r\n            width: '842px',\r\n            height: '595px',\r\n            boxShadow: '0 25px 80px -20px rgba(0,0,0,0.6), 0 0 60px -15px rgba(212,175,55,0.15)',\r\n            transform: `scale(${zoom})`,\r\n            transformOrigin: 'center center',\r\n        },\r\n        certificate: {\r\n            position: 'relative' as const,\r\n            width: '842px',\r\n            height: '595px',\r\n            backgroundColor: '#ffffff',\r\n            backgroundImage: backgroundUrl ? `url(${backgroundUrl})` : 'none',\r\n            backgroundSize: 'cover',\r\n            backgroundPosition: 'center',\r\n            transform: `scale(${zoom})`,\r\n            transformOrigin: 'center center',\r\n            transition: 'transform 0.2s ease-out',\r\n            borderRadius: '4px',\r\n            overflow: 'hidden',\r\n            userSelect: 'none' as const,\r\n        },\r\n        emptyState: {\r\n            position: 'absolute' as const,\r\n            inset: 0,\r\n            display: 'flex',\r\n            flexDirection: 'column' as const,\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            border: '1px solid #e5e7eb',\r\n            color: '#9ca3af',\r\n            pointerEvents: 'none' as const,\r\n        },\r\n        emptyIcon: {\r\n            width: '96px',\r\n            height: '96px',\r\n            borderRadius: '50%',\r\n            border: '2px dashed #d1d5db',\r\n            display: 'flex',\r\n            alignItems: 'center',\r\n            justifyContent: 'center',\r\n            marginBottom: '16px',\r\n        },\r\n    };\r\n\r\n    return (\r\n        <div style={styles.wrapper}>\r\n            <div style={styles.gridPattern} />\r\n            <div style={styles.ambientGlow} />\r\n\r\n            <div style={styles.canvasContainer}>\r\n                <div style={styles.canvasShadow} />\r\n\r\n                <div\r\n                    ref={containerRef}\r\n                    style={styles.certificate}\r\n                    onClick={handleContainerClick}\r\n                >\r\n                    {!backgroundUrl && (\r\n                        <div style={styles.emptyState}>\r\n                            <div style={styles.emptyIcon}>\r\n                                <span style={{ fontSize: '36px', opacity: 0.3 }}>üìú</span>\r\n                            </div>\r\n                            <span style={{ fontSize: '18px', fontWeight: 500, opacity: 0.4 }}>√Årea do Certificado</span>\r\n                            <span style={{ fontSize: '12px', color: '#9ca3af', marginTop: '8px', opacity: 0.5 }}>842 √ó 595 px (A4 Paisagem)</span>\r\n                        </div>\r\n                    )}\r\n\r\n                    {elements.map(el => (\r\n                        <ElementRenderer\r\n                            key={el.id}\r\n                            element={el}\r\n                            onSelect={handleElementSelect}\r\n                        />\r\n                    ))}\r\n                </div>\r\n\r\n                <Moveable\r\n                    ref={moveableRef}\r\n                    target={targets}\r\n                    draggable={true}\r\n                    resizable={true}\r\n                    rotatable={true}\r\n                    snappable={true}\r\n                    snapDirections={{ top: true, left: true, bottom: true, right: true, center: true, middle: true }}\r\n                    elementGuidelines={Array.from(document.querySelectorAll('.certificate-element'))}\r\n\r\n                    onDragStart={() => saveSnapshot()}\r\n                    onDrag={e => {\r\n                        e.target.style.transform = e.transform;\r\n                    }}\r\n                    onDragEnd={e => {\r\n                        if (e.isDrag) {\r\n                            const target = e.target as HTMLElement;\r\n                            const id = target.getAttribute('data-id');\r\n                            if (id) {\r\n                                const match = target.style.transform.match(/translate\\(([-\\d.]+)px,\\s*([-\\d.]+)px\\)/);\r\n                                if (match) {\r\n                                    updateElement(id, {\r\n                                        x: parseFloat(match[1]),\r\n                                        y: parseFloat(match[2])\r\n                                    });\r\n                                }\r\n                            }\r\n                        }\r\n                    }}\r\n                    onDragGroupStart={() => saveSnapshot()}\r\n                    onDragGroup={e => {\r\n                        e.events.forEach(ev => {\r\n                            ev.target.style.transform = ev.transform;\r\n                        });\r\n                    }}\r\n                    onDragGroupEnd={e => {\r\n                        e.events.forEach(ev => {\r\n                            const target = ev.target as HTMLElement;\r\n                            const id = target.getAttribute('data-id');\r\n                            if (id) {\r\n                                const match = target.style.transform.match(/translate\\(([-\\d.]+)px,\\s*([-\\d.]+)px\\)/);\r\n                                if (match) updateElement(id, { x: parseFloat(match[1]), y: parseFloat(match[2]) });\r\n                            }\r\n                        });\r\n                    }}\r\n\r\n                    onResizeStart={() => saveSnapshot()}\r\n                    onResize={e => {\r\n                        e.target.style.width = `${e.width}px`;\r\n                        e.target.style.height = `${e.height}px`;\r\n                        e.target.style.transform = e.drag.transform;\r\n                    }}\r\n                    onResizeEnd={e => {\r\n                        const target = e.target as HTMLElement;\r\n                        const id = target.getAttribute('data-id');\r\n                        if (id) {\r\n                            const match = target.style.transform.match(/translate\\(([-\\d.]+)px,\\s*([-\\d.]+)px\\)/);\r\n                            const x = match ? parseFloat(match[1]) : 0;\r\n                            const y = match ? parseFloat(match[2]) : 0;\r\n\r\n                            updateElement(id, {\r\n                                width: e.lastEvent?.width || parseFloat(target.style.width),\r\n                                height: e.lastEvent?.height || parseFloat(target.style.height),\r\n                                x, y\r\n                            });\r\n                        }\r\n                    }}\r\n\r\n                    onRotateStart={() => saveSnapshot()}\r\n                    onRotate={e => {\r\n                        e.target.style.transform = e.drag.transform;\r\n                    }}\r\n                    onRotateEnd={e => {\r\n                        const target = e.target as HTMLElement;\r\n                        const id = target.getAttribute('data-id');\r\n                        if (id) {\r\n                            const match = target.style.transform.match(/rotate\\(([-\\d.]+)deg\\)/);\r\n                            if (match) updateElement(id, { rotate: parseFloat(match[1]) });\r\n                        }\r\n                    }}\r\n                />\r\n\r\n                <Selecto\r\n                    ref={selectoRef}\r\n                    dragContainer={window}\r\n                    selectableTargets={['.certificate-element']}\r\n                    hitRate={0}\r\n                    selectByClick={true}\r\n                    selectFromInside={false}\r\n                    toggleContinueSelect={['shift']}\r\n                    onSelect={e => {\r\n                        const ids = e.selected.map(el => el.getAttribute('data-id') || '').filter(Boolean);\r\n                        if (ids.length > 0) {\r\n                            setSelectedIds(ids);\r\n                        }\r\n                    }}\r\n                />\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\certificates\\components\\PropertiesPanel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\certificates\\components\\Toolbar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\certificates\\context\\CertificateContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":195,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":195,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useCallback } from 'react';\r\nimport { CertificateElement, CertificateTemplate } from '../types';\r\n\r\ninterface HistoryState {\r\n    elements: CertificateElement[];\r\n    backgroundUrl: string;\r\n}\r\n\r\ninterface CertificateContextType {\r\n    // State\r\n    elements: CertificateElement[];\r\n    selectedIds: string[];\r\n    backgroundUrl: string;\r\n    zoom: number;\r\n    name: string;\r\n\r\n    // Actions\r\n    setName: (name: string) => void;\r\n    setZoom: (zoom: number | ((prev: number) => number)) => void;\r\n    setBackgroundUrl: (url: string) => void;\r\n\r\n    // Element Actions\r\n    addElement: (type: 'text' | 'variable' | 'qrcode', text?: string) => void;\r\n    updateElement: (id: string, updates: Partial<CertificateElement>) => void;\r\n    deleteSelected: () => void;\r\n    duplicateSelected: () => void;\r\n\r\n    // Selection\r\n    setSelectedIds: (ids: string[]) => void;\r\n    toggleSelection: (id: string) => void;\r\n\r\n    // Layering\r\n    bringToFront: () => void;\r\n    sendToBack: () => void;\r\n\r\n    // History\r\n    undo: () => void;\r\n    redo: () => void;\r\n    canUndo: boolean;\r\n    canRedo: boolean;\r\n    saveSnapshot: () => void;\r\n\r\n    // Load\r\n    loadTemplate: (template: CertificateTemplate) => void;\r\n}\r\n\r\nconst CertificateContext = createContext<CertificateContextType | null>(null);\r\n\r\nexport const CertificateProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    // State\r\n    const [name, setName] = useState('Novo Modelo');\r\n    const [elements, setElements] = useState<CertificateElement[]>([]);\r\n    const [backgroundUrl, setBackgroundUrl] = useState('');\r\n    const [selectedIds, setSelectedIds] = useState<string[]>([]);\r\n    const [zoom, setZoom] = useState(0.8);\r\n\r\n    // History Stacks\r\n    const [past, setPast] = useState<HistoryState[]>([]);\r\n    const [future, setFuture] = useState<HistoryState[]>([]);\r\n\r\n    // Snapshot for Undo/Redo\r\n    const saveSnapshot = useCallback(() => {\r\n        setPast(prev => [...prev.slice(-20), { elements, backgroundUrl }]); // Keep last 20\r\n        setFuture([]);\r\n    }, [elements, backgroundUrl]);\r\n\r\n    // Undo/Redo Logic\r\n    const undo = useCallback(() => {\r\n        if (past.length === 0) return;\r\n        const previous = past[past.length - 1];\r\n        const newPast = past.slice(0, -1);\r\n\r\n        setFuture(prev => [{ elements, backgroundUrl }, ...prev]);\r\n        setElements(previous.elements);\r\n        setBackgroundUrl(previous.backgroundUrl);\r\n        setPast(newPast);\r\n    }, [past, elements, backgroundUrl]);\r\n\r\n    const redo = useCallback(() => {\r\n        if (future.length === 0) return;\r\n        const next = future[0];\r\n        const newFuture = future.slice(1);\r\n\r\n        setPast(prev => [...prev, { elements, backgroundUrl }]);\r\n        setElements(next.elements);\r\n        setBackgroundUrl(next.backgroundUrl);\r\n        setFuture(newFuture);\r\n    }, [future, elements, backgroundUrl]);\r\n\r\n    // Actions\r\n    const addElement = useCallback((type: 'text' | 'variable' | 'qrcode', text?: string) => {\r\n        saveSnapshot();\r\n        const newId = Date.now().toString(36) + Math.random().toString(36).substr(2);\r\n        const newElement: CertificateElement = {\r\n            id: newId,\r\n            type,\r\n            x: 50,\r\n            y: 50,\r\n            width: type === 'qrcode' ? 100 : 200,\r\n            height: type === 'qrcode' ? 100 : 40,\r\n            text: text || (type === 'text' ? 'Novo Texto' : type === 'qrcode' ? 'QR Code' : '{{variavel}}'),\r\n            fontSize: type === 'text' ? 24 : 14,\r\n            fontFamily: 'Helvetica',\r\n            color: '#000000',\r\n            align: 'left',\r\n            rotate: 0,\r\n            opacity: 1\r\n        };\r\n        setElements(prev => [...prev, newElement]);\r\n        setSelectedIds([newId]);\r\n    }, [saveSnapshot]);\r\n\r\n    const updateElement = useCallback((id: string, updates: Partial<CertificateElement>) => {\r\n        setElements(prev => prev.map(el => el.id === id ? { ...el, ...updates } : el));\r\n    }, []);\r\n\r\n    const deleteSelected = useCallback(() => {\r\n        saveSnapshot();\r\n        setElements(prev => prev.filter(el => !selectedIds.includes(el.id)));\r\n        setSelectedIds([]);\r\n    }, [selectedIds, saveSnapshot]);\r\n\r\n    const toggleSelection = useCallback((id: string) => {\r\n        setSelectedIds(prev => prev.includes(id) ? prev.filter(i => i !== id) : [...prev, id]);\r\n    }, []);\r\n\r\n    const duplicateSelected = useCallback(() => {\r\n        saveSnapshot();\r\n        setElements(prev => {\r\n            const newElements = [...prev];\r\n            const newIds: string[] = [];\r\n\r\n            selectedIds.forEach(id => {\r\n                const el = prev.find(e => e.id === id);\r\n                if (el) {\r\n                    const newId = Date.now().toString(36) + Math.random().toString(36).substr(2);\r\n                    newElements.push({\r\n                        ...el,\r\n                        id: newId,\r\n                        x: el.x + 20,\r\n                        y: el.y + 20\r\n                    });\r\n                    newIds.push(newId);\r\n                }\r\n            });\r\n\r\n            if (newIds.length > 0) setSelectedIds(newIds);\r\n            return newElements;\r\n        });\r\n    }, [selectedIds, saveSnapshot]);\r\n\r\n    const bringToFront = useCallback(() => {\r\n        if (selectedIds.length === 0) return;\r\n        saveSnapshot();\r\n        setElements(prev => {\r\n            const moving = prev.filter(el => selectedIds.includes(el.id));\r\n            const others = prev.filter(el => !selectedIds.includes(el.id));\r\n            return [...others, ...moving];\r\n        });\r\n    }, [selectedIds, saveSnapshot]);\r\n\r\n    const sendToBack = useCallback(() => {\r\n        if (selectedIds.length === 0) return;\r\n        saveSnapshot();\r\n        setElements(prev => {\r\n            const moving = prev.filter(el => selectedIds.includes(el.id));\r\n            const others = prev.filter(el => !selectedIds.includes(el.id));\r\n            return [...moving, ...others];\r\n        });\r\n    }, [selectedIds, saveSnapshot]);\r\n\r\n    const loadTemplate = useCallback((template: CertificateTemplate) => {\r\n        setName(template.name);\r\n        setElements(template.elements);\r\n        setBackgroundUrl(template.backgroundUrl);\r\n        setPast([]);\r\n        setFuture([]);\r\n    }, []);\r\n\r\n    return (\r\n        <CertificateContext.Provider value={{\r\n            elements, selectedIds, backgroundUrl, zoom, name,\r\n            setName, setZoom, setBackgroundUrl,\r\n            addElement, updateElement, deleteSelected, duplicateSelected,\r\n            setSelectedIds, toggleSelection,\r\n            bringToFront, sendToBack,\r\n            undo, redo, canUndo: past.length > 0, canRedo: future.length > 0, saveSnapshot,\r\n            loadTemplate\r\n        }}>\r\n            {children}\r\n        </CertificateContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useCertificate = () => {\r\n    const context = useContext(CertificateContext);\r\n    if (!context) throw new Error(\"useCertificate must be used within CertificateProvider\");\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\certificates\\index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\certificates\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\components\\DashboardSalesWidget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminAIAssistant.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminAchievementForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminAchievements.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminAnalytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminCategories.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminCategoryForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminEventCheckIn.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":9,"column":50,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":9,"endColumn":53,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[412,415],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[412,415],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`handleCheckIn` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminEventCheckIn.tsx:21:13\n  19 |         scanner.render((decodedText) => {\n  20 |             // Handle scan\n> 21 |             handleCheckIn(decodedText);\n     |             ^^^^^^^^^^^^^ `handleCheckIn` accessed before it is declared\n  22 |             scanner.clear();\n  23 |         }, (err) => {\n  24 |             // console.log(err);\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminEventCheckIn.tsx:32:5\n  30 |     }, []);\n  31 |\n> 32 |     const handleCheckIn = async (code: string) => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 33 |         setError(null);\n     | ^^^^^^^^^^^^^^^^^^^^^^^\n> 34 |         setScanResult(null);\n     | ^^^^^^^^^^^^^^^^^^^^^^^\n> 35 |         try {\n     | ^^^^^^^^^^^^^^^^^^^^^^^\n> 36 |             const res = await api.post('/registrations/checkin', { code });\n     | ^^^^^^^^^^^^^^^^^^^^^^^\n> 37 |             setScanResult(res.data.registration);\n     | ^^^^^^^^^^^^^^^^^^^^^^^\n> 38 |         } catch (err: any) {\n     | ^^^^^^^^^^^^^^^^^^^^^^^\n> 39 |             setError(err.response?.data?.error || \"Erro ao fazer check-in\");\n     | ^^^^^^^^^^^^^^^^^^^^^^^\n> 40 |         }\n     | ^^^^^^^^^^^^^^^^^^^^^^^\n> 41 |     };\n     | ^^^^^^^ `handleCheckIn` is declared here\n  42 |\n  43 |     return (\n  44 |         <div className=\"max-w-md mx-auto p-6\">","line":21,"column":13,"nodeType":null,"endLine":21,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":23,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":23,"endColumn":16},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1320,1323],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1320,1323],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { useParams, Link } from 'react-router-dom';\r\nimport { Html5QrcodeScanner } from 'html5-qrcode';\r\nimport { ArrowLeft, UserCheck, AlertTriangle } from 'lucide-react';\r\nimport { api } from '../../../api/client';\r\n\r\nexport const AdminEventCheckIn: React.FC = () => {\r\n    const { id } = useParams<{ id: string }>();\r\n    const [scanResult, setScanResult] = useState<any>(null);\r\n    const [error, setError] = useState<string | null>(null);\r\n\r\n    React.useEffect(() => {\r\n        const scanner = new Html5QrcodeScanner(\r\n            \"reader\",\r\n            { fps: 10, qrbox: { width: 250, height: 250 } },\r\n            /* verbose= */ false\r\n        );\r\n\r\n        scanner.render((decodedText) => {\r\n            // Handle scan\r\n            handleCheckIn(decodedText);\r\n            scanner.clear();\r\n        }, (err) => {\r\n            // console.log(err);\r\n        });\r\n\r\n        return () => {\r\n            scanner.clear().catch(e => console.error(\"Scanner clear error\", e));\r\n        };\r\n    }, []);\r\n\r\n    const handleCheckIn = async (code: string) => {\r\n        setError(null);\r\n        setScanResult(null);\r\n        try {\r\n            const res = await api.post('/registrations/checkin', { code });\r\n            setScanResult(res.data.registration);\r\n        } catch (err: any) {\r\n            setError(err.response?.data?.error || \"Erro ao fazer check-in\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"max-w-md mx-auto p-6\">\r\n            <div className=\"flex items-center gap-2 mb-6\">\r\n                <Link to={`/admin/eventos/${id}/dashboard`} className=\"p-2 -ml-2 hover:bg-gray-100 rounded-full\">\r\n                    <ArrowLeft className=\"w-5 h-5 text-gray-600\" />\r\n                </Link>\r\n                <h1 className=\"text-xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent\">\r\n                    Check-in\r\n                </h1>\r\n            </div>\r\n\r\n            <div className=\"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden\">\r\n                <div id=\"reader\" className=\"w-full h-80 bg-black\"></div>\r\n\r\n                <div className=\"p-6\">\r\n                    <p className=\"text-center text-gray-500 text-sm mb-4\">\r\n                        Aponte a c√¢mera para o QR Code do ingresso\r\n                    </p>\r\n\r\n                    {scanResult && (\r\n                        <div className=\"bg-green-50 border border-green-200 rounded-lg p-4 animate-fadeIn\">\r\n                            <div className=\"flex items-center gap-3 mb-2\">\r\n                                <div className=\"bg-green-100 p-2 rounded-full\">\r\n                                    <UserCheck className=\"w-6 h-6 text-green-600\" />\r\n                                </div>\r\n                                <div>\r\n                                    <h3 className=\"font-bold text-green-800\">Check-in Confirmado!</h3>\r\n                                    <p className=\"text-green-600 text-sm\">{new Date().toLocaleTimeString()}</p>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"text-sm text-gray-700 ml-12\">\r\n                                <p><strong>Participante:</strong> {scanResult.guestName || \"Visitante\"}</p>\r\n                                <p><strong>Ingresso:</strong> {scanResult.code}</p>\r\n                            </div>\r\n                            <button onClick={() => setScanResult(null)} className=\"btn btn-primary w-full mt-4\">\r\n                                Ler Pr√≥ximo\r\n                            </button>\r\n                        </div>\r\n                    )}\r\n\r\n                    {error && (\r\n                        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4 animate-fadeIn\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <AlertTriangle className=\"w-6 h-6 text-red-600\" />\r\n                                <div>\r\n                                    <h3 className=\"font-bold text-red-800\">Erro no Check-in</h3>\r\n                                    <p className=\"text-red-600 text-sm\">{error}</p>\r\n                                </div>\r\n                            </div>\r\n                            <button onClick={() => setError(null)} className=\"btn btn-secondary w-full mt-4\">\r\n                                Tentar Novamente\r\n                            </button>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n            </div>\r\n\r\n            <div className=\"mt-8\">\r\n                <h3 className=\"font-semibold mb-2\">Entrada Manual</h3>\r\n                <div className=\"flex gap-2\">\r\n                    <input\r\n                        className=\"input flex-1\"\r\n                        placeholder=\"C√≥digo do ingresso\"\r\n                        onKeyDown={e => {\r\n                            if (e.key === 'Enter') handleCheckIn((e.target as HTMLInputElement).value);\r\n                        }}\r\n                    />\r\n                    <button className=\"btn btn-secondary\">Buscar</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminEventDashboard.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'BarChart' is defined but never used.","line":5,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":10,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[476,479],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[476,479],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[678,681],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[678,681],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":27,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":27,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1081,1084],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1081,1084],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":62,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":65,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1173,1176],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1173,1176],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1451,1454],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1451,1454],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\r\nimport { useParams, Link } from 'react-router-dom';\r\nimport { api } from '../../../api/client';\r\nimport { useAuth } from '../../auth/AuthContext';\r\nimport { BarChart, Users, DollarSign, Calendar, Eye, Settings, QrCode } from 'lucide-react';\r\n\r\nexport const AdminEventDashboard: React.FC = () => {\r\n    const { id } = useParams<{ id: string }>();\r\n    const { tenantId } = useAuth();\r\n    const [event, setEvent] = useState<any>(null);\r\n    const [stats, setStats] = useState({\r\n        ticketsSold: 0,\r\n        totalTickets: 0,\r\n        revenue: 0,\r\n        views: 1240, // Mocked for now\r\n        recentRegistrations: [] as any[]\r\n    });\r\n\r\n    useEffect(() => {\r\n        if (id && tenantId) {\r\n            // Fetch Event\r\n            api.get(`/events/${id}`).then(res => setEvent(res.data)).catch(console.error);\r\n\r\n            // Fetch Tickets to calc total\r\n            api.get(`/events/${id}/tickets`).then(res => {\r\n                const tickets = res.data;\r\n                const total = tickets.reduce((acc: number, t: any) => acc + t.quantity, 0);\r\n                const sold = tickets.reduce((acc: number, t: any) => acc + t.sold, 0);\r\n                // Calculate simple revenue based on tickets sold (approx) if backend doesn't give precise\r\n                // Ideally backend gives this. We'll sum up price * sold for now.\r\n                const rev = tickets.reduce((acc: number, t: any) => acc + (t.sold * Number(t.price)), 0);\r\n\r\n                setStats(prev => ({ ...prev, totalTickets: total, ticketsSold: sold, revenue: rev }));\r\n            }).catch(console.error);\r\n\r\n            // Fetch recent registrations (mocked or real endpoint if exists)\r\n            // api.get(`/events/${id}/registrations?limit=5`).then...\r\n        }\r\n    }, [id, tenantId]);\r\n\r\n    if (!event) return <div className=\"p-8\">Carregando...</div>;\r\n\r\n    return (\r\n        <div className=\"p-6 max-w-7xl mx-auto\">\r\n            {/* Header */}\r\n            <div className=\"flex justify-between items-center mb-8\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-gray-900\">{event.title}</h1>\r\n                    <div className=\"flex items-center gap-2 text-gray-500 mt-1\">\r\n                        <Calendar className=\"w-4 h-4\" />\r\n                        <span>{new Date(event.startDate).toLocaleDateString()}</span>\r\n                        <span className=\"bg-green-100 text-green-700 px-2 py-0.5 rounded text-xs font-semibold\">\r\n                            Publicado\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"flex gap-3\">\r\n                    <Link to={`/admin/eventos/${id}/checkin`} className=\"btn btn-secondary flex items-center gap-2 px-4 py-2 bg-gray-100 rounded-lg hover:bg-gray-200\">\r\n                        <QrCode className=\"w-4 h-4\" /> Check-in\r\n                    </Link>\r\n                    <Link to={`/admin/eventos/${id}`} className=\"btn flex items-center gap-2 px-4 py-2 bg-gray-900 text-white rounded-lg hover:bg-gray-800\">\r\n                        <Settings className=\"w-4 h-4\" /> Editar\r\n                    </Link>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Sales Analytics Widget (Sympla Killer) */}\r\n            {/* Sales Analytics Widget (Sympla Killer) */}\r\n            <DashboardSalesWidget />\r\n\r\n            {/* Stats Cards */}\r\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n                <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100\">\r\n                    <div className=\"flex justify-between items-start\">\r\n                        <div>\r\n                            <p className=\"text-sm font-medium text-gray-500\">Ingressos Vendidos</p>\r\n                            <h3 className=\"text-3xl font-bold text-gray-900 mt-2\">\r\n                                {stats.ticketsSold} <span className=\"text-gray-400 text-lg font-normal\">/ {stats.totalTickets}</span>\r\n                            </h3>\r\n                        </div>\r\n                        <div className=\"p-2 bg-blue-50 text-blue-600 rounded-lg\">\r\n                            <Users className=\"w-6 h-6\" />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"w-full bg-gray-100 rounded-full h-2 mt-4\">\r\n                        <div\r\n                            className=\"bg-blue-600 h-2 rounded-full\"\r\n                            style={{ width: `${stats.totalTickets > 0 ? (stats.ticketsSold / stats.totalTickets) * 100 : 0}%` }}\r\n                        ></div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100\">\r\n                    <div className=\"flex justify-between items-start\">\r\n                        <div>\r\n                            <p className=\"text-sm font-medium text-gray-500\">Receita Total</p>\r\n                            <h3 className=\"text-3xl font-bold text-gray-900 mt-2\">\r\n                                R$ {stats.revenue.toLocaleString('pt-BR', { minimumFractionDigits: 2 })}\r\n                            </h3>\r\n                        </div>\r\n                        <div className=\"p-2 bg-green-50 text-green-600 rounded-lg\">\r\n                            <DollarSign className=\"w-6 h-6\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"bg-white p-6 rounded-xl shadow-sm border border-gray-100\">\r\n                    <div className=\"flex justify-between items-start\">\r\n                        <div>\r\n                            <p className=\"text-sm font-medium text-gray-500\">Visualiza√ß√µes</p>\r\n                            <h3 className=\"text-3xl font-bold text-gray-900 mt-2\">\r\n                                {stats.views}\r\n                            </h3>\r\n                        </div>\r\n                        <div className=\"p-2 bg-purple-50 text-purple-600 rounded-lg\">\r\n                            <Eye className=\"w-6 h-6\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div >\r\n\r\n            {/* Content Row */}\r\n            < div className=\"grid grid-cols-1 lg:grid-cols-3 gap-8\" >\r\n                {/* Recent Registrations */}\r\n                < div className=\"lg:col-span-2 bg-white rounded-xl shadow-sm border border-gray-200\" >\r\n                    <div className=\"p-6 border-b border-gray-100 flex justify-between items-center\">\r\n                        <h3 className=\"font-bold text-gray-800\">Inscri√ß√µes Recentes</h3>\r\n                        <button className=\"text-blue-600 text-sm font-medium hover:underline\">Ver todas</button>\r\n                    </div>\r\n                    <div className=\"p-6\">\r\n                        {/* Placeholder for table */}\r\n                        <div className=\"text-center text-gray-500 py-8\">\r\n                            Nenhuma inscri√ß√£o recente.\r\n                        </div>\r\n                    </div>\r\n                </div >\r\n\r\n                {/* Quick Actions / Tips */}\r\n                < div className=\"space-y-6\" >\r\n                    <div className=\"bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl p-6 text-white text-center\">\r\n                        <QrCode className=\"w-12 h-12 mx-auto mb-4 opacity-80\" />\r\n                        <h3 className=\"font-bold text-lg mb-2\">Check-in R√°pido</h3>\r\n                        <p className=\"text-blue-100 text-sm mb-4\">Acesse a c√¢mera para ler QR Codes dos participantes na entrada.</p>\r\n                        <Link to={`/admin/eventos/${id}/checkin`} className=\"btn bg-white text-blue-700 hover:bg-blue-50 w-full block\">\r\n                            Abrir Scanner\r\n                        </Link>\r\n                    </div>\r\n                </div >\r\n            </div >\r\n        </div >\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminEventForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ImageIcon' is defined but never used.","line":7,"column":44,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":53},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'t' is assigned a value but never used.","line":22,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":22,"endColumn":12},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":398,"column":81,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":398,"endColumn":84,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16204,16207],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16204,16207],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { api } from \"../../../api/client\";\r\nimport { useAuth } from \"../../auth/AuthContext\";\r\nimport { useParams, useNavigate } from \"react-router-dom\";\r\nimport {\r\n  Calendar, MapPin, Ticket, User, Image as ImageIcon,\r\n  ChevronRight, ChevronLeft, Check, Plus, Trash2, Globe, Video\r\n} from 'lucide-react';\r\n\r\n// Types\r\ninterface TicketData {\r\n  id?: string;\r\n  name: string;\r\n  type: 'FREE' | 'PAID';\r\n  price: number;\r\n  quantity: number;\r\n  absorbFee: boolean;\r\n}\r\n\r\nexport const AdminEventForm: React.FC = () => {\r\n  const { t } = useTranslation();\r\n  const { id } = useParams<{ id: string }>();\r\n  const { tenantId } = useAuth();\r\n  const isEdit = Boolean(id);\r\n  const navigate = useNavigate();\r\n\r\n  const [step, setStep] = useState(1);\r\n  const [loading, setLoading] = useState(false);\r\n  const [categories, setCategories] = useState<{ id: string, name: string }[]>([]);\r\n\r\n  // Form State\r\n  const [formData, setFormData] = useState({\r\n    title: \"\",\r\n    description: \"\",\r\n    categoryId: \"\",\r\n    coverImageUrl: \"\",\r\n\r\n    // Format\r\n    format: \"PRESENTIAL\", // PRESENTIAL, ONLINE\r\n    startDate: \"\",\r\n    endDate: \"\",\r\n\r\n    // Presential\r\n    location: \"\",\r\n    zipCode: \"\",\r\n    address: \"\",\r\n    number: \"\",\r\n    complement: \"\",\r\n    neighborhood: \"\",\r\n    city: \"\",\r\n    state: \"\",\r\n\r\n    // Online\r\n    platform: \"ZOOM\",\r\n    meetingLink: \"\",\r\n\r\n    // Producer\r\n    producerName: \"\",\r\n    producerDescription: \"\",\r\n    producerLogoUrl: \"\",\r\n\r\n    // Certificate\r\n    certificateBackgroundUrl: \"\",\r\n    minMinutesForCertificate: \"\",\r\n\r\n    // Visibility\r\n    visibility: \"PUBLIC\" // PUBLIC, PRIVATE\r\n  });\r\n\r\n  const [tickets, setTickets] = useState<TicketData[]>([]);\r\n\r\n  // Load Data\r\n  useEffect(() => {\r\n    if (tenantId) {\r\n      // Fetch Categories\r\n      api.get(\"/categories\", { params: { tenantId, type: 'EVENT' } })\r\n        .then(res => setCategories(res.data))\r\n        .catch(console.error);\r\n    }\r\n\r\n    if (id && tenantId) {\r\n      setLoading(true);\r\n      api.get(`/events/${id}`)\r\n        .then(async (res) => {\r\n          const data = res.data;\r\n          setFormData({\r\n            title: data.title || \"\",\r\n            description: data.description || \"\",\r\n            categoryId: data.categoryId || \"\",\r\n            coverImageUrl: data.coverImageUrl || \"\",\r\n            format: data.format || (data.isOnline ? \"ONLINE\" : \"PRESENTIAL\"),\r\n            startDate: data.startDate ? new Date(data.startDate).toISOString().slice(0, 16) : \"\",\r\n            endDate: data.endDate ? new Date(data.endDate).toISOString().slice(0, 16) : \"\",\r\n            location: data.location || \"\",\r\n            zipCode: data.zipCode || \"\",\r\n            address: data.address || \"\",\r\n            number: data.number || \"\",\r\n            complement: data.complement || \"\",\r\n            neighborhood: data.neighborhood || \"\",\r\n            city: data.city || \"\",\r\n            state: data.state || \"\",\r\n            platform: data.platform || \"ZOOM\",\r\n            meetingLink: data.meetingLink || \"\",\r\n            producerName: data.producerName || \"\",\r\n            producerDescription: data.producerDescription || \"\",\r\n            producerLogoUrl: data.producerLogoUrl || \"\",\r\n            certificateBackgroundUrl: data.certificateBackgroundUrl || \"\",\r\n            minMinutesForCertificate: data.minMinutesForCertificate || \"\",\r\n            visibility: data.visibility || \"PUBLIC\"\r\n          });\r\n\r\n          // Fetch tickets\r\n          try {\r\n            const ticketRes = await api.get(`/events/${id}/tickets`);\r\n            setTickets(ticketRes.data);\r\n          } catch (e) {\r\n            console.error(\"Error fetching tickets\", e);\r\n          }\r\n        })\r\n        .catch(console.error)\r\n        .finally(() => setLoading(false));\r\n    }\r\n  }, [id, tenantId]);\r\n\r\n  const refreshGeocoding = async (cep: string) => {\r\n    if (cep.length === 8) {\r\n      try {\r\n        const res = await fetch(`https://viacep.com.br/ws/${cep}/json/`);\r\n        const data = await res.json();\r\n        if (!data.erro) {\r\n          setFormData(prev => ({\r\n            ...prev,\r\n            address: data.logradouro,\r\n            neighborhood: data.bairro,\r\n            city: data.localidade,\r\n            state: data.uf\r\n          }));\r\n        }\r\n      } catch (e) { console.error(e); }\r\n    }\r\n  }\r\n\r\n  const handleSubmit = async () => {\r\n    if (!tenantId) return;\r\n    setLoading(true);\r\n\r\n    try {\r\n      // 1. Save Event\r\n      const payload = {\r\n        ...formData,\r\n        tenantId,\r\n        startDate: new Date(formData.startDate).toISOString(),\r\n        endDate: formData.endDate ? new Date(formData.endDate).toISOString() : null,\r\n        isOnline: formData.format === 'ONLINE',\r\n        minMinutesForCertificate: formData.minMinutesForCertificate ? Number(formData.minMinutesForCertificate) : null\r\n      };\r\n\r\n      let eventId = id;\r\n\r\n      if (id) {\r\n        await api.put(`/events/${id}`, payload);\r\n      } else {\r\n        const res = await api.post(\"/events\", payload);\r\n        eventId = res.data.id;\r\n      }\r\n\r\n      // 2. Save Tickets (Create only for now, simple logic)\r\n      if (eventId) {\r\n        for (const t of tickets) {\r\n          if (!t.id) { // New ticket\r\n            await api.post(`/events/${eventId}/tickets`, t);\r\n          } else {\r\n            // Optional: Update ticket if modified\r\n          }\r\n        }\r\n      }\r\n\r\n      navigate(\"/admin/eventos\");\r\n    } catch (error) {\r\n      console.error(\"Error saving event\", error);\r\n      alert(\"Erro ao salvar evento. Verifique os dados.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const steps = [\r\n    { id: 1, label: \"Informa√ß√µes B√°sicas\", icon: <Calendar className=\"w-5 h-5\" /> },\r\n    { id: 2, label: \"Quando e Onde\", icon: <MapPin className=\"w-5 h-5\" /> },\r\n    { id: 3, label: \"Ingressos\", icon: <Ticket className=\"w-5 h-5\" /> },\r\n    { id: 4, label: \"Divulga√ß√£o\", icon: <User className=\"w-5 h-5\" /> }\r\n  ];\r\n\r\n  const renderStepContent = () => {\r\n    switch (step) {\r\n      case 1:\r\n        return (\r\n          <div className=\"space-y-6 animate-fadeIn\">\r\n            <h2 className=\"text-2xl font-bold mb-4\">Informa√ß√µes B√°sicas</h2>\r\n\r\n            <div className=\"form-group\">\r\n              <label>Nome do Evento *</label>\r\n              <input\r\n                className=\"input w-full text-lg font-medium\"\r\n                value={formData.title}\r\n                onChange={e => setFormData({ ...formData, title: e.target.value })}\r\n                placeholder=\"Ex: Workshop de Fotografia\"\r\n              />\r\n            </div>\r\n\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <div className=\"form-group\">\r\n                <label>Assunto / Categoria</label>\r\n                <select\r\n                  className=\"input w-full\"\r\n                  value={formData.categoryId}\r\n                  onChange={e => setFormData({ ...formData, categoryId: e.target.value })}\r\n                >\r\n                  <option value=\"\">Selecione...</option>\r\n                  {categories.map(c => <option key={c.id} value={c.id}>{c.name}</option>)}\r\n                </select>\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <label>Formato</label>\r\n                <div className=\"flex gap-2\">\r\n                  <button\r\n                    className={`flex-1 btn ${formData.format === 'PRESENTIAL' ? 'btn-primary' : 'bg-gray-200 text-gray-700'}`}\r\n                    onClick={() => setFormData({ ...formData, format: 'PRESENTIAL' })}\r\n                  >\r\n                    <MapPin className=\"w-4 h-4 mr-2\" /> Presencial\r\n                  </button>\r\n                  <button\r\n                    className={`flex-1 btn ${formData.format === 'ONLINE' ? 'btn-primary' : 'bg-gray-200 text-gray-700'}`}\r\n                    onClick={() => setFormData({ ...formData, format: 'ONLINE' })}\r\n                  >\r\n                    <Video className=\"w-4 h-4 mr-2\" /> Online\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"form-group\">\r\n              <label>Imagem de Capa (URL)</label>\r\n              <div className=\"flex gap-2\">\r\n                <input\r\n                  className=\"input flex-1\"\r\n                  value={formData.coverImageUrl}\r\n                  onChange={e => setFormData({ ...formData, coverImageUrl: e.target.value })}\r\n                  placeholder=\"https://...\"\r\n                />\r\n                <div className=\"w-20 h-10 bg-gray-100 rounded overflow-hidden border\">\r\n                  {formData.coverImageUrl && <img src={formData.coverImageUrl} className=\"w-full h-full object-cover\" />}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className=\"form-group\">\r\n              <label>Descri√ß√£o</label>\r\n              <textarea\r\n                className=\"input w-full\"\r\n                rows={5}\r\n                value={formData.description}\r\n                onChange={e => setFormData({ ...formData, description: e.target.value })}\r\n                placeholder=\"Detalhes do evento...\"\r\n              />\r\n            </div>\r\n          </div>\r\n        );\r\n      case 2:\r\n        return (\r\n          <div className=\"space-y-6 animate-fadeIn\">\r\n            <h2 className=\"text-2xl font-bold mb-4\">Quando e Onde?</h2>\r\n\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <div className=\"form-group\">\r\n                <label>Data de In√≠cio *</label>\r\n                <input type=\"datetime-local\" className=\"input w-full\" value={formData.startDate} onChange={e => setFormData({ ...formData, startDate: e.target.value })} />\r\n              </div>\r\n              <div className=\"form-group\">\r\n                <label>Data de T√©rmino</label>\r\n                <input type=\"datetime-local\" className=\"input w-full\" value={formData.endDate} onChange={e => setFormData({ ...formData, endDate: e.target.value })} />\r\n              </div>\r\n            </div>\r\n\r\n            <hr className=\"my-6 border-gray-200\" />\r\n\r\n            {formData.format === 'PRESENTIAL' ? (\r\n              <>\r\n                <h3 className=\"text-lg font-semibold mb-2\">Local do Evento</h3>\r\n                <div className=\"form-group\">\r\n                  <label>Nome do Local (Ex: Teatro Municipal)</label>\r\n                  <input className=\"input w-full\" value={formData.location} onChange={e => setFormData({ ...formData, location: e.target.value })} />\r\n                </div>\r\n                <div className=\"grid grid-cols-4 gap-4\">\r\n                  <div className=\"form-group col-span-1\">\r\n                    <label>CEP</label>\r\n                    <input\r\n                      className=\"input w-full\"\r\n                      value={formData.zipCode}\r\n                      onChange={e => {\r\n                        const v = e.target.value.replace(/\\D/g, '');\r\n                        setFormData({ ...formData, zipCode: v });\r\n                        if (v.length === 8) refreshGeocoding(v);\r\n                      }}\r\n                      placeholder=\"00000-000\"\r\n                      maxLength={8}\r\n                    />\r\n                  </div>\r\n                  <div className=\"form-group col-span-2\">\r\n                    <label>Cidade</label>\r\n                    <input className=\"input w-full\" value={formData.city} onChange={e => setFormData({ ...formData, city: e.target.value })} />\r\n                  </div>\r\n                  <div className=\"form-group col-span-1\">\r\n                    <label>Estado</label>\r\n                    <input className=\"input w-full\" value={formData.state} onChange={e => setFormData({ ...formData, state: e.target.value })} />\r\n                  </div>\r\n                </div>\r\n                <div className=\"grid grid-cols-4 gap-4\">\r\n                  <div className=\"form-group col-span-3\">\r\n                    <label>Endere√ßo</label>\r\n                    <input className=\"input w-full\" value={formData.address} onChange={e => setFormData({ ...formData, address: e.target.value })} />\r\n                  </div>\r\n                  <div className=\"form-group col-span-1\">\r\n                    <label>N√∫mero</label>\r\n                    <input className=\"input w-full\" value={formData.number} onChange={e => setFormData({ ...formData, number: e.target.value })} />\r\n                  </div>\r\n                </div>\r\n              </>\r\n            ) : (\r\n              <>\r\n                <h3 className=\"text-lg font-semibold mb-2\">Transmiss√£o Online</h3>\r\n                <div className=\"form-group\">\r\n                  <label>Plataforma</label>\r\n                  <select className=\"input w-full\" value={formData.platform} onChange={e => setFormData({ ...formData, platform: e.target.value })}>\r\n                    <option value=\"ZOOM\">Zoom</option>\r\n                    <option value=\"MEET\">Google Meet</option>\r\n                    <option value=\"YOUTUBE\">YouTube Live</option>\r\n                    <option value=\"OTHER\">Outra</option>\r\n                  </select>\r\n                </div>\r\n                <div className=\"form-group\">\r\n                  <label>Link da Transmiss√£o</label>\r\n                  <input className=\"input w-full\" value={formData.meetingLink} onChange={e => setFormData({ ...formData, meetingLink: e.target.value })} placeholder=\"https://...\" />\r\n                </div>\r\n              </>\r\n            )}\r\n          </div>\r\n        );\r\n      case 3:\r\n        return (\r\n          <div className=\"space-y-6 animate-fadeIn\">\r\n            <div className=\"flex justify-between items-center mb-4\">\r\n              <h2 className=\"text-2xl font-bold\">Ingressos</h2>\r\n              <button\r\n                className=\"btn flex items-center gap-2\"\r\n                onClick={() => setTickets([...tickets, { name: 'Novo Ingresso', type: 'FREE', price: 0, quantity: 100, absorbFee: false }])}\r\n              >\r\n                <Plus className=\"w-4 h-4\" /> Criar Ingresso\r\n              </button>\r\n            </div>\r\n\r\n            {tickets.length === 0 && (\r\n              <div className=\"text-center py-10 bg-gray-50 rounded-lg border border-dashed border-gray-300\">\r\n                <Ticket className=\"w-12 h-12 text-gray-300 mx-auto mb-2\" />\r\n                <p className=\"text-gray-500\">Nenhum ingresso criado ainda.</p>\r\n              </div>\r\n            )}\r\n\r\n            <div className=\"space-y-4\">\r\n              {tickets.map((t, idx) => (\r\n                <div key={idx} className=\"bg-white p-4 rounded-lg shadow-sm border border-gray-200 flex flex-col gap-4\">\r\n                  <div className=\"flex justify-between items-start\">\r\n                    <h4 className=\"font-semibold text-gray-700\">Ingresso #{idx + 1}</h4>\r\n                    <button className=\"text-red-500 hover:bg-red-50 p-1 rounded\" onClick={() => {\r\n                      const n = [...tickets]; n.splice(idx, 1); setTickets(n);\r\n                    }}>\r\n                      <Trash2 className=\"w-4 h-4\" />\r\n                    </button>\r\n                  </div>\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div className=\"form-group\">\r\n                      <label>Nome</label>\r\n                      <input className=\"input w-full\" value={t.name} onChange={e => {\r\n                        const n = [...tickets]; n[idx].name = e.target.value; setTickets(n);\r\n                      }} />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                      <label>Quantidade</label>\r\n                      <input type=\"number\" className=\"input w-full\" value={t.quantity} onChange={e => {\r\n                        const n = [...tickets]; n[idx].quantity = Number(e.target.value); setTickets(n);\r\n                      }} />\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"grid grid-cols-2 gap-4\">\r\n                    <div className=\"form-group\">\r\n                      <label>Tipo</label>\r\n                      <select className=\"input w-full\" value={t.type} onChange={e => {\r\n                        const n = [...tickets]; n[idx].type = e.target.value as any; setTickets(n);\r\n                      }}>\r\n                        <option value=\"FREE\">Gratuito</option>\r\n                        <option value=\"PAID\">Pago</option>\r\n                      </select>\r\n                    </div>\r\n                    {t.type === 'PAID' && (\r\n                      <div className=\"form-group\">\r\n                        <label>Pre√ßo (R$)</label>\r\n                        <input type=\"number\" step=\"0.01\" className=\"input w-full\" value={t.price} onChange={e => {\r\n                          const n = [...tickets]; n[idx].price = Number(e.target.value); setTickets(n);\r\n                        }} />\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        );\r\n      case 4:\r\n        return (\r\n          <div className=\"space-y-6 animate-fadeIn\">\r\n            <h2 className=\"text-2xl font-bold mb-4\">Produtor & Divulga√ß√£o</h2>\r\n\r\n            <div className=\"form-group\">\r\n              <label>Nome do Produtor / Organizador</label>\r\n              <input\r\n                className=\"input w-full\"\r\n                value={formData.producerName}\r\n                onChange={e => setFormData({ ...formData, producerName: e.target.value })}\r\n                placeholder=\"Ex: Rede Juventude NC\"\r\n              />\r\n            </div>\r\n            <div className=\"form-group\">\r\n              <label>Descri√ß√£o do Produtor</label>\r\n              <textarea\r\n                className=\"input w-full\"\r\n                rows={4}\r\n                value={formData.producerDescription}\r\n                onChange={e => setFormData({ ...formData, producerDescription: e.target.value })}\r\n                placeholder=\"Conte um pouco sobre quem est√° organizando...\"\r\n              />\r\n            </div>\r\n\r\n            <hr className=\"my-6 border-gray-200\" />\r\n\r\n            <h3 className=\"text-lg font-semibold mb-2\">Visibilidade</h3>\r\n            <div className=\"flex gap-4\">\r\n              <label className=\"flex items-center gap-2 cursor-pointer border p-4 rounded-lg flex-1 hover:bg-gray-50\">\r\n                <input type=\"radio\" name=\"visibility\" checked={formData.visibility !== \"PRIVATE\"} onChange={() => setFormData({ ...formData, visibility: \"PUBLIC\" })} />\r\n                <div>\r\n                  <div className=\"font-bold flex items-center gap-1\"><Globe className=\"w-4 h-4\" /> P√∫blico</div>\r\n                  <div className=\"text-sm text-gray-500\">Vis√≠vel para todos na busca</div>\r\n                </div>\r\n              </label>\r\n              <label className=\"flex items-center gap-2 cursor-pointer border p-4 rounded-lg flex-1 hover:bg-gray-50\">\r\n                <input type=\"radio\" name=\"visibility\" checked={formData.visibility === \"PRIVATE\"} onChange={() => setFormData({ ...formData, visibility: \"PRIVATE\" })} />\r\n                <div>\r\n                  <div className=\"font-bold flex items-center gap-1\"><Check className=\"w-4 h-4\" /> Privado</div>\r\n                  <div className=\"text-sm text-gray-500\">Apenas quem tem o link</div>\r\n                </div>\r\n              </label>\r\n            </div>\r\n          </div>\r\n        );\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex h-[calc(100vh-64px)] overflow-hidden bg-gray-50 -m-6\">\r\n      {/* Sidebar */}\r\n      <div className=\"w-64 bg-white border-r border-gray-200 p-6 flex flex-col justify-between\">\r\n        <div>\r\n          <h1 className=\"text-xl font-bold text-gray-800 mb-8\">\r\n            {isEdit ? \"Editar Evento\" : \"Novo Evento\"}\r\n          </h1>\r\n          <div className=\"space-y-2\">\r\n            {steps.map(s => (\r\n              <button\r\n                key={s.id}\r\n                onClick={() => setStep(s.id)}\r\n                className={`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm transition-all\r\n                                ${step === s.id\r\n                    ? \"bg-blue-50 text-blue-700 font-semibold shadow-sm\"\r\n                    : \"text-gray-500 hover:bg-gray-50\"\r\n                  }`}\r\n              >\r\n                {s.icon}\r\n                {s.label}\r\n                {step > s.id && <Check className=\"w-4 h-4 ml-auto text-green-500\" />}\r\n              </button>\r\n            ))}\r\n          </div>\r\n        </div>\r\n        <div className=\"text-xs text-center text-gray-400\">\r\n          Passo {step} de 4\r\n        </div>\r\n      </div>\r\n\r\n      {/* Content */}\r\n      <div className=\"flex-1 flex flex-col overflow-hidden\">\r\n        <div className=\"flex-1 overflow-y-auto p-8\">\r\n          <div className=\"max-w-3xl mx-auto bg-white rounded-xl shadow-sm border border-gray-200 p-8 min-h-[500px]\">\r\n            {renderStepContent()}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Footer Actions */}\r\n        <div className=\"h-20 bg-white border-t border-gray-200 px-8 flex items-center justify-between\">\r\n          <button\r\n            className={`btn btn-secondary flex items-center gap-2 ${step === 1 ? 'invisible' : ''}`}\r\n            onClick={() => setStep(s => Math.max(1, s - 1))}\r\n          >\r\n            <ChevronLeft className=\"w-4 h-4\" /> Voltar\r\n          </button>\r\n\r\n          <div className=\"flex gap-2\">\r\n            <button className=\"btn btn-ghost text-gray-500\" onClick={() => navigate(\"/admin/eventos\")}>\r\n              Cancelar\r\n            </button>\r\n            {step < 4 ? (\r\n              <button\r\n                className=\"btn btn-primary flex items-center gap-2\"\r\n                onClick={() => setStep(s => Math.min(4, s + 1))}\r\n              >\r\n                Pr√≥ximo <ChevronRight className=\"w-4 h-4\" />\r\n              </button>\r\n            ) : (\r\n              <button\r\n                className=\"btn btn-primary bg-green-600 hover:bg-green-700 flex items-center gap-2\"\r\n                onClick={handleSubmit}\r\n                disabled={loading}\r\n              >\r\n                {loading ? \"Salvando...\" : \"Publicar Evento\"} <Check className=\"w-4 h-4\" />\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminEvents.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminInternalUsers.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminMapEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminMuseumSettings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminQRCodes.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminReviews.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchReviews'. Either include it or remove the dependency array.","line":28,"column":8,"nodeType":"ArrayExpression","endLine":28,"endColumn":26,"suggestions":[{"desc":"Update the dependencies array to be: [tenantId, filter, fetchReviews]","fix":{"range":[867,885],"text":"[tenantId, filter, fetchReviews]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Star, CheckCircle, XCircle, User, Clock, Filter, MessageCircle } from 'lucide-react';\r\nimport { api } from '../../../api/client';\r\nimport { useAuth } from '../../auth/AuthContext';\r\n\r\ninterface Review {\r\n    id: string;\r\n    rating: number;\r\n    comment: string | null;\r\n    approved: boolean;\r\n    createdAt: string;\r\n    visitor: {\r\n        name: string;\r\n        photoUrl: string | null;\r\n    };\r\n    work?: { title: string };\r\n    event?: { title: string };\r\n}\r\n\r\nexport const AdminReviews: React.FC = () => {\r\n    const { tenantId } = useAuth();\r\n    const [reviews, setReviews] = useState<Review[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [filter, setFilter] = useState<'all' | 'pending' | 'approved'>('pending');\r\n\r\n    useEffect(() => {\r\n        fetchReviews();\r\n    }, [tenantId, filter]);\r\n\r\n    const fetchReviews = async () => {\r\n        if (!tenantId) return;\r\n        setLoading(true);\r\n        try {\r\n            const approved = filter === 'all' ? 'all' : filter === 'approved' ? 'true' : 'false';\r\n            const res = await api.get(`/reviews?tenantId=${tenantId}&approved=${approved}`);\r\n            setReviews(res.data.reviews);\r\n        } catch (error) {\r\n            console.error('Error fetching reviews:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleApprove = async (id: string) => {\r\n        try {\r\n            await api.patch(`/reviews/${id}/approve`);\r\n            setReviews(prev => prev.map(r => r.id === id ? { ...r, approved: true } : r));\r\n        } catch (error) {\r\n            console.error('Error approving review:', error);\r\n        }\r\n    };\r\n\r\n    const handleDelete = async (id: string) => {\r\n        if (!confirm('Tem certeza que deseja excluir esta avalia√ß√£o?')) return;\r\n        try {\r\n            await api.delete(`/reviews/${id}`);\r\n            setReviews(prev => prev.filter(r => r.id !== id));\r\n        } catch (error) {\r\n            console.error('Error deleting review:', error);\r\n        }\r\n    };\r\n\r\n    const renderStars = (rating: number) => {\r\n        return Array.from({ length: 5 }).map((_, i) => (\r\n            <Star\r\n                key={i}\r\n                size={16}\r\n                fill={i < rating ? '#fbbf24' : 'none'}\r\n                color={i < rating ? '#fbbf24' : '#6b7280'}\r\n            />\r\n        ));\r\n    };\r\n\r\n    const pendingCount = reviews.filter(r => !r.approved).length;\r\n\r\n    return (\r\n        <div className=\"admin-reviews-page\">\r\n            <header className=\"page-header\">\r\n                <div>\r\n                    <h1>‚≠ê Modera√ß√£o de Avalia√ß√µes</h1>\r\n                    <p className=\"subtitle\">Aprove ou rejeite avalia√ß√µes dos visitantes</p>\r\n                </div>\r\n                {pendingCount > 0 && (\r\n                    <div className=\"pending-badge\">\r\n                        {pendingCount} pendente{pendingCount > 1 ? 's' : ''}\r\n                    </div>\r\n                )}\r\n            </header>\r\n\r\n            {/* Filters */}\r\n            <div className=\"filters-bar\">\r\n                <button\r\n                    className={`filter-btn ${filter === 'pending' ? 'active' : ''}`}\r\n                    onClick={() => setFilter('pending')}\r\n                >\r\n                    <Clock size={16} /> Pendentes\r\n                </button>\r\n                <button\r\n                    className={`filter-btn ${filter === 'approved' ? 'active' : ''}`}\r\n                    onClick={() => setFilter('approved')}\r\n                >\r\n                    <CheckCircle size={16} /> Aprovadas\r\n                </button>\r\n                <button\r\n                    className={`filter-btn ${filter === 'all' ? 'active' : ''}`}\r\n                    onClick={() => setFilter('all')}\r\n                >\r\n                    <Filter size={16} /> Todas\r\n                </button>\r\n            </div>\r\n\r\n            {/* Reviews List */}\r\n            <div className=\"reviews-list\">\r\n                {loading ? (\r\n                    <div className=\"loading-state\">Carregando avalia√ß√µes...</div>\r\n                ) : reviews.length === 0 ? (\r\n                    <div className=\"empty-state\">\r\n                        <MessageCircle size={48} />\r\n                        <h3>Nenhuma avalia√ß√£o {filter === 'pending' ? 'pendente' : ''}</h3>\r\n                        <p>As avalia√ß√µes dos visitantes aparecer√£o aqui</p>\r\n                    </div>\r\n                ) : (\r\n                    reviews.map(review => (\r\n                        <div key={review.id} className={`review-card ${review.approved ? 'approved' : 'pending'}`}>\r\n                            <div className=\"review-header\">\r\n                                <div className=\"visitor-info\">\r\n                                    <div className=\"visitor-avatar\">\r\n                                        {review.visitor.photoUrl ? (\r\n                                            <img src={review.visitor.photoUrl} alt=\"\" />\r\n                                        ) : (\r\n                                            <User size={20} />\r\n                                        )}\r\n                                    </div>\r\n                                    <div>\r\n                                        <span className=\"visitor-name\">{review.visitor.name}</span>\r\n                                        <span className=\"review-date\">\r\n                                            {new Date(review.createdAt).toLocaleDateString('pt-BR')}\r\n                                        </span>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"review-rating\">\r\n                                    {renderStars(review.rating)}\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"review-target\">\r\n                                {review.work ? `üì∑ ${review.work.title}` : review.event ? `üé≠ ${review.event.title}` : ''}\r\n                            </div>\r\n\r\n                            {review.comment && (\r\n                                <p className=\"review-comment\">\"{review.comment}\"</p>\r\n                            )}\r\n\r\n                            <div className=\"review-actions\">\r\n                                {!review.approved && (\r\n                                    <button\r\n                                        className=\"approve-btn\"\r\n                                        onClick={() => handleApprove(review.id)}\r\n                                    >\r\n                                        <CheckCircle size={16} /> Aprovar\r\n                                    </button>\r\n                                )}\r\n                                <button\r\n                                    className=\"delete-btn\"\r\n                                    onClick={() => handleDelete(review.id)}\r\n                                >\r\n                                    <XCircle size={16} /> Excluir\r\n                                </button>\r\n                                {review.approved && (\r\n                                    <span className=\"approved-badge\">‚úì Publicada</span>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    ))\r\n                )}\r\n            </div>\r\n\r\n            <style>{`\r\n                .admin-reviews-page {\r\n                    padding: 24px;\r\n                }\r\n                \r\n                .page-header {\r\n                    display: flex;\r\n                    justify-content: space-between;\r\n                    align-items: flex-start;\r\n                    margin-bottom: 24px;\r\n                }\r\n                \r\n                .page-header h1 {\r\n                    margin: 0;\r\n                    font-size: 1.75rem;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                }\r\n                \r\n                .subtitle {\r\n                    margin: 4px 0 0;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .pending-badge {\r\n                    padding: 8px 16px;\r\n                    background: linear-gradient(135deg, #f59e0b, #d97706);\r\n                    border-radius: 20px;\r\n                    color: white;\r\n                    font-weight: bold;\r\n                }\r\n                \r\n                .filters-bar {\r\n                    display: flex;\r\n                    gap: 8px;\r\n                    margin-bottom: 20px;\r\n                }\r\n                \r\n                .filter-btn {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 8px;\r\n                    padding: 10px 20px;\r\n                    background: var(--bg-card, #1f2937);\r\n                    border: 1px solid var(--border-color, #374151);\r\n                    border-radius: 8px;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                    cursor: pointer;\r\n                    transition: all 0.2s;\r\n                }\r\n                \r\n                .filter-btn.active {\r\n                    background: linear-gradient(135deg, #3b82f6, #8b5cf6);\r\n                    border-color: transparent;\r\n                    color: white;\r\n                }\r\n                \r\n                .reviews-list {\r\n                    display: flex;\r\n                    flex-direction: column;\r\n                    gap: 16px;\r\n                }\r\n                \r\n                .review-card {\r\n                    background: var(--bg-card, #1f2937);\r\n                    border-radius: 16px;\r\n                    padding: 20px;\r\n                    border-left: 4px solid transparent;\r\n                }\r\n                \r\n                .review-card.pending {\r\n                    border-left-color: #f59e0b;\r\n                }\r\n                \r\n                .review-card.approved {\r\n                    border-left-color: #22c55e;\r\n                }\r\n                \r\n                .review-header {\r\n                    display: flex;\r\n                    justify-content: space-between;\r\n                    align-items: flex-start;\r\n                    margin-bottom: 12px;\r\n                }\r\n                \r\n                .visitor-info {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 12px;\r\n                }\r\n                \r\n                .visitor-avatar {\r\n                    width: 40px;\r\n                    height: 40px;\r\n                    border-radius: 50%;\r\n                    background: var(--bg-elevated, #374151);\r\n                    display: flex;\r\n                    align-items: center;\r\n                    justify-content: center;\r\n                    overflow: hidden;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .visitor-avatar img {\r\n                    width: 100%;\r\n                    height: 100%;\r\n                    object-fit: cover;\r\n                }\r\n                \r\n                .visitor-name {\r\n                    display: block;\r\n                    font-weight: 600;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                }\r\n                \r\n                .review-date {\r\n                    font-size: 0.85rem;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .review-rating {\r\n                    display: flex;\r\n                    gap: 2px;\r\n                }\r\n                \r\n                .review-target {\r\n                    font-size: 0.9rem;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                    margin-bottom: 12px;\r\n                }\r\n                \r\n                .review-comment {\r\n                    font-style: italic;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                    margin: 0 0 16px;\r\n                    padding: 12px;\r\n                    background: var(--bg-elevated, #374151);\r\n                    border-radius: 8px;\r\n                    line-height: 1.6;\r\n                }\r\n                \r\n                .review-actions {\r\n                    display: flex;\r\n                    gap: 12px;\r\n                    align-items: center;\r\n                }\r\n                \r\n                .approve-btn {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 6px;\r\n                    padding: 8px 16px;\r\n                    background: #22c55e;\r\n                    color: white;\r\n                    border: none;\r\n                    border-radius: 8px;\r\n                    font-weight: 600;\r\n                    cursor: pointer;\r\n                }\r\n                \r\n                .delete-btn {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 6px;\r\n                    padding: 8px 16px;\r\n                    background: rgba(239, 68, 68, 0.2);\r\n                    color: #ef4444;\r\n                    border: none;\r\n                    border-radius: 8px;\r\n                    font-weight: 600;\r\n                    cursor: pointer;\r\n                }\r\n                \r\n                .approved-badge {\r\n                    margin-left: auto;\r\n                    padding: 6px 12px;\r\n                    background: rgba(34, 197, 94, 0.2);\r\n                    color: #22c55e;\r\n                    border-radius: 20px;\r\n                    font-size: 0.85rem;\r\n                    font-weight: 600;\r\n                }\r\n                \r\n                .loading-state, .empty-state {\r\n                    text-align: center;\r\n                    padding: 60px 20px;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .empty-state h3 {\r\n                    margin: 16px 0 8px;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminScannerTrainer.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'tf' is defined but never used.","line":2,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":15},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`startCamera` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminScannerTrainer.tsx:46:32\n  44 |\n  45 |                 if (isMounted) setLoading(false);\n> 46 |                 if (isMounted) startCamera();\n     |                                ^^^^^^^^^^^ `startCamera` accessed before it is declared\n  47 |\n  48 |             } catch (err) {\n  49 |                 console.error(\"Error init trainer\", err);\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminScannerTrainer.tsx:70:5\n  68 |     }, [tenantId]);\n  69 |\n> 70 |     const startCamera = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 71 |         if (videoRef.current) {\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 72 |             const stream = await navigator.mediaDevices.getUserMedia({ video: true });\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 73 |             videoRef.current.srcObject = stream;\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 74 |             videoRef.current.play();\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 75 |         }\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 76 |     };\n     | ^^^^^^^ `startCamera` is declared here\n  77 |\n  78 |     const stopCamera = () => {\n  79 |         if (videoRef.current && videoRef.current.srcObject) {","line":46,"column":32,"nodeType":null,"endLine":46,"endColumn":43},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`stopCamera` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminScannerTrainer.tsx:56:13\n  54 |         return () => {\n  55 |             isMounted = false;\n> 56 |             stopCamera();\n     |             ^^^^^^^^^^ `stopCamera` accessed before it is declared\n  57 |             // Cleanup tensors\n  58 |             setClassifier(prev => {\n  59 |                 if (prev) {\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminScannerTrainer.tsx:78:5\n  76 |     };\n  77 |\n> 78 |     const stopCamera = () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 79 |         if (videoRef.current && videoRef.current.srcObject) {\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 80 |             const stream = videoRef.current.srcObject as MediaStream;\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 81 |             stream.getTracks().forEach(t => t.stop());\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 82 |         }\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 83 |     };\n     | ^^^^^^^ `stopCamera` is declared here\n  84 |\n  85 |     const addExample = async () => {\n  86 |         if (!selectedWorkId || !net || !classifier || !videoRef.current) return;","line":56,"column":13,"nodeType":null,"endLine":56,"endColumn":23},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":109,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":109,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4386,4389],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4386,4389],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"prefer-const","severity":2,"message":"'data' is never reassigned. Use 'const' instead.","line":111,"column":17,"nodeType":"Identifier","messageId":"useConst","endLine":111,"endColumn":21,"fix":{"range":[4459,4494],"text":"const data = dataset[key].dataSync();"}}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useEffect, useRef, useState } from \"react\";\r\nimport * as tf from \"@tensorflow/tfjs\";\r\nimport * as mobilenet from \"@tensorflow-models/mobilenet\";\r\nimport * as knnClassifier from \"@tensorflow-models/knn-classifier\";\r\nimport { api } from \"../../../api/client\";\r\nimport { useAuth } from \"../../auth/AuthContext\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nexport const AdminScannerTrainer: React.FC = () => {\r\n    const { t } = useTranslation();\r\n    const { tenantId } = useAuth(); // Assuming admin is scoped to tenant\r\n    const videoRef = useRef<HTMLVideoElement>(null);\r\n    const [classifier, setClassifier] = useState<knnClassifier.KNNClassifier | null>(null);\r\n    const [net, setNet] = useState<mobilenet.MobileNet | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n    const [works, setWorks] = useState<{ id: string; title: string }[]>([]);\r\n    const [selectedWorkId, setSelectedWorkId] = useState<string>(\"\");\r\n    const [exampleCounts, setExampleCounts] = useState<Record<string, number>>({});\r\n    const [training, setTraining] = useState(false);\r\n\r\n    useEffect(() => {\r\n        let isMounted = true;\r\n\r\n        const init = async () => {\r\n            try {\r\n                const loadedNet = await mobilenet.load();\r\n                const loadedClassifier = knnClassifier.create();\r\n\r\n                if (isMounted) {\r\n                    setNet(loadedNet);\r\n                    setClassifier(loadedClassifier);\r\n                    console.log(\"Model loaded\");\r\n                } else {\r\n                    // Cleanup if unmounted before load finish\r\n                    loadedClassifier.dispose();\r\n                }\r\n\r\n                // Load works\r\n                if (tenantId && isMounted) {\r\n                    const res = await api.get(\"/works\", { params: { tenantId } });\r\n                    // API returns { data: works[], pagination: {} }\r\n                    setWorks(Array.isArray(res.data) ? res.data : (res.data.data || []));\r\n                }\r\n\r\n                if (isMounted) setLoading(false);\r\n                if (isMounted) startCamera();\r\n\r\n            } catch (err) {\r\n                console.error(\"Error init trainer\", err);\r\n            }\r\n        };\r\n        init();\r\n\r\n        return () => {\r\n            isMounted = false;\r\n            stopCamera();\r\n            // Cleanup tensors\r\n            setClassifier(prev => {\r\n                if (prev) {\r\n                    prev.dispose();\r\n                    console.log(\"Classifier disposed\");\r\n                }\r\n                return null;\r\n            });\r\n            // MobileNet models don't have a simple dispose method exposed in this version usually, \r\n            // but strict tensor management is key. For now classifier dispose is the most critical for KNN.\r\n        };\r\n    }, [tenantId]);\r\n\r\n    const startCamera = async () => {\r\n        if (videoRef.current) {\r\n            const stream = await navigator.mediaDevices.getUserMedia({ video: true });\r\n            videoRef.current.srcObject = stream;\r\n            videoRef.current.play();\r\n        }\r\n    };\r\n\r\n    const stopCamera = () => {\r\n        if (videoRef.current && videoRef.current.srcObject) {\r\n            const stream = videoRef.current.srcObject as MediaStream;\r\n            stream.getTracks().forEach(t => t.stop());\r\n        }\r\n    };\r\n\r\n    const addExample = async () => {\r\n        if (!selectedWorkId || !net || !classifier || !videoRef.current) return;\r\n\r\n        setTraining(true);\r\n        const activation = net.infer(videoRef.current, true);\r\n        classifier.addExample(activation, selectedWorkId);\r\n\r\n        setExampleCounts(prev => ({\r\n            ...prev,\r\n            [selectedWorkId]: (prev[selectedWorkId] || 0) + 1\r\n        }));\r\n\r\n        // Simulate a small delay for visual feedback\r\n        setTimeout(() => setTraining(false), 200);\r\n    };\r\n\r\n    const saveModel = async () => {\r\n        // Saving KNN classifier is tricky because it stores tensors.\r\n        // For a hackathon/demo, we can save the *dataset* (activations) or just keep in memory if checking on same device.\r\n        // A robust way: Convert dataset to arrayBuffer, save to DB/LocalStore.\r\n        if (!classifier) return;\r\n\r\n        const dataset = classifier.getClassifierDataset();\r\n        // Convert tensors to arrays for storage\r\n        const datasetObj: Record<string, any> = {};\r\n        Object.keys(dataset).forEach((key) => {\r\n            let data = dataset[key].dataSync();\r\n            // We need to convert Float32Array to normal array for JSON.stringify\r\n            datasetObj[key] = Array.from(data);\r\n        });\r\n\r\n        // This can be HUGE. For MVP we might hit localStorage limits.\r\n        // Let's try saving to localStorage first, but handle error.\r\n        try {\r\n            const jsonStr = JSON.stringify(datasetObj);\r\n            localStorage.setItem(`scanner_model_${tenantId}`, jsonStr);\r\n            alert(\"Modelo salvo localmente! (Visitante no mesmo navegador poder√° usar)\");\r\n        } catch (e) {\r\n            console.error(e);\r\n            alert(\"Erro ao salvar: modelo muito grande para localStorage. Em produ√ß√£o usar√≠amos IndexedDB ou upload.\");\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div style={{ padding: \"1rem\" }}>\r\n            <h1 className=\"section-title\">{t(\"admin.scanner.title\", \"Treinamento do Scanner Visual\")}</h1>\r\n            <p className=\"section-subtitle\">{t(\"admin.scanner.subtitle\", \"Ensine a IA a reconhecer as obras apontando a c√¢mera.\")}</p>\r\n\r\n            <div style={{ display: \"grid\", gridTemplateColumns: \"1fr 1fr\", gap: \"1rem\", marginTop: \"1rem\" }}>\r\n                {/* Camera Feed */}\r\n                <div className=\"card\" style={{ padding: \"1rem\", textAlign: \"center\" }}>\r\n                    <div style={{ position: \"relative\", width: \"100%\", height: \"300px\", background: \"#000\", borderRadius: \"0.5rem\", overflow: \"hidden\", marginBottom: \"1rem\" }}>\r\n                        <video ref={videoRef} style={{ width: \"100%\", height: \"100%\", objectFit: \"cover\" }} muted />\r\n                        {training && (\r\n                            <div style={{ position: \"absolute\", inset: 0, display: \"flex\", alignItems: \"center\", justifyContent: \"center\", background: \"rgba(0,255,0,0.3)\" }}>\r\n                                <span style={{ color: \"white\", fontWeight: \"bold\", fontSize: \"1.5rem\" }}>+1 Exemplo</span>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                </div>\r\n\r\n                {/* Controls */}\r\n                <div className=\"card\" style={{ padding: \"1rem\" }}>\r\n                    <h3>Selecionar Obra</h3>\r\n                    <select\r\n                        className=\"input\"\r\n                        value={selectedWorkId}\r\n                        onChange={e => setSelectedWorkId(e.target.value)}\r\n                        style={{ marginBottom: \"1rem\" }}\r\n                    >\r\n                        <option value=\"\">Selecione uma obra...</option>\r\n                        {works.map(w => (\r\n                            <option key={w.id} value={w.id}>{w.title}</option>\r\n                        ))}\r\n                    </select>\r\n\r\n                    <button\r\n                        className={`btn btn-primary ${(!selectedWorkId || loading) ? \"opacity-50\" : \"\"}`}\r\n                        disabled={!selectedWorkId || loading}\r\n                        onClick={addExample}\r\n                        style={{ width: \"100%\", marginBottom: \"1rem\", fontSize: \"1.2rem\", padding: \"1rem\" }}\r\n                    >\r\n                        üì∏ Capturar Exemplo\r\n                    </button>\r\n\r\n                    <p style={{ fontSize: \"0.9rem\", color: \"#666\", marginBottom: \"1rem\" }}>\r\n                        Dica: Tire pelo menos 10 fotos de √¢ngulos diferentes para cada obra.\r\n                    </p>\r\n\r\n                    <h4>Exemplos Capturados:</h4>\r\n                    <ul style={{ maxHeight: \"200px\", overflowY: \"auto\", border: \"1px solid #eee\", padding: \"0.5rem\", borderRadius: \"0.5rem\" }}>\r\n                        {works.map(w => {\r\n                            const count = exampleCounts[w.id] || 0;\r\n                            if (count === 0) return null;\r\n                            return (\r\n                                <li key={w.id} style={{ display: \"flex\", justifyContent: \"space-between\", padding: \"0.25rem 0\" }}>\r\n                                    <span>{w.title}</span>\r\n                                    <span style={{ fontWeight: \"bold\", color: count >= 10 ? \"green\" : \"orange\" }}>{count} img</span>\r\n                                </li>\r\n                            );\r\n                        })}\r\n                    </ul>\r\n\r\n                    <button\r\n                        className=\"btn btn-secondary\"\r\n                        onClick={saveModel}\r\n                        style={{ width: \"100%\", marginTop: \"1rem\" }}\r\n                    >\r\n                        üíæ Salvar Modelo\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminShop.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchProducts'. Either include it or remove the dependency array.","line":28,"column":8,"nodeType":"ArrayExpression","endLine":28,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [fetchProducts, tenantId]","fix":{"range":[924,934],"text":"[fetchProducts, tenantId]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Package, Plus, Edit, Trash2, DollarSign, Archive, Search } from 'lucide-react';\r\nimport { api } from '../../../api/client';\r\nimport { useAuth } from '../../auth/AuthContext';\r\n\r\ninterface Product {\r\n    id: string;\r\n    name: string;\r\n    description: string | null;\r\n    price: number;\r\n    imageUrl: string | null;\r\n    category: string | null;\r\n    sku: string | null;\r\n    stock: number;\r\n    active: boolean;\r\n}\r\n\r\nexport const AdminShop: React.FC = () => {\r\n    const { tenantId } = useAuth();\r\n    const [products, setProducts] = useState<Product[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [showForm, setShowForm] = useState(false);\r\n    const [editingProduct, setEditingProduct] = useState<Product | null>(null);\r\n    const [searchTerm, setSearchTerm] = useState('');\r\n\r\n    useEffect(() => {\r\n        fetchProducts();\r\n    }, [tenantId]);\r\n\r\n    const fetchProducts = async () => {\r\n        if (!tenantId) return;\r\n        setLoading(true);\r\n        try {\r\n            const res = await api.get(`/shop/products?tenantId=${tenantId}&active=all`);\r\n            setProducts(res.data);\r\n        } catch (error) {\r\n            console.error('Error fetching products:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleDelete = async (id: string) => {\r\n        if (!confirm('Tem certeza que deseja excluir este produto?')) return;\r\n        try {\r\n            await api.delete(`/shop/products/${id}`);\r\n            setProducts(prev => prev.filter(p => p.id !== id));\r\n        } catch (error) {\r\n            console.error('Error deleting product:', error);\r\n        }\r\n    };\r\n\r\n    const toggleActive = async (product: Product) => {\r\n        try {\r\n            await api.put(`/shop/products/${product.id}`, { active: !product.active });\r\n            setProducts(prev => prev.map(p => p.id === product.id ? { ...p, active: !p.active } : p));\r\n        } catch (error) {\r\n            console.error('Error toggling product:', error);\r\n        }\r\n    };\r\n\r\n    const filteredProducts = products.filter(p =>\r\n        p.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n        p.sku?.toLowerCase().includes(searchTerm.toLowerCase())\r\n    );\r\n\r\n    const stats = {\r\n        total: products.length,\r\n        active: products.filter(p => p.active).length,\r\n        outOfStock: products.filter(p => p.stock <= 0).length\r\n\r\n    };\r\n\r\n    return (\r\n        <div className=\"admin-shop-page\">\r\n            <header className=\"page-header\">\r\n                <div>\r\n                    <h1>üõí Gest√£o da Loja</h1>\r\n                    <p className=\"subtitle\">Gerencie os produtos da loja do museu</p>\r\n                </div>\r\n                <button className=\"add-btn\" onClick={() => { setEditingProduct(null); setShowForm(true); }}>\r\n                    <Plus size={18} /> Novo Produto\r\n                </button>\r\n            </header>\r\n\r\n            {/* Stats */}\r\n            <div className=\"stats-row\">\r\n                <div className=\"stat-card\">\r\n                    <Package size={24} />\r\n                    <div>\r\n                        <span className=\"stat-value\">{stats.total}</span>\r\n                        <span className=\"stat-label\">Produtos</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card\">\r\n                    <DollarSign size={24} />\r\n                    <div>\r\n                        <span className=\"stat-value\">{stats.active}</span>\r\n                        <span className=\"stat-label\">Ativos</span>\r\n                    </div>\r\n                </div>\r\n                <div className=\"stat-card warning\">\r\n                    <Archive size={24} />\r\n                    <div>\r\n                        <span className=\"stat-value\">{stats.outOfStock}</span>\r\n                        <span className=\"stat-label\">Sem Estoque</span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Search */}\r\n            <div className=\"search-bar\">\r\n                <Search size={18} />\r\n                <input\r\n                    type=\"text\"\r\n                    placeholder=\"Buscar por nome ou SKU...\"\r\n                    value={searchTerm}\r\n                    onChange={(e) => setSearchTerm(e.target.value)}\r\n                />\r\n            </div>\r\n\r\n            {/* Products Grid */}\r\n            <div className=\"products-grid\">\r\n                {loading ? (\r\n                    <div className=\"loading-state\">Carregando produtos...</div>\r\n                ) : filteredProducts.length === 0 ? (\r\n                    <div className=\"empty-state\">\r\n                        <Package size={48} />\r\n                        <h3>Nenhum produto cadastrado</h3>\r\n                        <p>Adicione produtos para sua loja virtual</p>\r\n                    </div>\r\n                ) : (\r\n                    filteredProducts.map(product => (\r\n                        <div key={product.id} className={`product-card ${!product.active ? 'inactive' : ''}`}>\r\n                            <div className=\"product-image\">\r\n                                {product.imageUrl ? (\r\n                                    <img src={product.imageUrl} alt={product.name} />\r\n                                ) : (\r\n                                    <Package size={48} />\r\n                                )}\r\n                                {product.stock <= 0 && <div className=\"out-of-stock-badge\">Esgotado</div>}\r\n                            </div>\r\n                            <div className=\"product-info\">\r\n                                <h4>{product.name}</h4>\r\n                                <p className=\"product-sku\">{product.sku || 'Sem SKU'}</p>\r\n                                <div className=\"product-meta\">\r\n                                    <span className=\"price\">R$ {Number(product.price).toFixed(2).replace('.', ',')}</span>\r\n                                    <span className=\"stock\">Estoque: {product.stock}</span>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"product-actions\">\r\n                                <button\r\n                                    className={`toggle-btn ${product.active ? 'active' : ''}`}\r\n                                    onClick={() => toggleActive(product)}\r\n                                >\r\n                                    {product.active ? '‚úì Ativo' : '‚óã Inativo'}\r\n                                </button>\r\n                                <button className=\"edit-btn\" onClick={() => { setEditingProduct(product); setShowForm(true); }}>\r\n                                    <Edit size={16} />\r\n                                </button>\r\n                                <button className=\"delete-btn\" onClick={() => handleDelete(product.id)}>\r\n                                    <Trash2 size={16} />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    ))\r\n                )}\r\n            </div>\r\n\r\n            {/* Form Modal */}\r\n            {showForm && (\r\n                <ProductFormModal\r\n                    product={editingProduct}\r\n                    tenantId={tenantId || ''}\r\n                    onClose={() => setShowForm(false)}\r\n                    onSave={() => { setShowForm(false); fetchProducts(); }}\r\n                />\r\n            )}\r\n\r\n            <style>{`\r\n                .admin-shop-page {\r\n                    padding: 24px;\r\n                }\r\n                \r\n                .page-header {\r\n                    display: flex;\r\n                    justify-content: space-between;\r\n                    align-items: flex-start;\r\n                    margin-bottom: 24px;\r\n                }\r\n                \r\n                .page-header h1 {\r\n                    margin: 0;\r\n                    font-size: 1.75rem;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                }\r\n                \r\n                .add-btn {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 8px;\r\n                    padding: 12px 24px;\r\n                    background: linear-gradient(135deg, #22c55e, #16a34a);\r\n                    color: white;\r\n                    border: none;\r\n                    border-radius: 10px;\r\n                    font-weight: 600;\r\n                    cursor: pointer;\r\n                }\r\n                \r\n                .stats-row {\r\n                    display: flex;\r\n                    gap: 16px;\r\n                    margin-bottom: 24px;\r\n                }\r\n                \r\n                .stat-card {\r\n                    flex: 1;\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 16px;\r\n                    padding: 20px;\r\n                    background: var(--bg-card, #1f2937);\r\n                    border-radius: 12px;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .stat-card.warning {\r\n                    border: 1px solid rgba(245, 158, 11, 0.3);\r\n                }\r\n                \r\n                .stat-value {\r\n                    display: block;\r\n                    font-size: 1.5rem;\r\n                    font-weight: bold;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                }\r\n                \r\n                .stat-label {\r\n                    font-size: 0.85rem;\r\n                }\r\n                \r\n                .search-bar {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 12px;\r\n                    padding: 12px 16px;\r\n                    background: var(--bg-card, #1f2937);\r\n                    border-radius: 10px;\r\n                    margin-bottom: 20px;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .search-bar input {\r\n                    flex: 1;\r\n                    background: transparent;\r\n                    border: none;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                    font-size: 1rem;\r\n                }\r\n                \r\n                .products-grid {\r\n                    display: grid;\r\n                    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\r\n                    gap: 16px;\r\n                }\r\n                \r\n                .product-card {\r\n                    background: var(--bg-card, #1f2937);\r\n                    border-radius: 16px;\r\n                    overflow: hidden;\r\n                }\r\n                \r\n                .product-card.inactive {\r\n                    opacity: 0.6;\r\n                }\r\n                \r\n                .product-image {\r\n                    position: relative;\r\n                    height: 150px;\r\n                    background: var(--bg-elevated, #374151);\r\n                    display: flex;\r\n                    align-items: center;\r\n                    justify-content: center;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .product-image img {\r\n                    width: 100%;\r\n                    height: 100%;\r\n                    object-fit: cover;\r\n                }\r\n                \r\n                .out-of-stock-badge {\r\n                    position: absolute;\r\n                    top: 8px;\r\n                    right: 8px;\r\n                    padding: 4px 10px;\r\n                    background: #ef4444;\r\n                    color: white;\r\n                    font-size: 0.75rem;\r\n                    font-weight: bold;\r\n                    border-radius: 4px;\r\n                }\r\n                \r\n                .product-info {\r\n                    padding: 16px;\r\n                }\r\n                \r\n                .product-info h4 {\r\n                    margin: 0 0 4px;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                }\r\n                \r\n                .product-sku {\r\n                    font-size: 0.8rem;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                    margin: 0 0 12px;\r\n                }\r\n                \r\n                .product-meta {\r\n                    display: flex;\r\n                    justify-content: space-between;\r\n                }\r\n                \r\n                .price {\r\n                    font-weight: bold;\r\n                    color: #22c55e;\r\n                }\r\n                \r\n                .stock {\r\n                    font-size: 0.85rem;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .product-actions {\r\n                    display: flex;\r\n                    gap: 8px;\r\n                    padding: 12px 16px;\r\n                    border-top: 1px solid var(--border-color, #374151);\r\n                }\r\n                \r\n                .toggle-btn {\r\n                    flex: 1;\r\n                    padding: 8px;\r\n                    background: var(--bg-elevated, #374151);\r\n                    border: none;\r\n                    border-radius: 6px;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                    cursor: pointer;\r\n                }\r\n                \r\n                .toggle-btn.active {\r\n                    background: rgba(34, 197, 94, 0.2);\r\n                    color: #22c55e;\r\n                }\r\n                \r\n                .edit-btn, .delete-btn {\r\n                    padding: 8px;\r\n                    border: none;\r\n                    border-radius: 6px;\r\n                    cursor: pointer;\r\n                }\r\n                \r\n                .edit-btn {\r\n                    background: rgba(59, 130, 246, 0.2);\r\n                    color: #3b82f6;\r\n                }\r\n                \r\n                .delete-btn {\r\n                    background: rgba(239, 68, 68, 0.2);\r\n                    color: #ef4444;\r\n                }\r\n                \r\n                .loading-state, .empty-state {\r\n                    grid-column: 1 / -1;\r\n                    text-align: center;\r\n                    padding: 60px 20px;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n};\r\n\r\n// Product Form Modal\r\nconst ProductFormModal: React.FC<{\r\n    product: Product | null;\r\n    tenantId: string;\r\n    onClose: () => void;\r\n    onSave: () => void;\r\n}> = ({ product, tenantId, onClose, onSave }) => {\r\n    const [form, setForm] = useState({\r\n        name: product?.name || '',\r\n        description: product?.description || '',\r\n        price: product?.price || 0,\r\n        imageUrl: product?.imageUrl || '',\r\n        category: product?.category || '',\r\n        sku: product?.sku || '',\r\n        stock: product?.stock || 0,\r\n        active: product?.active ?? true\r\n    });\r\n    const [saving, setSaving] = useState(false);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        setSaving(true);\r\n        try {\r\n            if (product) {\r\n                await api.put(`/shop/products/${product.id}`, form);\r\n            } else {\r\n                await api.post('/shop/products', { ...form, tenantId });\r\n            }\r\n            onSave();\r\n        } catch (error) {\r\n            console.error('Error saving product:', error);\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"modal-backdrop\" onClick={onClose}>\r\n            <div className=\"modal-content\" onClick={e => e.stopPropagation()}>\r\n                <h2>{product ? 'Editar Produto' : 'Novo Produto'}</h2>\r\n                <form onSubmit={handleSubmit}>\r\n                    <div className=\"form-group\">\r\n                        <label>Nome *</label>\r\n                        <input\r\n                            type=\"text\"\r\n                            value={form.name}\r\n                            onChange={e => setForm(f => ({ ...f, name: e.target.value }))}\r\n                            required\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                        <div className=\"form-group\">\r\n                            <label>Pre√ßo *</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                step=\"0.01\"\r\n                                value={form.price}\r\n                                onChange={e => setForm(f => ({ ...f, price: parseFloat(e.target.value) }))}\r\n                                required\r\n                            />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>Estoque</label>\r\n                            <input\r\n                                type=\"number\"\r\n                                value={form.stock}\r\n                                onChange={e => setForm(f => ({ ...f, stock: parseInt(e.target.value) }))}\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-row\">\r\n                        <div className=\"form-group\">\r\n                            <label>SKU</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={form.sku}\r\n                                onChange={e => setForm(f => ({ ...f, sku: e.target.value }))}\r\n                            />\r\n                        </div>\r\n                        <div className=\"form-group\">\r\n                            <label>Categoria</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={form.category}\r\n                                onChange={e => setForm(f => ({ ...f, category: e.target.value }))}\r\n                                placeholder=\"souvenirs, livros...\"\r\n                            />\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>Descri√ß√£o</label>\r\n                        <textarea\r\n                            value={form.description}\r\n                            onChange={e => setForm(f => ({ ...f, description: e.target.value }))}\r\n                            rows={3}\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-group\">\r\n                        <label>URL da Imagem</label>\r\n                        <input\r\n                            type=\"url\"\r\n                            value={form.imageUrl}\r\n                            onChange={e => setForm(f => ({ ...f, imageUrl: e.target.value }))}\r\n                        />\r\n                    </div>\r\n                    <div className=\"form-actions\">\r\n                        <button type=\"button\" className=\"cancel-btn\" onClick={onClose}>Cancelar</button>\r\n                        <button type=\"submit\" className=\"save-btn\" disabled={saving}>\r\n                            {saving ? 'Salvando...' : 'Salvar'}\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n\r\n                <style>{`\r\n                    .modal-backdrop {\r\n                        position: fixed;\r\n                        inset: 0;\r\n                        background: rgba(0, 0, 0, 0.7);\r\n                        display: flex;\r\n                        align-items: center;\r\n                        justify-content: center;\r\n                        z-index: 1000;\r\n                        padding: 20px;\r\n                    }\r\n                    \r\n                    .modal-content {\r\n                        background: var(--bg-card, #1f2937);\r\n                        border-radius: 16px;\r\n                        padding: 24px;\r\n                        width: 100%;\r\n                        max-width: 500px;\r\n                        max-height: 90vh;\r\n                        overflow-y: auto;\r\n                    }\r\n                    \r\n                    .modal-content h2 {\r\n                        margin: 0 0 20px;\r\n                        color: var(--fg-main, #f3f4f6);\r\n                    }\r\n                    \r\n                    .form-group {\r\n                        margin-bottom: 16px;\r\n                    }\r\n                    \r\n                    .form-group label {\r\n                        display: block;\r\n                        margin-bottom: 6px;\r\n                        font-size: 0.9rem;\r\n                        color: var(--fg-muted, #9ca3af);\r\n                    }\r\n                    \r\n                    .form-group input, .form-group textarea {\r\n                        width: 100%;\r\n                        padding: 12px;\r\n                        background: var(--bg-elevated, #374151);\r\n                        border: 1px solid var(--border-color, #4b5563);\r\n                        border-radius: 8px;\r\n                        color: var(--fg-main, #f3f4f6);\r\n                    }\r\n                    \r\n                    .form-row {\r\n                        display: grid;\r\n                        grid-template-columns: 1fr 1fr;\r\n                        gap: 12px;\r\n                    }\r\n                    \r\n                    .form-actions {\r\n                        display: flex;\r\n                        gap: 12px;\r\n                        margin-top: 24px;\r\n                    }\r\n                    \r\n                    .cancel-btn, .save-btn {\r\n                        flex: 1;\r\n                        padding: 12px;\r\n                        border: none;\r\n                        border-radius: 8px;\r\n                        font-weight: 600;\r\n                        cursor: pointer;\r\n                    }\r\n                    \r\n                    .cancel-btn {\r\n                        background: var(--bg-elevated, #374151);\r\n                        color: var(--fg-muted, #9ca3af);\r\n                    }\r\n                    \r\n                    .save-btn {\r\n                        background: linear-gradient(135deg, #22c55e, #16a34a);\r\n                        color: white;\r\n                    }\r\n                `}</style>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminTrailForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminTrails.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminTreasureHunt.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":70,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":70,"endColumn":23},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'error' is defined but never used.","line":98,"column":18,"nodeType":null,"messageId":"unusedVar","endLine":98,"endColumn":23}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { api } from \"../../../api/client\";\r\n\r\ninterface Clue {\r\n    id: string;\r\n    riddle: string;\r\n    answer: string;\r\n    order: number;\r\n    active: boolean;\r\n    work?: {\r\n        id: string;\r\n        title: string;\r\n    };\r\n    workId?: string | null;\r\n}\r\n\r\ninterface Work {\r\n    id: string;\r\n    title: string;\r\n}\r\n\r\nexport const AdminTreasureHunt: React.FC = () => {\r\n    const { t } = useTranslation();\r\n    const [clues, setClues] = useState<Clue[]>([]);\r\n    const [works, setWorks] = useState<Work[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [showForm, setShowForm] = useState(false);\r\n    const [editingClue, setEditingClue] = useState<Clue | null>(null);\r\n\r\n    // Form state\r\n    const [formData, setFormData] = useState<{\r\n        riddle: string;\r\n        answer: string;\r\n        workId: string;\r\n        order: number;\r\n    }>({\r\n        riddle: \"\",\r\n        answer: \"\",\r\n        workId: \"\",\r\n        order: 0\r\n    });\r\n\r\n    useEffect(() => {\r\n        loadData();\r\n    }, []);\r\n\r\n    const loadData = async () => {\r\n        try {\r\n            setLoading(true);\r\n            const [cluesRes, worksRes] = await Promise.all([\r\n                api.get(\"/clues\"),\r\n                api.get(\"/works\")\r\n            ]);\r\n            // Handle paginated responses\r\n            setClues(Array.isArray(cluesRes.data) ? cluesRes.data : (cluesRes.data.data || []));\r\n            setWorks(Array.isArray(worksRes.data) ? worksRes.data : (worksRes.data.data || []));\r\n        } catch (error) {\r\n            console.error(\"Erro ao carregar dados\", error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleDelete = async (id: string) => {\r\n        if (!confirm(t(\"common.confirmDelete\"))) return;\r\n        try {\r\n            await api.delete(`/clues/${id}`);\r\n            loadData();\r\n        } catch (error) {\r\n            alert(t(\"admin.errors.delete\"));\r\n        }\r\n    };\r\n\r\n    const handleEdit = (clue: Clue) => {\r\n        setEditingClue(clue);\r\n        setFormData({\r\n            riddle: clue.riddle,\r\n            answer: clue.answer,\r\n            workId: clue.workId || \"\",\r\n            order: clue.order\r\n        });\r\n        setShowForm(true);\r\n    };\r\n\r\n    const handleSave = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        try {\r\n            if (editingClue) {\r\n                await api.put(`/clues/${editingClue.id}`, formData);\r\n            } else {\r\n                await api.post(\"/clues\", formData);\r\n            }\r\n            setShowForm(false);\r\n            setEditingClue(null);\r\n            setFormData({ riddle: \"\", answer: \"\", workId: \"\", order: 0 });\r\n            loadData();\r\n        } catch (error) {\r\n            alert(t(\"admin.errors.save\"));\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"admin-page\">\r\n            <header className=\"admin-header\">\r\n                <div>\r\n                    <h1 className=\"admin-title\">üè¥‚Äç‚ò†Ô∏è {t(\"admin.treasure.title\", \"Ca√ßa ao Tesouro\")}</h1>\r\n                    <p className=\"admin-subtitle\">\r\n                        {t(\"admin.treasure.subtitle\", \"Crie charadas manuais para os visitantes encontrarem.\")}\r\n                    </p>\r\n                </div>\r\n                <button\r\n                    className=\"btn btn-primary\"\r\n                    onClick={() => {\r\n                        setEditingClue(null);\r\n                        setFormData({ riddle: \"\", answer: \"\", workId: \"\", order: clues.length + 1 });\r\n                        setShowForm(true);\r\n                    }}\r\n                >\r\n                    + {t(\"admin.treasure.add\", \"Nova Pista\")}\r\n                </button>\r\n            </header>\r\n\r\n            {/* Lista de Pistas */}\r\n            <div className=\"card\">\r\n                {loading ? (\r\n                    <p>{t(\"common.loading\")}</p>\r\n                ) : clues.length === 0 ? (\r\n                    <div style={{ textAlign: \"center\", padding: \"2rem\" }}>\r\n                        <p style={{ fontSize: \"1.2rem\", marginBottom: \"1rem\" }}>\r\n                            ü§ñ <strong>{t(\"admin.treasure.automatedTitle\", \"Modo Autom√°tico Ativo\")}</strong>\r\n                        </p>\r\n                        <p style={{ color: \"var(--text-secondary)\" }}>\r\n                            {t(\"admin.treasure.automatedDescription\", \"O sistema gera pistas autom√°ticas se voc√™ n√£o criar nenhuma manual. Adicione sua primeira pista acima para personalizar!\")}\r\n                        </p>\r\n                    </div>\r\n                ) : (\r\n                    <table className=\"admin-table\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th>#</th>\r\n                                <th>Charada</th>\r\n                                <th>Resposta</th>\r\n                                <th>Obra (Local)</th>\r\n                                <th>{t(\"common.actions\")}</th>\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            {clues.map((clue) => (\r\n                                <tr key={clue.id}>\r\n                                    <td>{clue.order}</td>\r\n                                    <td style={{ maxWidth: \"300px\" }}>{clue.riddle}</td>\r\n                                    <td>{clue.answer}</td>\r\n                                    <td>{clue.work?.title || \"-\"}</td>\r\n                                    <td>\r\n                                        <button className=\"btn-icon\" onClick={() => handleEdit(clue)}>‚úèÔ∏è</button>\r\n                                        <button className=\"btn-icon\" onClick={() => handleDelete(clue.id)} style={{ color: \"#ff6b6b\" }}>üóëÔ∏è</button>\r\n                                    </td>\r\n                                </tr>\r\n                            ))}\r\n                        </tbody>\r\n                    </table>\r\n                )}\r\n            </div>\r\n\r\n            {/* Modal / Overlay de Edi√ß√£o */}\r\n            {showForm && (\r\n                <div style={{\r\n                    position: \"fixed\", top: 0, left: 0, right: 0, bottom: 0,\r\n                    background: \"rgba(0,0,0,0.8)\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\",\r\n                    zIndex: 1000\r\n                }}>\r\n                    <div className=\"card\" style={{ width: \"90%\", maxWidth: \"500px\", padding: \"2rem\" }}>\r\n                        <h2>{editingClue ? \"Editar Pista\" : \"Nova Pista\"}</h2>\r\n                        <form onSubmit={handleSave}>\r\n                            <div className=\"form-group\">\r\n                                <label>Charada / Pergunta *</label>\r\n                                <textarea\r\n                                    required\r\n                                    className=\"input\"\r\n                                    value={formData.riddle}\r\n                                    onChange={e => setFormData({ ...formData, riddle: e.target.value })}\r\n                                    rows={3}\r\n                                    placeholder=\"Ex: Sou alto e verde...\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"form-group\">\r\n                                <label>Resposta Esperada *</label>\r\n                                <input\r\n                                    required\r\n                                    type=\"text\"\r\n                                    className=\"input\"\r\n                                    value={formData.answer}\r\n                                    onChange={e => setFormData({ ...formData, answer: e.target.value })}\r\n                                    placeholder=\"Ex: Palmeira\"\r\n                                />\r\n                            </div>\r\n\r\n                            <div className=\"form-group\">\r\n                                <label>Obra Relacionada (Onde est√° a pista ou a solu√ß√£o)</label>\r\n                                <select\r\n                                    className=\"input\"\r\n                                    value={formData.workId}\r\n                                    onChange={e => setFormData({ ...formData, workId: e.target.value })}\r\n                                >\r\n                                    <option value=\"\">-- Nenhuma (Pista solta) --</option>\r\n                                    {works.map(w => (\r\n                                        <option key={w.id} value={w.id}>{w.title}</option>\r\n                                    ))}\r\n                                </select>\r\n                            </div>\r\n\r\n                            <div className=\"form-group\">\r\n                                <label>Ordem na sequ√™ncia</label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    className=\"input\"\r\n                                    value={formData.order}\r\n                                    onChange={e => setFormData({ ...formData, order: parseInt(e.target.value) })}\r\n                                />\r\n                            </div>\r\n\r\n                            <div style={{ display: \"flex\", gap: \"1rem\", marginTop: \"1.5rem\" }}>\r\n                                <button type=\"button\" className=\"btn btn-outline\" onClick={() => setShowForm(false)}>Cancelar</button>\r\n                                <button type=\"submit\" className=\"btn btn-primary\">Salvar</button>\r\n                            </div>\r\n                        </form>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminUploads.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminVisitorProfile.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminVisitors.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminWorkForm.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":21,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":21,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[800,803],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[800,803],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'videoUrl' is assigned a value but never used.","line":30,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":30,"endColumn":18},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":130,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":130,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4280,4283],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4280,4283],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":244,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":244,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9203,9206],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9203,9206],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { QRCodeCanvas } from \"qrcode.react\";\nimport { api } from \"../../../api/client\";\nimport { useAuth } from \"../../auth/AuthContext\";\nimport { useParams, useNavigate } from \"react-router-dom\";\n\nexport const AdminWorkForm: React.FC = () => {\n  const { t } = useTranslation();\n  const { id } = useParams<{ id: string }>();\n  const { tenantId } = useAuth();\n  const isEdit = Boolean(id);\n  const navigate = useNavigate();\n\n  const [code, setCode] = useState(\"\");\n\n  const [title, setTitle] = useState(\"\");\n  const [artist, setArtist] = useState(\"\");\n  const [year, setYear] = useState(\"\");\n  const [category, setCategory] = useState(\"\"); // Stores categoryId now\n  const [categories, setCategories] = useState<any[]>([]); // List of available categories\n  const [description, setDescription] = useState(\n    t(\"admin.workForm.defaultDescription\")\n  );\n  const [room, setRoom] = useState(\"Sala 2\");\n  const [floor, setFloor] = useState(\"1¬∫ andar\");\n  const [imageUrl, setImageUrl] = useState(\"\");\n  const [audioUrl, setAudioUrl] = useState(\"\");\n  const [librasUrl, setLibrasUrl] = useState(\"\");\n  const [videoUrl, setVideoUrl] = useState(\"\"); // Added missing videoUrl state\n  const [published, setPublished] = useState(true);\n  const [radius, setRadius] = useState(5);\n\n  // Fetch data on load\n  React.useEffect(() => {\n    if (tenantId) {\n      // 1. Fetch Categories\n      api.get(`/categories`, { params: { tenantId } })\n        .then(res => {\n          // Filter only WORK or GENERAL types if needed, or show all. \n          // Assuming backend lists all. We might want to filter by type later.\n          // For now, list all.\n          setCategories(res.data);\n        })\n        .catch(console.error);\n    }\n\n    if (id && tenantId) {\n      // 2. Fetch Work details\n      api.get(`/works/${id}`).then((res) => {\n        const data = res.data;\n        setTitle(data.title);\n        setArtist(data.artist || \"\");\n        setYear(data.year || \"\");\n        // Set categoryId if available\n        setCategory(data.categoryId || \"\");\n        setDescription(data.description || \"\");\n        setRoom(data.room || \"\");\n        setFloor(data.floor || \"\");\n        setImageUrl(data.imageUrl || \"\");\n        setAudioUrl(data.audioUrl || \"\");\n        setLibrasUrl(data.librasUrl || \"\");\n        setVideoUrl(data.videoUrl || \"\");\n        setPublished(data.published ?? true);\n        setRadius(data.radius || 5);\n\n        if (data.qrCode) {\n          setCode(data.qrCode.code);\n        }\n      }).catch(console.error);\n    }\n  }, [id, tenantId]);\n\n  const [isUploading, setIsUploading] = useState(false);\n\n  const handleUpload = async (e: React.ChangeEvent<HTMLInputElement>, type: \"image\" | \"audio\" | \"video\", setter: (url: string) => void) => {\n    if (e.target.files && e.target.files[0]) {\n      const file = e.target.files[0];\n      const formData = new FormData();\n      formData.append(\"file\", file);\n\n      try {\n        setIsUploading(true);\n        const res = await api.post(`/upload/${type}`, formData, {\n          headers: { \"Content-Type\": \"multipart/form-data\" }\n        });\n        setter(res.data.url);\n      } catch (error) {\n        console.error(`Error uploading ${type}`, error);\n        alert(t(\"common.errorUpload\"));\n      } finally {\n        setIsUploading(false);\n      }\n    }\n  };\n\n  const handleImageUpload = (e: React.ChangeEvent<HTMLInputElement>) => handleUpload(e, \"image\", setImageUrl);\n  const handleAudioUpload = (e: React.ChangeEvent<HTMLInputElement>) => handleUpload(e, \"audio\", setAudioUrl);\n  const handleLibrasUpload = (e: React.ChangeEvent<HTMLInputElement>) => handleUpload(e, \"video\", setLibrasUrl);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (!tenantId) return;\n\n    const payload = {\n      title,\n      artist,\n      year,\n      category,\n      description,\n      room,\n      floor,\n      imageUrl,\n      audioUrl,\n      librasUrl,\n      tenantId,\n      code,\n      published,\n      radius: Number(radius)\n    };\n\n    try {\n      if (id) {\n        await api.put(`/works/${id}`, payload);\n      } else {\n        await api.post(\"/works\", payload);\n      }\n      navigate(\"/admin/obras\");\n    } catch (error: any) {\n      console.error(\"Erro ao salvar obra\", error);\n      alert(error.response?.data?.message || t(\"common.error\"));\n    }\n  };\n\n  return (\n    <div>\n      {isUploading && (\n        <div style={{\n          position: \"fixed\", top: 0, left: 0, right: 0, bottom: 0,\n          backgroundColor: \"rgba(0,0,0,0.7)\", zIndex: 9999,\n          display: \"flex\", flexDirection: \"column\", alignItems: \"center\", justifyContent: \"center\",\n          color: \"white\"\n        }}>\n          <div className=\"spinner\" style={{\n            width: \"50px\", height: \"50px\", border: \"5px solid rgba(255,255,255,0.3)\",\n            borderTopColor: \"var(--primary-color)\", borderRadius: \"50%\", animation: \"spin 1s linear infinite\"\n          }}></div>\n          <p style={{ marginTop: \"1rem\", fontSize: \"1.2rem\", fontWeight: \"bold\" }}>Enviando arquivo... (Isso pode levar alguns minutos)</p>\n          <p style={{ fontSize: \"0.9rem\", opacity: 0.8 }}>Por favor, n√£o feche a p√°gina.</p>\n          <style>{`@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }`}</style>\n        </div>\n      )}\n\n      <h1 className=\"section-title\">\n        {isEdit ? t(\"admin.workForm.editTitle\") : t(\"admin.workForm.newTitle\")}\n      </h1>\n      {/* ... */}\n\n      <form onSubmit={handleSubmit} className=\"card\" style={{ maxWidth: 840 }}>\n        <div style={{ display: \"grid\", gridTemplateColumns: \"1fr 1fr\", gap: \"1rem\" }}>\n          {isEdit && id && (\n            <div style={{ gridColumn: \"1 / -1\", display: \"flex\", gap: \"1rem\", alignItems: \"flex-start\", background: \"rgba(0,0,0,0.1)\", padding: \"1rem\", borderRadius: \"0.5rem\" }}>\n              <div style={{ flex: 1 }}>\n                <label>{t(\"admin.workForm.labels.id\")}</label>\n                <div style={{ display: \"flex\", gap: \"0.5rem\" }}>\n                  <input\n                    value={id}\n                    readOnly\n                    style={{ width: \"100%\", padding: \"0.5rem\", borderRadius: \"0.6rem\", background: \"rgba(0,0,0,0.2)\", color: \"var(--text-secondary)\" }}\n                  />\n                  <button\n                    type=\"button\"\n                    className=\"btn btn-secondary\"\n                    onClick={() => {\n                      navigator.clipboard.writeText(id);\n                      alert(\"ID copiado!\");\n                    }}\n                  >\n                    üìã\n                  </button>\n                </div>\n              </div>\n\n              {code && (\n                <div style={{ textAlign: \"center\" }}>\n                  <label>QR Code</label>\n                  <div style={{ background: \"white\", padding: \"0.5rem\", borderRadius: \"0.5rem\", marginTop: \"0.25rem\" }}>\n                    <QRCodeCanvas value={window.location.origin + \"/qr/\" + code} size={100} level=\"H\" />\n                  </div>\n                  <small style={{ display: \"block\", marginTop: \"0.25rem\" }}>#{code}</small>\n                </div>\n              )}\n            </div>\n          )}\n\n          <div style={{ gridColumn: \"1 / -1\" }}>\n            <label style={{ color: \"#d4af37\", fontWeight: \"bold\" }}>üî¢ C√≥digo Num√©rico (Discador)</label>\n            <input\n              value={code}\n              onChange={e => setCode(e.target.value)}\n              placeholder=\"Ex: 101\"\n              style={{ width: \"100%\", padding: \"0.5rem\", borderRadius: \"0.6rem\", border: \"1px solid #d4af37\" }}\n            />\n            <small style={{ color: \"var(--text-secondary)\" }}>C√≥digo usado no discador e para gerar o QR Code.</small>\n          </div>\n\n          <div>\n            <label>{t(\"admin.workForm.labels.title\")}</label>\n            {/* ... title input */}\n            <input\n              value={title}\n              onChange={e => setTitle(e.target.value)}\n              required\n              style={{ width: \"100%\", padding: \"0.5rem\", borderRadius: \"0.6rem\" }}\n            />\n          </div>\n          {/* ... other inputs */}\n          <div>\n            <label>{t(\"admin.workForm.labels.artist\")}</label>\n            <input\n              value={artist}\n              onChange={e => setArtist(e.target.value)}\n              required\n              style={{ width: \"100%\", padding: \"0.5rem\", borderRadius: \"0.6rem\" }}\n            />\n          </div>\n          <div>\n            <label>{t(\"admin.workForm.labels.year\")}</label>\n            <input\n              value={year}\n              onChange={e => setYear(e.target.value)}\n              style={{ width: \"100%\", padding: \"0.5rem\", borderRadius: \"0.6rem\" }}\n            />\n          </div>\n          <div>\n            <label>{t(\"admin.workForm.labels.category\")}</label>\n            <select\n              value={category}\n              onChange={e => setCategory(e.target.value)}\n              style={{ width: \"100%\", padding: \"0.5rem\", borderRadius: \"0.6rem\" }}\n            >\n              <option value=\"\">{t(\"admin.dashboard.select\")}</option>\n              {categories.map((cat: any) => (\n                <option key={cat.id} value={cat.id}>\n                  {cat.name}\n                </option>\n              ))}\n            </select>\n          </div>\n          <div>\n            <label>{t(\"admin.workForm.labels.room\")}</label>\n            <input\n              value={room}\n              onChange={e => setRoom(e.target.value)}\n              style={{ width: \"100%\", padding: \"0.5rem\", borderRadius: \"0.6rem\" }}\n            />\n          </div>\n          <div>\n            <label>{t(\"admin.workForm.labels.floor\")}</label>\n            <input\n              value={floor}\n              onChange={e => setFloor(e.target.value)}\n              style={{ width: \"100%\", padding: \"0.5rem\", borderRadius: \"0.6rem\" }}\n            />\n          </div>\n        </div>\n\n        {/* ... description and uploads ... */}\n        <div style={{ marginTop: \"1rem\" }}>\n          <label>{t(\"admin.workForm.labels.description\")}</label>\n          <textarea\n            value={description}\n            onChange={e => setDescription(e.target.value)}\n            rows={5}\n            style={{\n              width: \"100%\",\n              padding: \"0.6rem\",\n              borderRadius: \"0.6rem\",\n              resize: \"vertical\"\n            }}\n          />\n        </div>\n\n        <div style={{ marginTop: \"1rem\" }}>\n          <label>{t(\"admin.workForm.labels.image\")}</label>\n          <input\n            type=\"file\"\n            accept=\"image/*\"\n            onChange={handleImageUpload}\n            style={{ width: \"100%\", padding: \"0.5rem\", borderRadius: \"0.6rem\" }}\n          />\n          {imageUrl && <p style={{ fontSize: \"0.8rem\", color: \"#10b981\", marginTop: \"0.25rem\" }}>‚úì {t(\"admin.workForm.success.image\")}</p>}\n        </div>\n\n        <div\n          style={{\n            display: \"grid\",\n            gridTemplateColumns: \"1fr 1fr\",\n            gap: \"1rem\",\n            marginTop: \"1rem\"\n          }}\n        >\n          <div>\n            <label>{t(\"admin.workForm.labels.audio\")}</label>\n            <input\n              type=\"file\"\n              accept=\"audio/*\"\n              onChange={handleAudioUpload}\n              style={{ width: \"100%\", padding: \"0.5rem\", borderRadius: \"0.6rem\" }}\n            />\n            {audioUrl && <p style={{ fontSize: \"0.8rem\", color: \"#10b981\", marginTop: \"0.25rem\" }}>‚úì {t(\"admin.workForm.success.audio\")}</p>}\n          </div>\n          <div>\n            <label>{t(\"admin.workForm.labels.libras\")}</label>\n            <input\n              type=\"file\"\n              accept=\"video/*\"\n              onChange={handleLibrasUpload}\n              style={{ width: \"100%\", padding: \"0.5rem\", borderRadius: \"0.6rem\" }}\n            />\n            {librasUrl && <p style={{ fontSize: \"0.8rem\", color: \"#10b981\", marginTop: \"0.25rem\" }}>‚úì {t(\"admin.workForm.success.libras\")}</p>}\n          </div>\n        </div>\n\n        <div style={{ marginTop: \"1rem\", display: \"flex\", gap: \"0.75rem\", alignItems: \"center\" }}>\n          <label>\n            <input\n              type=\"checkbox\"\n              checked={published}\n              onChange={e => setPublished(e.target.checked)}\n            />{\" \"}\n            {t(\"admin.workForm.labels.publish\")}\n          </label>\n        </div>\n\n        <div style={{ marginTop: \"1.5rem\", display: \"flex\", gap: \"0.75rem\" }}>\n          <button type=\"submit\" className=\"btn\">\n            {t(\"common.save\")}\n          </button>\n          <button\n            type=\"button\"\n            className=\"btn btn-secondary\"\n            onClick={() => navigate(\"/admin/obras\")}\n          >\n            {t(\"common.cancel\")}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\admin\\pages\\AdminWorks.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1054,1057],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1054,1057],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport { api } from \"../../../api/client\";\nimport { useAuth } from \"../../auth/AuthContext\";\n\ntype AdminWorkItem = {\n  id: string;\n  title: string;\n  artist?: string;\n  published?: boolean;\n};\n\nexport const AdminWorks: React.FC = () => {\n  const { t } = useTranslation();\n  const { tenantId } = useAuth();\n  const [works, setWorks] = useState<AdminWorkItem[]>([]);\n  const [page, setPage] = useState(1);\n  const [totalPages, setTotalPages] = useState(1);\n  const [loading, setLoading] = useState(false);\n\n  React.useEffect(() => {\n    if (!tenantId) return;\n\n    setLoading(true);\n    api\n      .get(\"/works\", { params: { tenantId, page, limit: 10 } })\n      .then((res) => {\n        // Backend returns { data: [], pagination: {} }\n        const responseData = res.data;\n        const worksList = responseData.data || [];\n        const pagination = responseData.pagination || {};\n\n        const apiWorks = worksList.map((w: any) => ({\n          id: w.id,\n          title: w.title,\n          artist: w.artist ?? \"\",\n          published: w.published ?? true\n        }));\n\n        setWorks(apiWorks);\n        setTotalPages(pagination.totalPages || 1);\n      })\n      .catch((err) => {\n        console.error(\"Failed to fetch works\", err);\n        setWorks([]);\n      })\n      .finally(() => setLoading(false));\n  }, [tenantId, page]);\n\n  return (\n    <div>\n      <div style={{ display: \"flex\", justifyContent: \"space-between\", marginBottom: \"1rem\" }}>\n        <div>\n          <h1 className=\"section-title\">{t(\"admin.works.title\")}</h1>\n          <p className=\"section-subtitle\">\n            {t(\"admin.works.subtitle\")}\n          </p>\n        </div>\n        <Link to=\"/admin/obras/nova\" className=\"btn\">\n          {t(\"admin.works.new\")}\n        </Link>\n      </div>\n\n      {loading ? (\n        <p>{t(\"common.loading\")}</p>\n      ) : (\n        <>\n          <table className=\"table\">\n            <thead>\n              <tr>\n                <th>{t(\"admin.works.table.title\")}</th>\n                <th>{t(\"admin.works.table.artist\")}</th>\n                <th>{t(\"admin.works.table.status\")}</th>\n                <th style={{ textAlign: \"right\" }}>{t(\"admin.works.table.actions\")}</th>\n              </tr>\n            </thead>\n            <tbody>\n              {works.length === 0 ? (\n                <tr>\n                  <td colSpan={4} style={{ textAlign: \"center\", padding: \"2rem\" }}>\n                    Nenhuma obra encontrada.\n                  </td>\n                </tr>\n              ) : (\n                works.map(work => (\n                  <tr key={work.id}>\n                    <td>{work.title}</td>\n                    <td>{work.artist}</td>\n                    <td>\n                      <span className=\"chip\">\n                        {work.published ? t(\"admin.works.status.published\") : t(\"admin.works.status.draft\")}\n                      </span>\n                    </td>\n                    <td style={{ textAlign: \"right\" }}>\n                      <Link to={`/admin/obras/${work.id}`} className=\"btn btn-secondary\">\n                        {t(\"common.edit\")}\n                      </Link>\n                    </td>\n                  </tr>\n                ))\n              )}\n            </tbody>\n          </table>\n\n          {/* Pagination Controls */}\n          <div style={{ display: \"flex\", justifyContent: \"center\", gap: \"1rem\", marginTop: \"1.5rem\", alignItems: \"center\" }}>\n            <button\n              className=\"btn btn-secondary\"\n              disabled={page <= 1}\n              onClick={() => setPage(p => p - 1)}\n            >\n              ‚óÄ Anterior\n            </button>\n            <span>P√°gina {page} de {totalPages}</span>\n            <button\n              className=\"btn btn-secondary\"\n              disabled={page >= totalPages}\n              onClick={() => setPage(p => p + 1)}\n            >\n              Pr√≥xima ‚ñ∂\n            </button>\n          </div>\n        </>\n      )}\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\auth\\AuthContext.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":237,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":237,"endColumn":24,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\auth\\Login.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\auth\\Register.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":107,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":107,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2940,2943],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2940,2943],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport { LanguageSwitcher } from \"../../components/LanguageSwitcher\";\nimport { api } from \"../../api/client\";\n\ninterface RegisterProps {\n  tenantId: string;\n  tenantName: string;\n}\n\nexport const Register: React.FC<RegisterProps> = ({ tenantId, tenantName }) => {\n  const navigate = useNavigate();\n  const { t } = useTranslation();\n  const [name, setName] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n  const [age, setAge] = useState(\"\");\n\n  const [photoPreview, setPhotoPreview] = useState<string | null>(null);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const handlePhotoChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setPhotoPreview(reader.result as string);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    // Valida√ß√£o b√°sica\n    const nameParts = name.trim().split(\" \");\n    if (nameParts.length < 2) {\n      setError(\"Por favor, digite seu nome e sobrenome.\");\n      return;\n    }\n\n    if (!email.includes(\"@\")) {\n      setError(t(\"auth.login.email\") + \" inv√°lido\");\n      return;\n    }\n\n    if (password.length < 6) {\n      setError(\"Senha muito curta (min 6)\");\n      return;\n    }\n\n    if (password !== confirmPassword) {\n      setError(t(\"auth.errors.passwordsDoNotMatch\"));\n      return;\n    }\n\n    const ageNum = parseInt(age);\n    if (isNaN(ageNum) || ageNum < 1 || ageNum > 120) {\n      setError(\"Idade inv√°lida\");\n      return;\n    }\n\n    setIsSubmitting(true);\n    setError(null);\n\n    try {\n      // 1. Criar conta de usu√°rio visitante com api axios\n      const registerRes = await api.post(\"/auth/register\", {\n        tenantId,\n        name,\n        email,\n        password: password,\n        role: \"visitor\"\n      });\n\n      const authData = registerRes.data;\n\n      // 2. Criar registro de visitante com idade (axios)\n      await api.post(\"/visitors/register\", {\n        tenantId,\n        name,\n        email,\n        age: ageNum\n      });\n\n      // Salvar dados do visitante e autentica√ß√£o no localStorage\n      localStorage.setItem(\"museus_visitor\", JSON.stringify({\n        name,\n        email,\n        age: ageNum,\n        tenantId,\n        photo: photoPreview\n      }));\n\n      localStorage.setItem(\"museus_auth_v1\", JSON.stringify({\n        token: authData.accessToken,\n        role: authData.role,\n        tenantId: authData.tenantId\n      }));\n\n      // Redirecionar para home do visitante\n      window.location.href = \"/\";\n    } catch (err: any) {\n      console.error(\"Registration Error:\", err);\n      // Axios puts response data in err.response.data\n      const backendMessage = err.response?.data?.message;\n      const errorMsg = backendMessage || err.message || String(err);\n\n      setError(`Falha (v1.1): ${errorMsg}`);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  return (\n    <div\n      className=\"app-shell\"\n      style={{\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        background: \"linear-gradient(135deg, #1a1108 0%, #2d1810 100%)\",\n        padding: \"2rem\",\n        position: \"relative\"\n      }}\n    >\n      <LanguageSwitcher />\n      <form\n        onSubmit={handleSubmit}\n        style={{\n          width: \"100%\",\n          maxWidth: 480,\n          padding: \"2.5rem\",\n          borderRadius: \"1rem\",\n          border: \"2px solid #d4af37\",\n          background:\n            \"radial-gradient(circle at top, rgba(212,175,55,0.08), transparent 70%),\" +\n            \"linear-gradient(to bottom, #2a1810, #1f1208)\",\n          boxShadow: \"0 20px 60px rgba(0,0,0,0.8), inset 0 1px 0 rgba(212,175,55,0.2)\",\n          position: \"relative\"\n        }}\n      >\n        {/* Ornamento superior */}\n        <div style={{\n          position: \"absolute\",\n          top: \"-1px\",\n          left: \"50%\",\n          transform: \"translateX(-50%)\",\n          width: \"80%\",\n          height: \"2px\",\n          background: \"linear-gradient(90deg, transparent, #d4af37, transparent)\"\n        }} />\n\n        <h2 className=\"text-2xl font-bold text-[var(--accent-gold)] text-center mb-6\" style={{ fontFamily: \"Georgia, serif\" }}>\n          {t(\"auth.register.title\")} <small style={{ fontSize: \"0.6em\", opacity: 0.5 }}>v1.2</small>\n        </h2>\n\n        <p style={{\n          textAlign: \"center\",\n          color: \"#c9b58c\",\n          fontSize: \"0.9rem\",\n          marginBottom: \"2rem\",\n          lineHeight: \"1.5\"\n        }}>\n          {t(\"welcome.subtitle\")} <strong>{tenantName}</strong>.\n        </p>\n\n        {/* Foto (opcional) */}\n        <div style={{\n          display: \"flex\",\n          justifyContent: \"center\",\n          marginBottom: \"1.5rem\"\n        }}>\n          <label\n            htmlFor=\"photo-input\"\n            style={{\n              width: \"120px\",\n              height: \"120px\",\n              borderRadius: \"50%\",\n              border: \"3px solid #d4af37\",\n              overflow: \"hidden\",\n              cursor: \"pointer\",\n              background: photoPreview\n                ? `url(${photoPreview}) center/cover`\n                : \"linear-gradient(135deg, #3a2818, #2a1810)\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              boxShadow: \"0 8px 24px rgba(0,0,0,0.5), inset 0 2px 8px rgba(212,175,55,0.2)\",\n              transition: \"transform 0.2s\",\n              position: \"relative\"\n            }}\n            onMouseEnter={(e) => e.currentTarget.style.transform = \"scale(1.05)\"}\n            onMouseLeave={(e) => e.currentTarget.style.transform = \"scale(1)\"}\n          >\n            {!photoPreview && (\n              <span style={{\n                fontSize: \"2.5rem\",\n                opacity: 0.6,\n                filter: \"sepia(1) hue-rotate(20deg)\"\n              }}>\n                üì∏\n              </span>\n            )}\n          </label>\n          <input\n            id=\"photo-input\"\n            type=\"file\"\n            accept=\"image/*\"\n            onChange={handlePhotoChange}\n            style={{ display: \"none\" }}\n          />\n        </div>\n\n        <p style={{\n          textAlign: \"center\",\n          fontSize: \"0.8rem\",\n          color: \"#8b7355\",\n          marginBottom: \"1.5rem\"\n        }}>\n          {photoPreview ? \"Foto adicionada ‚úì\" : \"Clique para adicionar foto (opcional)\"}\n        </p>\n\n        {/* Nome completo */}\n        <label style={{\n          fontSize: \"0.9rem\",\n          display: \"block\",\n          marginBottom: \"0.4rem\",\n          color: \"#d4af37\",\n          fontFamily: \"serif\"\n        }}>\n          {t(\"auth.register.name\")} *\n        </label>\n        <input\n          type=\"text\"\n          required\n          value={name}\n          onChange={e => setName(e.target.value)}\n          placeholder=\"Digite seu nome\"\n          style={{\n            width: \"100%\",\n            marginBottom: \"1.2rem\",\n            padding: \"0.75rem\",\n            borderRadius: \"0.5rem\",\n            border: \"1px solid #8b7355\",\n            background: \"rgba(42,24,16,0.6)\",\n            color: \"#f5e6d3\",\n            fontFamily: \"serif\"\n          }}\n        />\n\n        {/* E-mail */}\n        <label style={{\n          fontSize: \"0.9rem\",\n          display: \"block\",\n          marginBottom: \"0.4rem\",\n          color: \"#d4af37\",\n          fontFamily: \"serif\"\n        }}>\n          {t(\"auth.register.email\")} *\n        </label>\n        <input\n          type=\"email\"\n          required\n          value={email}\n          onChange={e => setEmail(e.target.value)}\n          placeholder=\"seu@email.com\"\n          style={{\n            width: \"100%\",\n            marginBottom: \"1.2rem\",\n            padding: \"0.75rem\",\n            borderRadius: \"0.5rem\",\n            border: \"1px solid #8b7355\",\n            background: \"rgba(42,24,16,0.6)\",\n            color: \"#f5e6d3\"\n          }}\n        />\n\n        {/* Senha */}\n        <label style={{\n          fontSize: \"0.9rem\",\n          display: \"block\",\n          marginBottom: \"0.4rem\",\n          color: \"#d4af37\",\n          fontFamily: \"serif\"\n        }}>\n          {t(\"auth.register.password\")} *\n        </label>\n        <input\n          type=\"password\"\n          required\n          value={password}\n          onChange={e => setPassword(e.target.value)}\n          placeholder=\"M√≠nimo 6 caracteres\"\n          style={{\n            width: \"100%\",\n            marginBottom: \"1.2rem\",\n            padding: \"0.75rem\",\n            borderRadius: \"0.5rem\",\n            border: \"1px solid #8b7355\",\n            background: \"rgba(42,24,16,0.6)\",\n            color: \"#f5e6d3\"\n          }}\n        />\n\n        {/* Confirmar Senha */}\n        <label style={{\n          fontSize: \"0.9rem\",\n          display: \"block\",\n          marginBottom: \"0.4rem\",\n          color: \"#d4af37\",\n          fontFamily: \"serif\"\n        }}>\n          {t(\"auth.register.confirmPassword\")} *\n        </label>\n        <input\n          type=\"password\"\n          required\n          value={confirmPassword}\n          onChange={e => setConfirmPassword(e.target.value)}\n          placeholder=\"Digite a senha novamente\"\n          style={{\n            width: \"100%\",\n            marginBottom: \"1.2rem\",\n            padding: \"0.75rem\",\n            borderRadius: \"0.5rem\",\n            border: \"1px solid #8b7355\",\n            background: \"rgba(42,24,16,0.6)\",\n            color: \"#f5e6d3\"\n          }}\n        />\n\n        {/* Idade */}\n        <label style={{\n          fontSize: \"0.9rem\",\n          display: \"block\",\n          marginBottom: \"0.4rem\",\n          color: \"#d4af37\",\n          fontFamily: \"serif\"\n        }}>\n          Idade *\n        </label>\n        <input\n          type=\"number\"\n          required\n          min=\"1\"\n          max=\"120\"\n          value={age}\n          onChange={e => setAge(e.target.value)}\n          placeholder=\"Digite sua idade\"\n          style={{\n            width: \"100%\",\n            marginBottom: \"1.5rem\",\n            padding: \"0.75rem\",\n            borderRadius: \"0.5rem\",\n            border: \"1px solid #8b7355\",\n            background: \"rgba(42,24,16,0.6)\",\n            color: \"#f5e6d3\"\n          }}\n        />\n\n        {error && (\n          <p style={{\n            color: \"#ff6b6b\",\n            fontSize: \"0.85rem\",\n            marginBottom: \"1rem\",\n            textAlign: \"center\",\n            background: \"rgba(255,107,107,0.1)\",\n            padding: \"0.5rem\",\n            borderRadius: \"0.5rem\"\n          }}>\n            {error}\n          </p>\n        )}\n\n        <button\n          className=\"btn\"\n          type=\"submit\"\n          disabled={isSubmitting}\n          style={{\n            width: \"100%\",\n            background: \"linear-gradient(135deg, #d4af37, #b8941f)\",\n            color: \"#1a1108\",\n            fontWeight: \"bold\",\n            fontSize: \"1rem\",\n            padding: \"0.9rem\",\n            border: \"none\",\n            borderRadius: \"0.6rem\",\n            cursor: isSubmitting ? \"not-allowed\" : \"pointer\",\n            opacity: isSubmitting ? 0.7 : 1,\n            boxShadow: \"0 4px 16px rgba(212,175,55,0.4)\",\n            fontFamily: \"serif\",\n            textTransform: \"uppercase\",\n            letterSpacing: \"1px\"\n          }}\n        >\n          {isSubmitting ? t(\"common.loading\") : t(\"auth.register.submit\")}\n        </button>\n\n        <div style={{ textAlign: \"center\", marginTop: \"1.5rem\" }}>\n          <p style={{ color: \"#c9b58c\", fontSize: \"0.9rem\" }}>\n            {t(\"auth.register.hasAccount\")}\n            <span\n              onClick={() => navigate(\"/login\")}\n              style={{\n                color: \"#d4af37\",\n                cursor: \"pointer\",\n                textDecoration: \"underline\",\n                fontWeight: \"bold\",\n                marginLeft: \"0.5rem\"\n              }}\n            >\n              {t(\"auth.login.submit\")}\n            </span>\n          </p>\n        </div>\n\n        {/* Ornamento inferior */}\n        <div style={{\n          position: \"absolute\",\n          bottom: \"-1px\",\n          left: \"50%\",\n          transform: \"translateX(-50%)\",\n          width: \"80%\",\n          height: \"2px\",\n          background: \"linear-gradient(90deg, transparent, #d4af37, transparent)\"\n        }} />\n      </form>\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\auth\\RegisterWrapper.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\auth\\TenantContext.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchTenant'. Either include it or remove the dependency array.","line":60,"column":8,"nodeType":"ArrayExpression","endLine":60,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [fetchTenant, tenantId]","fix":{"range":[1849,1859],"text":"[fetchTenant, tenantId]"}}]}],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":77,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":77,"endColumn":26,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":87,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":87,"endColumn":33,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":96,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":96,"endColumn":30,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect, ReactNode } from \"react\";\r\nimport { api } from \"../../api/client\";\r\nimport { useAuth } from \"./AuthContext\";\r\n\r\ninterface TenantSettings {\r\n    id: string;\r\n    name: string;\r\n    slug: string;\r\n    isCityMode: boolean;\r\n    primaryColor: string;\r\n    secondaryColor: string;\r\n    theme: string;\r\n    logoUrl?: string;\r\n    // Add other settings as needed\r\n}\r\n\r\ninterface TenantContextValue {\r\n    tenant: TenantSettings | null;\r\n    loading: boolean;\r\n    isCityMode: boolean;\r\n    refetch: () => void;\r\n}\r\n\r\nconst TenantContext = createContext<TenantContextValue | undefined>(undefined);\r\n\r\nexport const TenantProvider: React.FC<{ children: ReactNode }> = ({ children }) => {\r\n    const { tenantId } = useAuth();\r\n    const [tenant, setTenant] = useState<TenantSettings | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    const fetchTenant = async () => {\r\n        if (!tenantId) {\r\n            setTenant(null);\r\n            setLoading(false);\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const res = await api.get(`/tenants/${tenantId}/settings`);\r\n            setTenant({\r\n                id: tenantId,\r\n                name: res.data.name || \"\",\r\n                slug: res.data.slug || \"\",\r\n                isCityMode: res.data.isCityMode || false,\r\n                primaryColor: res.data.primaryColor || \"#d4af37\",\r\n                secondaryColor: res.data.secondaryColor || \"#cd7f32\",\r\n                theme: res.data.theme || \"dark\",\r\n                logoUrl: res.data.logoUrl\r\n            });\r\n        } catch (err) {\r\n            console.error(\"Erro ao carregar tenant:\", err);\r\n            setTenant(null);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchTenant();\r\n    }, [tenantId]);\r\n\r\n    return (\r\n        <TenantContext.Provider\r\n            value={{\r\n                tenant,\r\n                loading,\r\n                isCityMode: tenant?.isCityMode ?? false,\r\n                refetch: fetchTenant\r\n            }}\r\n        >\r\n            {children}\r\n        </TenantContext.Provider>\r\n    );\r\n};\r\n\r\n// eslint-disable-next-line react-refresh/only-export-components\r\nexport function useTenant(): TenantSettings | null {\r\n    const ctx = useContext(TenantContext);\r\n    if (!ctx) {\r\n        // Return null if not in provider (for visitor pages without auth)\r\n        return null;\r\n    }\r\n    return ctx.tenant;\r\n}\r\n\r\n// eslint-disable-next-line react-refresh/only-export-components\r\nexport function useTenantContext(): TenantContextValue {\r\n    const ctx = useContext(TenantContext);\r\n    if (!ctx) {\r\n        throw new Error(\"useTenantContext must be used within TenantProvider\");\r\n    }\r\n    return ctx;\r\n}\r\n\r\n// eslint-disable-next-line react-refresh/only-export-components\r\nexport function useIsCityMode(): boolean {\r\n    const ctx = useContext(TenantContext);\r\n    return ctx?.isCityMode ?? false;\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\gamification\\context\\GamificationContext.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":106,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4033,4036],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4033,4036],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":224,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":224,"endColumn":29}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect, ReactNode, useCallback } from \"react\";\r\nimport { UserStats, LEVELS, INITIAL_ACHIEVEMENTS } from \"../types\";\r\nimport { api } from \"../../../api/client\";\r\n\r\ninterface GamificationContextType {\r\n    stats: UserStats;\r\n    currentLevel: { level: number; minXp: number; title: string };\r\n    nextLevel: { level: number; minXp: number; title: string } | null;\r\n    progressToNextLevel: number; // 0 to 100\r\n    loading: boolean;\r\n    addXp: (amount: number) => void;\r\n    unlockAchievement: (achievementId: string) => void;\r\n    visitWork: (workId: string) => void;\r\n    completeTrail: (trailId: string) => void;\r\n    refreshGamification?: () => void;\r\n}\r\n\r\nconst GamificationContext = createContext<GamificationContextType | undefined>(undefined);\r\n\r\nconst STORAGE_KEY = \"cultura_viva_gamification\";\r\nconst AUTH_STORAGE_KEY = \"museus_auth_v1\";\r\n\r\n// Helper to safely get auth data from localStorage\r\nconst getAuthFromStorage = (): { email: string | null; tenantId: string | null; isAuthenticated: boolean } => {\r\n    try {\r\n        const stored = window.localStorage.getItem(AUTH_STORAGE_KEY);\r\n        if (stored) {\r\n            const parsed = JSON.parse(stored);\r\n            return {\r\n                email: parsed.email ?? null,\r\n                tenantId: parsed.tenantId ?? null,\r\n                isAuthenticated: !!parsed.token\r\n            };\r\n        }\r\n    } catch {\r\n        // Ignore parse errors\r\n    }\r\n    return { email: null, tenantId: null, isAuthenticated: false };\r\n};\r\n\r\nexport const GamificationProvider: React.FC<{ children: ReactNode }> = ({ children }) => {\r\n    const [authState, setAuthState] = useState(getAuthFromStorage);\r\n    const [loading, setLoading] = useState(false);\r\n    const [stats, setStats] = useState<UserStats>(() => {\r\n        try {\r\n            const stored = localStorage.getItem(STORAGE_KEY);\r\n            if (stored) {\r\n                return JSON.parse(stored);\r\n            }\r\n        } catch {\r\n            // Ignore parse errors\r\n        }\r\n        return {\r\n            xp: 0,\r\n            level: 1,\r\n            achievements: INITIAL_ACHIEVEMENTS,\r\n            visitedWorks: [],\r\n            visitedTrails: [],\r\n        };\r\n    });\r\n\r\n    // Listen for storage changes to update auth state\r\n    useEffect(() => {\r\n        const handleStorageChange = () => {\r\n            setAuthState(getAuthFromStorage());\r\n        };\r\n\r\n        window.addEventListener(\"storage\", handleStorageChange);\r\n\r\n        // Also check periodically in case storage changed in same tab\r\n        const interval = setInterval(() => {\r\n            const newAuth = getAuthFromStorage();\r\n            if (newAuth.email !== authState.email || newAuth.tenantId !== authState.tenantId) {\r\n                setAuthState(newAuth);\r\n            }\r\n        }, 1000);\r\n\r\n        return () => {\r\n            window.removeEventListener(\"storage\", handleStorageChange);\r\n            clearInterval(interval);\r\n        };\r\n    }, [authState.email, authState.tenantId]);\r\n\r\n    const { isAuthenticated, email, tenantId } = authState;\r\n\r\n    const getCurrentLevelInfo = useCallback((xp: number) => {\r\n        return LEVELS.slice().reverse().find((l) => xp >= l.minXp) || LEVELS[0];\r\n    }, []);\r\n\r\n    const fetchBackendData = useCallback(async () => {\r\n        if (!email || !tenantId) return;\r\n\r\n        setLoading(true);\r\n        try {\r\n            const res = await api.get(`/visitors/me/summary?email=${email}&tenantId=${tenantId}`);\r\n            const data = res.data;\r\n\r\n            // Merge backend data with local stats structure\r\n            setStats(prev => {\r\n                const newXp = data.xp || 0;\r\n                const newLevelInfo = getCurrentLevelInfo(newXp);\r\n\r\n                // Map backend achievements to frontend structure\r\n                const backendAchievements = data.achievements || [];\r\n                const mergedAchievements = prev.achievements.map(localAch => {\r\n                    const found = backendAchievements.find((ba: any) => ba.code === localAch.id);\r\n                    if (found) {\r\n                        return { ...localAch, unlockedAt: found.unlockedAt };\r\n                    }\r\n                    return localAch;\r\n                });\r\n\r\n                return {\r\n                    ...prev,\r\n                    xp: newXp,\r\n                    level: newLevelInfo.level,\r\n                    achievements: mergedAchievements,\r\n                };\r\n            });\r\n        } catch (error) {\r\n            console.error(\"Error fetching gamification data\", error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [email, tenantId, getCurrentLevelInfo]);\r\n\r\n    // Sync with backend on mount/auth change - MUST BE AFTER fetchBackendData definition\r\n    useEffect(() => {\r\n        if (isAuthenticated && email && tenantId) {\r\n            fetchBackendData();\r\n        }\r\n    }, [isAuthenticated, email, tenantId, fetchBackendData]);\r\n\r\n    const refreshGamification = useCallback(() => {\r\n        if (isAuthenticated) fetchBackendData();\r\n    }, [isAuthenticated, fetchBackendData]);\r\n\r\n    useEffect(() => {\r\n        try {\r\n            localStorage.setItem(STORAGE_KEY, JSON.stringify(stats));\r\n        } catch {\r\n            // Ignore storage errors\r\n        }\r\n    }, [stats]);\r\n\r\n    const addXp = useCallback((amount: number) => {\r\n        // Optimistic update\r\n        setStats((prev) => {\r\n            const newXp = prev.xp + amount;\r\n            const newLevelInfo = getCurrentLevelInfo(newXp);\r\n            return { ...prev, xp: newXp, level: newLevelInfo.level };\r\n        });\r\n    }, [getCurrentLevelInfo]);\r\n\r\n    const unlockAchievement = useCallback((achievementId: string) => {\r\n        // Optimistic update\r\n        setStats((prev) => {\r\n            const achievementIndex = prev.achievements.findIndex((a) => a.id === achievementId);\r\n            if (achievementIndex === -1) return prev;\r\n            if (prev.achievements[achievementIndex].unlockedAt) return prev;\r\n\r\n            const updatedAchievements = [...prev.achievements];\r\n            updatedAchievements[achievementIndex] = {\r\n                ...prev.achievements[achievementIndex],\r\n                unlockedAt: new Date().toISOString(),\r\n            };\r\n\r\n            return { ...prev, achievements: updatedAchievements };\r\n        });\r\n    }, []);\r\n\r\n    const visitWork = useCallback((workId: string) => {\r\n        setStats((prev) => {\r\n            if (prev.visitedWorks.includes(workId)) return prev;\r\n            return { ...prev, visitedWorks: [...prev.visitedWorks, workId] };\r\n        });\r\n        // Also trigger refresh from backend if connected\r\n        if (isAuthenticated) setTimeout(fetchBackendData, 1000);\r\n    }, [isAuthenticated, fetchBackendData]);\r\n\r\n    const completeTrail = useCallback((trailId: string) => {\r\n        setStats((prev) => {\r\n            if (prev.visitedTrails.includes(trailId)) return prev;\r\n            return { ...prev, visitedTrails: [...prev.visitedTrails, trailId] };\r\n        });\r\n        if (isAuthenticated) setTimeout(fetchBackendData, 1000);\r\n    }, [isAuthenticated, fetchBackendData]);\r\n\r\n    // Client-side achievement checks (can still run for immediate feedback)\r\n    useEffect(() => {\r\n        if (stats.visitedWorks.length >= 5) unlockAchievement(\"art_lover\");\r\n        if (stats.visitedTrails.length >= 1) unlockAchievement(\"trail_blazer\");\r\n    }, [stats.visitedWorks.length, stats.visitedTrails.length, unlockAchievement]);\r\n\r\n    // Derived State Calculation\r\n    const currentLevel = getCurrentLevelInfo(stats.xp);\r\n    const nextLevelIndex = LEVELS.findIndex((l) => l.level === currentLevel.level) + 1;\r\n    const nextLevel = nextLevelIndex < LEVELS.length ? LEVELS[nextLevelIndex] : null;\r\n\r\n    const progressToNextLevel = nextLevel\r\n        ? Math.min(100, Math.max(0, ((stats.xp - currentLevel.minXp) / (nextLevel.minXp - currentLevel.minXp)) * 100))\r\n        : 100;\r\n\r\n    const contextValue: GamificationContextType = {\r\n        stats,\r\n        currentLevel,\r\n        nextLevel,\r\n        progressToNextLevel,\r\n        loading,\r\n        addXp,\r\n        unlockAchievement,\r\n        visitWork,\r\n        completeTrail,\r\n        refreshGamification\r\n    };\r\n\r\n    return (\r\n        <GamificationContext.Provider value={contextValue}>\r\n            {children}\r\n        </GamificationContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useGamification = () => {\r\n    const context = useContext(GamificationContext);\r\n    if (context === undefined) {\r\n        throw new Error(\"useGamification must be used within a GamificationProvider\");\r\n    }\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\gamification\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\master\\MasterLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\master\\pages\\MasterAchievementForm.tsx","messages":[{"ruleId":"prefer-const","severity":2,"message":"'url' is never reassigned. Use 'const' instead.","line":201,"column":45,"nodeType":"Identifier","messageId":"useConst","endLine":201,"endColumn":48,"fix":{"range":[9124,9147],"text":"const url = res.data.url;"}},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":234,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":234,"endColumn":44}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useCallback } from \"react\";\r\nimport { useNavigate, useParams, useSearchParams } from \"react-router-dom\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { api } from \"../../../api/client\";\r\n\r\ninterface Tenant {\r\n    id: string;\r\n    name: string;\r\n}\r\n\r\nexport const MasterAchievementForm: React.FC = () => {\r\n    const { t } = useTranslation();\r\n    const navigate = useNavigate();\r\n    const { id } = useParams();\r\n    const [searchParams] = useSearchParams();\r\n    const initialTenantId = searchParams.get(\"tenantId\") || \"\";\r\n\r\n    const [tenants, setTenants] = useState<Tenant[]>([]);\r\n    const [loading, setLoading] = useState(false);\r\n    const [saving, setSaving] = useState(false);\r\n\r\n    const [formData, setFormData] = useState({\r\n        tenantId: initialTenantId,\r\n        code: \"\",\r\n        title: \"\",\r\n        description: \"\",\r\n        imageUrl: \"\"\r\n    });\r\n\r\n    const isEditing = !!id;\r\n\r\n    const loadTenants = useCallback(async () => {\r\n        try {\r\n            const res = await api.get(\"/tenants\");\r\n            setTenants(res.data);\r\n        } catch (err) {\r\n            console.error(\"Erro ao carregar tenants\", err);\r\n        }\r\n    }, []);\r\n\r\n    const loadAchievement = useCallback(async (achievementId: string) => {\r\n        setLoading(true);\r\n        try {\r\n            const res = await api.get(`/achievements/${achievementId}`);\r\n            setFormData({\r\n                tenantId: res.data.tenantId,\r\n                code: res.data.code,\r\n                title: res.data.title,\r\n                description: res.data.description || \"\",\r\n                imageUrl: res.data.imageUrl || \"\"\r\n            });\r\n        } catch (err) {\r\n            console.error(\"Erro ao carregar conquista\", err);\r\n            alert(t(\"master.achievements.errorLoad\"));\r\n            navigate(\"/master/achievements\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }, [navigate, t]);\r\n\r\n    useEffect(() => {\r\n        loadTenants();\r\n        if (isEditing && id) {\r\n            loadAchievement(id);\r\n        }\r\n    }, [id, isEditing, loadTenants, loadAchievement]);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!formData.tenantId) {\r\n            alert(t(\"master.achievements.form.selectTenantAlert\"));\r\n            return;\r\n        }\r\n\r\n        setSaving(true);\r\n        try {\r\n            if (isEditing) {\r\n                await api.put(`/achievements/${id}`, formData);\r\n            } else {\r\n                await api.post(\"/achievements\", formData);\r\n            }\r\n            navigate(\"/master/achievements\");\r\n        } catch (err) {\r\n            console.error(\"Erro ao salvar\", err);\r\n            alert(t(\"master.achievements.form.errorSave\"));\r\n        } finally {\r\n            setSaving(false);\r\n        }\r\n    };\r\n\r\n    if (loading) return <div className=\"p-8 text-center\">{t(\"master.achievements.loading\")}</div>;\r\n\r\n    return (\r\n        <div className=\"p-6 max-w-2xl mx-auto\">\r\n            <h1 className=\"text-2xl font-bold text-slate-800 mb-6\">\r\n                {isEditing ? t(\"master.achievements.form.editTitle\") : t(\"master.achievements.form.newTitle\")}\r\n            </h1>\r\n\r\n            <form onSubmit={handleSubmit} className=\"bg-white p-6 rounded-lg shadow space-y-4\">\r\n                <div>\r\n                    <label className=\"block text-sm font-medium text-slate-700 mb-1\">{t(\"master.achievements.form.tenant\")}</label>\r\n                    <select\r\n                        className=\"form-input w-full\"\r\n                        value={formData.tenantId}\r\n                        onChange={(e) => setFormData({ ...formData, tenantId: e.target.value })}\r\n                        disabled={isEditing} // Usually we don't move achievements between tenants\r\n                        required\r\n                    >\r\n                        <option value=\"\">{t(\"master.achievements.select\")}</option>\r\n                        {tenants.map((t) => (\r\n                            <option key={t.id} value={t.id}>\r\n                                {t.name}\r\n                            </option>\r\n                        ))}\r\n                    </select>\r\n                </div>\r\n\r\n                <div>\r\n                    <label className=\"block text-sm font-medium text-slate-700 mb-1\">{t(\"master.achievements.form.code\")}</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        className=\"form-input w-full uppercase\"\r\n                        value={formData.code}\r\n                        onChange={(e) => setFormData({ ...formData, code: e.target.value.toUpperCase() })}\r\n                        placeholder={t(\"master.achievements.form.codePlaceholder\")}\r\n                        required\r\n                    />\r\n                    <p className=\"text-xs text-slate-500 mt-1\">\r\n                        {t(\"master.achievements.form.codeHelp\")}\r\n                    </p>\r\n                </div>\r\n\r\n                <div>\r\n                    <label className=\"block text-sm font-medium text-slate-700 mb-1\">{t(\"master.achievements.form.title\")}</label>\r\n                    <input\r\n                        type=\"text\"\r\n                        className=\"form-input w-full\"\r\n                        value={formData.title}\r\n                        onChange={(e) => setFormData({ ...formData, title: e.target.value })}\r\n                        placeholder={t(\"master.achievements.form.titlePlaceholder\")}\r\n                        required\r\n                    />\r\n                </div>\r\n\r\n                <div>\r\n                    <label className=\"block text-sm font-medium text-slate-700 mb-1\">{t(\"master.achievements.form.description\")}</label>\r\n                    <textarea\r\n                        className=\"form-textarea w-full\"\r\n                        rows={3}\r\n                        value={formData.description}\r\n                        onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                        placeholder={t(\"master.achievements.form.descriptionPlaceholder\")}\r\n                    />\r\n                </div>\r\n\r\n                <div>\r\n                    <label className=\"block text-sm font-medium text-slate-700 mb-1\">{t(\"master.achievements.form.imageUrl\")}</label>\r\n\r\n                    <div className=\"flex gap-2 items-center\">\r\n                        <input\r\n                            type=\"text\"\r\n                            className=\"form-input flex-1\"\r\n                            value={formData.imageUrl}\r\n                            onChange={(e) => setFormData({ ...formData, imageUrl: e.target.value })}\r\n                            placeholder={t(\"master.achievements.form.imageUrlPlaceholder\")}\r\n                        />\r\n                        <div className=\"relative\">\r\n                            <input\r\n                                type=\"file\"\r\n                                id=\"file-upload\"\r\n                                className=\"hidden\"\r\n                                accept=\"image/*\"\r\n                                onChange={async (e) => {\r\n                                    const file = e.target.files?.[0];\r\n                                    if (!file) return;\r\n\r\n                                    const uploadData = new FormData();\r\n                                    uploadData.append(\"file\", file);\r\n\r\n                                    try {\r\n                                        // Show loading state if needed\r\n                                        const res = await api.post(\"/upload/image\", uploadData, {\r\n                                            headers: { \"Content-Type\": \"multipart/form-data\" }\r\n                                        });\r\n                                        // Assuming backend returns { url: \"...\" }\r\n                                        // We need to prepend API URL if it's a relative path, or backend returns full path\r\n                                        // Based on upload.ts: returns { url: \"/uploads/...\" } or full R2 URL\r\n                                        // If it's relative, we might need to handle it. \r\n                                        // But usually we store the relative path or full URL. \r\n                                        // Let's assume the frontend can handle whatever is returned or we prepend API_URL if needed.\r\n                                        // For now, just setting what backend returns.\r\n\r\n                                        // If backend returns relative path like /uploads/..., we might want to prepend the base URL for display\r\n                                        // But for storage, we keep it as is? \r\n                                        // Let's just set it.\r\n\r\n                                        // Actually, if it's local upload, it returns /uploads/filename.\r\n                                        // We need to make sure the API serves this static folder.\r\n                                        // Assuming backend serves /uploads.\r\n\r\n                                        let url = res.data.url;\r\n                                        if (url.startsWith(\"/uploads\")) {\r\n                                            // Make it a full URL for the frontend to display immediately\r\n                                            // const apiUrl = import.meta.env.VITE_API_URL || \"http://localhost:3000\";\r\n                                            // url = `${apiUrl}${url}`;\r\n                                            // Actually, let's just keep the relative path if the image component handles it, \r\n                                            // OR store the full URL if we want to be safe.\r\n                                            // Let's store the relative path and let the Image component handle it?\r\n                                            // No, let's try to store the full URL if possible, or just what the backend gave.\r\n                                            // The user can edit it if they want.\r\n                                        }\r\n\r\n                                        setFormData(prev => ({ ...prev, imageUrl: url }));\r\n                                    } catch (err) {\r\n                                        console.error(\"Upload error\", err);\r\n                                        alert(t(\"master.achievements.form.errorUpload\"));\r\n                                    }\r\n                                }}\r\n                            />\r\n                            <label\r\n                                htmlFor=\"file-upload\"\r\n                                className=\"btn btn-secondary cursor-pointer\"\r\n                            >\r\n                                {t(\"master.achievements.form.upload\")}\r\n                            </label>\r\n                        </div>\r\n                    </div>\r\n                    {formData.imageUrl && (\r\n                        <div className=\"mt-2\">\r\n                            <img\r\n                                src={formData.imageUrl.startsWith(\"http\") ? formData.imageUrl : `${import.meta.env.VITE_API_URL}${formData.imageUrl}`}\r\n                                alt=\"Preview\"\r\n                                className=\"h-16 w-16 object-cover rounded border\"\r\n                                onError={(e) => {\r\n                                    // Fallback if image fails to load (e.g. if it's a relative path but we didn't prepend API URL correctly)\r\n                                    // (e.target as HTMLImageElement).src = 'placeholder.png';\r\n                                }}\r\n                            />\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <div className=\"flex justify-end gap-3 pt-4\">\r\n                    <button\r\n                        type=\"button\"\r\n                        onClick={() => navigate(\"/master/achievements\")}\r\n                        className=\"btn btn-secondary\"\r\n                    >\r\n                        {t(\"common.cancel\")}\r\n                    </button>\r\n                    <button\r\n                        type=\"submit\"\r\n                        className=\"btn btn-primary\"\r\n                        disabled={saving}\r\n                    >\r\n                        {saving ? t(\"master.achievements.form.saving\") : t(\"common.save\")}\r\n                    </button>\r\n                </div>\r\n            </form>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\master\\pages\\MasterAchievements.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\master\\pages\\MasterAuditLogs.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[400,403],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[400,403],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[419,422],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[419,422],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchLogs'. Either include it or remove the dependency array.","line":33,"column":8,"nodeType":"ArrayExpression","endLine":33,"endColumn":17,"suggestions":[{"desc":"Update the dependencies array to be: [fetchLogs, filters]","fix":{"range":[968,977],"text":"[fetchLogs, filters]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { Clock, User, Database, Filter, ChevronDown, ChevronRight } from 'lucide-react';\r\nimport { api } from '../../../api/client';\r\n\r\ninterface AuditLogEntry {\r\n    id: string;\r\n    action: string;\r\n    entity: string;\r\n    entityId: string | null;\r\n    userId: string | null;\r\n    userEmail: string | null;\r\n    tenantId: string;\r\n    oldData: any;\r\n    newData: any;\r\n    ipAddress: string | null;\r\n    userAgent: string | null;\r\n    createdAt: string;\r\n}\r\n\r\nexport const MasterAuditLogs: React.FC = () => {\r\n    const [logs, setLogs] = useState<AuditLogEntry[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [filters, setFilters] = useState({\r\n        entity: '',\r\n        action: '',\r\n        tenantId: ''\r\n    });\r\n    const [expandedLog, setExpandedLog] = useState<string | null>(null);\r\n    const [total, setTotal] = useState(0);\r\n\r\n    useEffect(() => {\r\n        fetchLogs();\r\n    }, [filters]);\r\n\r\n    const fetchLogs = async () => {\r\n        setLoading(true);\r\n        try {\r\n            const params = new URLSearchParams();\r\n            if (filters.entity) params.append('entity', filters.entity);\r\n            if (filters.action) params.append('action', filters.action);\r\n            if (filters.tenantId) params.append('tenantId', filters.tenantId);\r\n            params.append('limit', '100');\r\n\r\n            const res = await api.get(`/audit-logs?${params}`);\r\n            setLogs(res.data.logs);\r\n            setTotal(res.data.total);\r\n        } catch (error) {\r\n            console.error('Error fetching audit logs:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const getActionColor = (action: string) => {\r\n        switch (action.toUpperCase()) {\r\n            case 'CREATE': return '#22c55e';\r\n            case 'UPDATE': return '#3b82f6';\r\n            case 'DELETE': return '#ef4444';\r\n            default: return '#9ca3af';\r\n        }\r\n    };\r\n\r\n    const formatDate = (dateStr: string) => {\r\n        const date = new Date(dateStr);\r\n        return date.toLocaleString('pt-BR');\r\n    };\r\n\r\n    return (\r\n        <div className=\"audit-logs-page\">\r\n            <header className=\"page-header\">\r\n                <div>\r\n                    <h1>üìã Logs de Auditoria</h1>\r\n                    <p className=\"subtitle\">Hist√≥rico de todas as a√ß√µes administrativas do sistema</p>\r\n                </div>\r\n                <div className=\"stats-badge\">\r\n                    <span>{total}</span> registros\r\n                </div>\r\n            </header>\r\n\r\n            {/* Filters */}\r\n            <div className=\"filters-bar\">\r\n                <div className=\"filter-group\">\r\n                    <Filter size={18} />\r\n                    <select\r\n                        value={filters.entity}\r\n                        onChange={(e) => setFilters(f => ({ ...f, entity: e.target.value }))}\r\n                    >\r\n                        <option value=\"\">Todas Entidades</option>\r\n                        <option value=\"Work\">Obras</option>\r\n                        <option value=\"Event\">Eventos</option>\r\n                        <option value=\"Visitor\">Visitantes</option>\r\n                        <option value=\"User\">Usu√°rios</option>\r\n                        <option value=\"Trail\">Trilhas</option>\r\n                        <option value=\"Product\">Produtos</option>\r\n                    </select>\r\n                </div>\r\n                <div className=\"filter-group\">\r\n                    <select\r\n                        value={filters.action}\r\n                        onChange={(e) => setFilters(f => ({ ...f, action: e.target.value }))}\r\n                    >\r\n                        <option value=\"\">Todas A√ß√µes</option>\r\n                        <option value=\"CREATE\">Criar</option>\r\n                        <option value=\"UPDATE\">Atualizar</option>\r\n                        <option value=\"DELETE\">Excluir</option>\r\n                        <option value=\"LOGIN\">Login</option>\r\n                    </select>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Logs List */}\r\n            <div className=\"logs-list\">\r\n                {loading ? (\r\n                    <div className=\"loading-state\">Carregando logs...</div>\r\n                ) : logs.length === 0 ? (\r\n                    <div className=\"empty-state\">\r\n                        <Database size={48} />\r\n                        <p>Nenhum log encontrado</p>\r\n                    </div>\r\n                ) : (\r\n                    logs.map(log => (\r\n                        <div\r\n                            key={log.id}\r\n                            className={`log-entry ${expandedLog === log.id ? 'expanded' : ''}`}\r\n                        >\r\n                            <div\r\n                                className=\"log-header\"\r\n                                onClick={() => setExpandedLog(expandedLog === log.id ? null : log.id)}\r\n                            >\r\n                                <div className=\"log-action\" style={{ backgroundColor: getActionColor(log.action) }}>\r\n                                    {log.action}\r\n                                </div>\r\n                                <div className=\"log-entity\">\r\n                                    {log.entity}\r\n                                    {log.entityId && <span className=\"entity-id\">#{log.entityId.slice(0, 8)}</span>}\r\n                                </div>\r\n                                <div className=\"log-user\">\r\n                                    <User size={14} />\r\n                                    {log.userEmail || 'Sistema'}\r\n                                </div>\r\n                                <div className=\"log-time\">\r\n                                    <Clock size={14} />\r\n                                    {formatDate(log.createdAt)}\r\n                                </div>\r\n                                <div className=\"expand-icon\">\r\n                                    {expandedLog === log.id ? <ChevronDown size={18} /> : <ChevronRight size={18} />}\r\n                                </div>\r\n                            </div>\r\n\r\n                            {expandedLog === log.id && (\r\n                                <div className=\"log-details\">\r\n                                    <div className=\"detail-row\">\r\n                                        <strong>IP:</strong> {log.ipAddress || 'N/A'}\r\n                                    </div>\r\n                                    <div className=\"detail-row\">\r\n                                        <strong>User Agent:</strong> {log.userAgent?.slice(0, 50) || 'N/A'}...\r\n                                    </div>\r\n                                    {log.oldData && (\r\n                                        <div className=\"detail-section\">\r\n                                            <strong>Dados Anteriores:</strong>\r\n                                            <pre>{JSON.stringify(log.oldData, null, 2)}</pre>\r\n                                        </div>\r\n                                    )}\r\n                                    {log.newData && (\r\n                                        <div className=\"detail-section\">\r\n                                            <strong>Novos Dados:</strong>\r\n                                            <pre>{JSON.stringify(log.newData, null, 2)}</pre>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n                    ))\r\n                )}\r\n            </div>\r\n\r\n            <style>{`\r\n                .audit-logs-page {\r\n                    padding: 24px;\r\n                }\r\n                \r\n                .page-header {\r\n                    display: flex;\r\n                    justify-content: space-between;\r\n                    align-items: flex-start;\r\n                    margin-bottom: 24px;\r\n                }\r\n                \r\n                .page-header h1 {\r\n                    margin: 0;\r\n                    font-size: 1.75rem;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                }\r\n                \r\n                .subtitle {\r\n                    margin: 4px 0 0;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .stats-badge {\r\n                    padding: 8px 16px;\r\n                    background: linear-gradient(135deg, #3b82f6, #8b5cf6);\r\n                    border-radius: 20px;\r\n                    color: white;\r\n                    font-weight: bold;\r\n                }\r\n                \r\n                .filters-bar {\r\n                    display: flex;\r\n                    gap: 12px;\r\n                    margin-bottom: 20px;\r\n                    flex-wrap: wrap;\r\n                }\r\n                \r\n                .filter-group {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 8px;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .filter-group select {\r\n                    padding: 10px 16px;\r\n                    background: var(--bg-card, #1f2937);\r\n                    border: 1px solid var(--border-color, #374151);\r\n                    border-radius: 8px;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                }\r\n                \r\n                .logs-list {\r\n                    display: flex;\r\n                    flex-direction: column;\r\n                    gap: 8px;\r\n                }\r\n                \r\n                .log-entry {\r\n                    background: var(--bg-card, #1f2937);\r\n                    border-radius: 12px;\r\n                    overflow: hidden;\r\n                }\r\n                \r\n                .log-header {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 16px;\r\n                    padding: 16px;\r\n                    cursor: pointer;\r\n                    transition: background 0.2s;\r\n                }\r\n                \r\n                .log-header:hover {\r\n                    background: var(--bg-elevated, #374151);\r\n                }\r\n                \r\n                .log-action {\r\n                    padding: 4px 12px;\r\n                    border-radius: 6px;\r\n                    font-size: 0.75rem;\r\n                    font-weight: bold;\r\n                    color: white;\r\n                    text-transform: uppercase;\r\n                }\r\n                \r\n                .log-entity {\r\n                    flex: 1;\r\n                    font-weight: 600;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                }\r\n                \r\n                .entity-id {\r\n                    margin-left: 8px;\r\n                    font-weight: normal;\r\n                    font-size: 0.85rem;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .log-user, .log-time {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 6px;\r\n                    font-size: 0.85rem;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .expand-icon {\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .log-details {\r\n                    padding: 16px;\r\n                    background: var(--bg-elevated, #374151);\r\n                    border-top: 1px solid var(--border-color, #4b5563);\r\n                }\r\n                \r\n                .detail-row {\r\n                    margin-bottom: 8px;\r\n                    font-size: 0.9rem;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .detail-section {\r\n                    margin-top: 12px;\r\n                }\r\n                \r\n                .detail-section pre {\r\n                    margin: 8px 0 0;\r\n                    padding: 12px;\r\n                    background: var(--bg-card, #1f2937);\r\n                    border-radius: 8px;\r\n                    font-size: 0.8rem;\r\n                    overflow-x: auto;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                }\r\n                \r\n                .loading-state, .empty-state {\r\n                    text-align: center;\r\n                    padding: 60px 20px;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .empty-state p {\r\n                    margin: 16px 0 0;\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\master\\pages\\MasterDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\master\\pages\\MasterSystemHealth.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\master\\pages\\MasterUserForm.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\master\\pages\\MasterUserForm.tsx:28:7\n  26 |   useEffect(() => {\n  27 |     if (isEdit && id && !isDemoMode) {\n> 28 |       setLoading(true);\n     |       ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  29 |       api.get(`/users/${id}`)\n  30 |         .then(res => {\n  31 |           const u = res.data;","line":28,"column":7,"nodeType":null,"endLine":28,"endColumn":17}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from \"react\";\nimport { api, isDemoMode } from \"../../../api/client\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\n\nexport const MasterUserForm: React.FC = () => {\n  const { t } = useTranslation();\n  const { id } = useParams<{ id: string }>();\n  const isEdit = Boolean(id);\n  const navigate = useNavigate();\n\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [name, setName] = useState(\"\");\n  const [role, setRole] = useState(\"ADMIN\");\n  const [tenantId, setTenantId] = useState(\"\");\n  const [tenants, setTenants] = useState<Array<{ id: string; name: string }>>([]);\n  const [loading, setLoading] = useState(false);\n\n  useEffect(() => {\n    if (!isDemoMode) {\n      api.get(\"/tenants\").then(res => setTenants(res.data)).catch(console.error);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (isEdit && id && !isDemoMode) {\n      setLoading(true);\n      api.get(`/users/${id}`)\n        .then(res => {\n          const u = res.data;\n          setEmail(u.email);\n          setName(u.name);\n          setRole(u.role);\n          setTenantId(u.tenantId || \"\");\n        })\n        .catch(() => {\n          alert(t(\"common.errorLoad\"));\n          navigate(\"/master/users\");\n        })\n        .finally(() => setLoading(false));\n    }\n  }, [isEdit, id, navigate, t]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (isDemoMode) {\n      alert(t(\"master.userForm.demoAlert\"));\n      navigate(\"/master/users\");\n      return;\n    }\n\n    interface UserPayload {\n      email: string;\n      name: string;\n      role: string;\n      password?: string;\n      tenantId?: string | null;\n    }\n\n    const payload: UserPayload = {\n      email,\n      name,\n      role\n    };\n\n    if (!isEdit) {\n      payload.password = password;\n    }\n\n    if (role === \"ADMIN\") {\n      if (!tenantId) {\n        alert(t(\"master.userForm.alerts.selectTenant\"));\n        return;\n      }\n      payload.tenantId = tenantId;\n    } else {\n      payload.tenantId = null;\n    }\n\n    try {\n      if (id) {\n        await api.put(`/users/${id}`, payload);\n      } else {\n        await api.post(\"/users\", payload);\n      }\n      navigate(\"/master/users\");\n    } catch (error) {\n      console.error(\"Erro ao salvar usu√°rio\", error);\n      alert(t(\"master.userForm.alerts.errorSave\"));\n    }\n  };\n\n  if (loading) {\n    return <p>{t(\"common.loading\")}</p>;\n  }\n\n  return (\n    <div>\n      <h1 className=\"section-title\">\n        {isEdit ? t(\"master.userForm.editTitle\") : t(\"master.userForm.newTitle\")}\n      </h1>\n      <p className=\"section-subtitle\">\n        {t(\"master.userForm.subtitle\")}\n      </p>\n\n      <form onSubmit={handleSubmit} className=\"card\" style={{ maxWidth: 640 }}>\n        <div className=\"form-group\">\n          <label htmlFor=\"name\">{t(\"master.userForm.labels.name\")}</label>\n          <input\n            id=\"name\"\n            className=\"input\"\n            value={name}\n            onChange={(e) => setName(e.target.value)}\n            placeholder={t(\"master.userForm.placeholders.name\")}\n            required\n          />\n        </div>\n\n        <div className=\"form-group\">\n          <label htmlFor=\"email\">{t(\"master.userForm.labels.email\")}</label>\n          <input\n            id=\"email\"\n            type=\"email\"\n            className=\"input\"\n            value={email}\n            onChange={(e) => setEmail(e.target.value)}\n            placeholder={t(\"master.userForm.placeholders.email\")}\n            required\n          />\n        </div>\n\n        {!isEdit && (\n          <div className=\"form-group\">\n            <label htmlFor=\"password\">{t(\"master.userForm.labels.password\")}</label>\n            <input\n              id=\"password\"\n              type=\"password\"\n              className=\"input\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              placeholder={t(\"master.userForm.placeholders.password\")}\n              required\n            />\n          </div>\n        )}\n\n        <div className=\"form-group\">\n          <label htmlFor=\"role\">{t(\"master.userForm.labels.role\")}</label>\n          <select\n            id=\"role\"\n            className=\"input\"\n            value={role}\n            onChange={(e) => setRole(e.target.value)}\n          >\n            <option value=\"MASTER\">{t(\"master.userForm.roles.master\")}</option>\n            <option value=\"ADMIN\">{t(\"master.userForm.roles.admin\")}</option>\n          </select>\n        </div>\n\n        {role === \"ADMIN\" && (\n          <div className=\"form-group\">\n            <label htmlFor=\"tenantId\">{t(\"master.userForm.labels.tenant\")}</label>\n            <select\n              id=\"tenantId\"\n              className=\"input\"\n              value={tenantId}\n              onChange={(e) => setTenantId(e.target.value)}\n              required\n            >\n              <option value=\"\">{t(\"master.userForm.placeholders.selectTenant\")}</option>\n              {tenants.map(t => (\n                <option key={t.id} value={t.id}>{t.name}</option>\n              ))}\n            </select>\n            <p style={{ fontSize: \"0.8rem\", color: \"#9ca3af\", marginTop: \"0.25rem\" }}>\n              {t(\"master.userForm.helpers.tenant\")}\n            </p>\n          </div>\n        )}\n\n        <div style={{ display: \"flex\", gap: \"0.75rem\", marginTop: \"1.5rem\" }}>\n          <button type=\"submit\" className=\"btn\">\n            {t(\"common.save\")}\n          </button>\n          <button\n            type=\"button\"\n            className=\"btn btn-secondary\"\n            onClick={() => navigate(\"/master/users\")}\n          >\n            {t(\"common.cancel\")}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\master\\pages\\MasterUsers.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\master\\pages\\TenantForm.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook React.useEffect has a missing dependency: 'loadTenant'. Either include it or remove the dependency array.","line":75,"column":6,"nodeType":"ArrayExpression","endLine":75,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [isEdit, id, loadTenant]","fix":{"range":[3161,3173],"text":"[isEdit, id, loadTenant]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport { api, isDemoMode } from \"../../../api/client\";\n\nexport const TenantForm: React.FC = () => {\n  const { t } = useTranslation();\n  const { id } = useParams<{ id: string }>();\n  const isEdit = Boolean(id);\n  const navigate = useNavigate();\n\n  const [name, setName] = useState(\"\");\n  const [slug, setSlug] = useState(\"\");\n  const [logoUrl, setLogoUrl] = useState(\"\");\n  const [signatureUrl, setSignatureUrl] = useState(\"\");\n  const [certificateBackgroundUrl, setCertificateBackgroundUrl] = useState(\"\");\n\n  const [adminEmail, setAdminEmail] = useState(\"\");\n  const [adminName, setAdminName] = useState(\"\");\n  const [adminPassword, setAdminPassword] = useState(\"\");\n  const [plan, setPlan] = useState(\"START\");\n  const [maxWorks, setMaxWorks] = useState(50);\n\n  // Feature Flags\n  const [featureWorks, setFeatureWorks] = useState(true);\n  const [featureTrails, setFeatureTrails] = useState(true);\n  const [featureEvents, setFeatureEvents] = useState(true);\n  const [featureGamification, setFeatureGamification] = useState(true);\n  const [featureQRCodes, setFeatureQRCodes] = useState(true);\n  const [featureChatAI, setFeatureChatAI] = useState(false);\n  const [featureShop, setFeatureShop] = useState(false);\n  const [featureDonations, setFeatureDonations] = useState(false);\n  const [featureCertificates, setFeatureCertificates] = useState(true);\n  const [featureReviews, setFeatureReviews] = useState(true);\n  const [featureGuestbook, setFeatureGuestbook] = useState(true);\n  const [featureAccessibility, setFeatureAccessibility] = useState(true);\n  const [featureMinigames, setFeatureMinigames] = useState(false);\n\n  const loadTenant = async () => {\n    try {\n      const res = await api.get(`/tenants/${id}`);\n      const data = res.data;\n      setName(data.name);\n      setSlug(data.slug);\n      setLogoUrl(data.logoUrl || \"\");\n      setSignatureUrl(data.signatureUrl || \"\");\n      setCertificateBackgroundUrl(data.certificateBackgroundUrl || \"\");\n      setPlan(data.plan || \"START\");\n      setMaxWorks(data.maxWorks || 50);\n      // Feature Flags\n      setFeatureWorks(data.featureWorks ?? true);\n      setFeatureTrails(data.featureTrails ?? true);\n      setFeatureEvents(data.featureEvents ?? true);\n      setFeatureGamification(data.featureGamification ?? true);\n      setFeatureQRCodes(data.featureQRCodes ?? true);\n      setFeatureChatAI(data.featureChatAI ?? false);\n      setFeatureShop(data.featureShop ?? false);\n      setFeatureDonations(data.featureDonations ?? false);\n      setFeatureCertificates(data.featureCertificates ?? true);\n      setFeatureReviews(data.featureReviews ?? true);\n      setFeatureGuestbook(data.featureGuestbook ?? true);\n      setFeatureAccessibility(data.featureAccessibility ?? true);\n      setFeatureMinigames(data.featureMinigames ?? false);\n    } catch {\n      console.error(\"Failed to load tenant\");\n      alert(t(\"common.errorLoad\"));\n      navigate(\"/master/tenants\");\n    }\n  };\n\n  React.useEffect(() => {\n    if (isEdit && id) {\n      loadTenant();\n    }\n  }, [isEdit, id]);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n\n    if (isDemoMode) {\n      alert(t(\"master.tenantForm.demoAlert\"));\n      navigate(\"/master/tenants\");\n      return;\n    }\n\n    interface TenantPayload {\n      name: string;\n      slug: string;\n      logoUrl?: string;\n      signatureUrl?: string;\n      certificateBackgroundUrl?: string;\n      adminEmail?: string;\n      adminName?: string;\n      adminPassword?: string;\n      plan?: string;\n      maxWorks?: number;\n      // Feature Flags\n      featureWorks?: boolean;\n      featureTrails?: boolean;\n      featureEvents?: boolean;\n      featureGamification?: boolean;\n      featureQRCodes?: boolean;\n      featureChatAI?: boolean;\n      featureShop?: boolean;\n      featureDonations?: boolean;\n      featureCertificates?: boolean;\n      featureReviews?: boolean;\n      featureGuestbook?: boolean;\n      featureAccessibility?: boolean;\n      featureMinigames?: boolean;\n    }\n\n    const payload: TenantPayload = {\n      name,\n      slug,\n      logoUrl,\n      signatureUrl,\n      certificateBackgroundUrl,\n      plan,\n      maxWorks,\n      // Feature Flags\n      featureWorks,\n      featureTrails,\n      featureEvents,\n      featureGamification,\n      featureQRCodes,\n      featureChatAI,\n      featureShop,\n      featureDonations,\n      featureCertificates,\n      featureReviews,\n      featureGuestbook,\n      featureAccessibility,\n      featureMinigames\n    };\n\n    if (!isEdit) {\n      payload.adminEmail = adminEmail;\n      payload.adminName = adminName;\n      payload.adminPassword = adminPassword;\n      payload.plan = plan;\n    }\n\n    try {\n      if (id) {\n        await api.put(`/tenants/${id}`, payload);\n      } else {\n        await api.post(\"/tenants\", payload); // Note: POST /tenants might not accept logo/signature yet in backend logic?\n        // POST /tenants creates minimal tenant. We might need to call update afterwards if creating new.\n        // Or update POST implementation?\n        // Let's assume Master edits afterwards usually. \n        // But logic in backend POST handles specific fields.\n        // I won't change POST backend logic now to avoid risks, only PUT supports it properly in my edits.\n        // If creating new, these fields might be ignored. That's fine for now, user can edit later.\n      }\n      navigate(\"/master/tenants\");\n    } catch (error) {\n      console.error(\"Erro ao salvar tenant\", error);\n      alert(t(\"master.tenantForm.errorSave\"));\n    }\n  };\n\n  return (\n    <div>\n      <h1 className=\"section-title\">\n        {isEdit ? t(\"master.tenantForm.editTitle\") : t(\"master.tenantForm.newTitle\")}\n      </h1>\n      <p className=\"section-subtitle\">\n        {t(\"master.tenantForm.subtitle\")}\n      </p>\n\n      <form onSubmit={handleSubmit} className=\"card\" style={{ maxWidth: 720 }}>\n        <div className=\"form-group\">\n          <label htmlFor=\"name\">{t(\"master.tenantForm.labels.name\")}</label>\n          <input\n            id=\"name\"\n            className=\"input\"\n            value={name}\n            onChange={e => setName(e.target.value)}\n            placeholder={t(\"master.tenantForm.placeholders.name\")}\n            required\n          />\n        </div>\n\n        <div className=\"form-group\">\n          <label htmlFor=\"plan\">{t(\"master.tenantForm.labels.plan\")}</label>\n          <div style={{ display: \"flex\", gap: \"0.5rem\" }}>\n            <select\n              id=\"plan\"\n              className=\"input\"\n              value={plan}\n              onChange={e => {\n                setPlan(e.target.value);\n                // Auto-set limits\n                if (e.target.value === \"START\") setMaxWorks(50);\n                if (e.target.value === \"PRO\") setMaxWorks(200);\n                if (e.target.value === \"ENTERPRISE\") setMaxWorks(500);\n              }}\n              style={{ flex: 1 }}\n            >\n              <option value=\"START\">{t(\"master.tenantForm.plans.start\")}</option>\n              <option value=\"PRO\">{t(\"master.tenantForm.plans.pro\")}</option>\n              <option value=\"ENTERPRISE\">{t(\"master.tenantForm.plans.enterprise\")}</option>\n              <option value=\"CUSTOM\">{t(\"master.tenantForm.plans.custom\")}</option>\n            </select>\n            {plan === \"CUSTOM\" && (\n              <input\n                className=\"input\"\n                placeholder={t(\"master.tenantForm.placeholders.customPlan\")}\n                onChange={e => setPlan(e.target.value)}\n                style={{ flex: 1 }}\n              />\n            )}\n          </div>\n          <p style={{ fontSize: \"0.8rem\", color: \"#9ca3af\", marginTop: \"0.25rem\" }}>\n            {t(\"master.tenantForm.helpers.plan\")}\n          </p>\n          <input\n            className=\"input\"\n            value={plan}\n            onChange={e => setPlan(e.target.value)}\n            placeholder={t(\"master.tenantForm.labels.customPlan\")}\n            style={{ marginTop: \"0.5rem\" }}\n          />\n        </div>\n\n        <div className=\"form-group\">\n          <label htmlFor=\"maxWorks\">{t(\"master.tenantForm.labels.maxWorks\")}</label>\n          <input\n            id=\"maxWorks\"\n            type=\"number\"\n            className=\"input\"\n            value={maxWorks}\n            onChange={e => setMaxWorks(parseInt(e.target.value))}\n          />\n          <p style={{ fontSize: \"0.8rem\", color: \"#9ca3af\", marginTop: \"0.25rem\" }}>\n            {t(\"master.tenantForm.helpers.maxWorks\")}\n          </p>\n        </div>\n\n        {/* Branding Section */}\n        <div style={{ marginTop: \"1.5rem\", marginBottom: \"1.5rem\", borderTop: \"1px solid #eee\", paddingTop: \"1rem\" }}>\n          <h3 style={{ fontSize: \"1rem\", marginBottom: \"0.5rem\" }}>Branding & Certificados</h3>\n\n          <div className=\"form-group\">\n            <label htmlFor=\"logoUrl\">URL do Logo</label>\n            <input\n              id=\"logoUrl\"\n              className=\"input\"\n              value={logoUrl}\n              onChange={e => setLogoUrl(e.target.value)}\n              placeholder=\"https://...\"\n            />\n          </div>\n\n          <div className=\"form-group\">\n            <label htmlFor=\"signatureUrl\">URL da Assinatura (Certificados)</label>\n            <input\n              id=\"signatureUrl\"\n              className=\"input\"\n              value={signatureUrl}\n              onChange={e => setSignatureUrl(e.target.value)}\n              placeholder=\"https://...\"\n            />\n            <p style={{ fontSize: \"0.8rem\", color: \"#9ca3af\" }}>\n              Imagem da assinatura digital para ser inserida nos certificados.\n            </p>\n          </div>\n\n          <div className=\"form-group\">\n            <label htmlFor=\"certificateBackgroundUrl\">URL do Fundo do Certificado (Template)</label>\n            <input\n              id=\"certificateBackgroundUrl\"\n              className=\"input\"\n              value={certificateBackgroundUrl}\n              onChange={e => setCertificateBackgroundUrl(e.target.value)}\n              placeholder=\"https://...\"\n            />\n            <p style={{ fontSize: \"0.8rem\", color: \"#9ca3af\" }}>\n              Imagem A4 (Paisagem) que substituir√° o fundo padr√£o. O texto ser√° sobreposto a ela.\n            </p>\n          </div>\n        </div>\n\n        {/* Feature Flags Section */}\n        <div style={{ marginTop: \"1.5rem\", marginBottom: \"1.5rem\", borderTop: \"1px solid #eee\", paddingTop: \"1rem\" }}>\n          <h3 style={{ fontSize: \"1rem\", marginBottom: \"0.75rem\" }}>üì¶ Funcionalidades Habilitadas</h3>\n          <p style={{ fontSize: \"0.85rem\", color: \"#9ca3af\", marginBottom: \"1rem\" }}>\n            Selecione os m√≥dulos que este museu ter√° acesso. M√≥dulos premium est√£o marcados com ‚≠ê.\n          </p>\n\n          <div style={{\n            display: \"grid\",\n            gridTemplateColumns: \"repeat(auto-fit, minmax(200px, 1fr))\",\n            gap: \"0.75rem\"\n          }}>\n            <label style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\", cursor: \"pointer\" }}>\n              <input type=\"checkbox\" checked={featureWorks} onChange={e => setFeatureWorks(e.target.checked)} />\n              üé® Obras/Artefatos\n            </label>\n            <label style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\", cursor: \"pointer\" }}>\n              <input type=\"checkbox\" checked={featureTrails} onChange={e => setFeatureTrails(e.target.checked)} />\n              üó∫Ô∏è Trilhas/Roteiros\n            </label>\n            <label style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\", cursor: \"pointer\" }}>\n              <input type=\"checkbox\" checked={featureEvents} onChange={e => setFeatureEvents(e.target.checked)} />\n              üìÖ Eventos\n            </label>\n            <label style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\", cursor: \"pointer\" }}>\n              <input type=\"checkbox\" checked={featureGamification} onChange={e => setFeatureGamification(e.target.checked)} />\n              üèÜ Gamifica√ß√£o (XP, Ranking)\n            </label>\n            <label style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\", cursor: \"pointer\" }}>\n              <input type=\"checkbox\" checked={featureQRCodes} onChange={e => setFeatureQRCodes(e.target.checked)} />\n              üì∏ QR Codes/Scanner\n            </label>\n            <label style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\", cursor: \"pointer\" }}>\n              <input type=\"checkbox\" checked={featureCertificates} onChange={e => setFeatureCertificates(e.target.checked)} />\n              üìú Certificados\n            </label>\n            <label style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\", cursor: \"pointer\" }}>\n              <input type=\"checkbox\" checked={featureReviews} onChange={e => setFeatureReviews(e.target.checked)} />\n              ‚≠ê Favoritos/Avalia√ß√µes\n            </label>\n            <label style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\", cursor: \"pointer\" }}>\n              <input type=\"checkbox\" checked={featureGuestbook} onChange={e => setFeatureGuestbook(e.target.checked)} />\n              ‚úçÔ∏è Livro de Visitas\n            </label>\n            <label style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\", cursor: \"pointer\" }}>\n              <input type=\"checkbox\" checked={featureAccessibility} onChange={e => setFeatureAccessibility(e.target.checked)} />\n              ‚ôø Acessibilidade/Libras\n            </label>\n            <label style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\", cursor: \"pointer\" }}>\n              <input type=\"checkbox\" checked={featureMinigames} onChange={e => setFeatureMinigames(e.target.checked)} />\n              üéÆ Minigame (Art Run) <span style={{ fontSize: '0.7em', background: '#22c55e', color: '#fff', padding: '1px 4px', borderRadius: '4px' }}>NOVO</span>\n            </label>\n\n            {/* Premium Features */}\n            <label style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\", cursor: \"pointer\", color: \"#f59e0b\" }}>\n              <input type=\"checkbox\" checked={featureChatAI} onChange={e => setFeatureChatAI(e.target.checked)} />\n              ü§ñ Chat IA ‚≠ê\n            </label>\n            <label style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\", cursor: \"pointer\", color: \"#f59e0b\" }}>\n              <input type=\"checkbox\" checked={featureShop} onChange={e => setFeatureShop(e.target.checked)} />\n              üõí Loja Virtual ‚≠ê\n            </label>\n            <label style={{ display: \"flex\", alignItems: \"center\", gap: \"0.5rem\", cursor: \"pointer\", color: \"#f59e0b\" }}>\n              <input type=\"checkbox\" checked={featureDonations} onChange={e => setFeatureDonations(e.target.checked)} />\n              üíù Doa√ß√µes ‚≠ê\n            </label>\n          </div>\n        </div>\n\n        <div className=\"form-group\">\n          <label htmlFor=\"slug\">{t(\"master.tenantForm.labels.slug\")}</label>\n          <input\n            id=\"slug\"\n            className=\"input\"\n            value={slug}\n            onChange={e => setSlug(e.target.value)}\n            placeholder={t(\"master.tenantForm.placeholders.slug\")}\n            required\n          />\n          <p style={{ fontSize: \"0.8rem\", color: \"#9ca3af\", marginTop: \"0.25rem\" }}>\n            {t(\"master.tenantForm.helpers.slug\")}\n          </p>\n        </div>\n\n        {!isEdit && (\n          <>\n            <h2 style={{ fontSize: \"1.1rem\", marginTop: \"1.5rem\", marginBottom: \"1rem\" }}>\n              {t(\"master.tenantForm.labels.adminSection\")}\n            </h2>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"adminName\">{t(\"master.tenantForm.labels.adminName\")}</label>\n              <input\n                id=\"adminName\"\n                className=\"input\"\n                value={adminName}\n                onChange={e => setAdminName(e.target.value)}\n                placeholder={t(\"master.tenantForm.placeholders.adminName\")}\n                required\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"adminEmail\">{t(\"master.tenantForm.labels.adminEmail\")}</label>\n              <input\n                id=\"adminEmail\"\n                type=\"email\"\n                className=\"input\"\n                value={adminEmail}\n                onChange={e => setAdminEmail(e.target.value)}\n                placeholder={t(\"master.tenantForm.placeholders.adminEmail\")}\n                required\n              />\n            </div>\n\n            <div className=\"form-group\">\n              <label htmlFor=\"adminPassword\">{t(\"master.tenantForm.labels.adminPassword\")}</label>\n              <input\n                id=\"adminPassword\"\n                type=\"password\"\n                className=\"input\"\n                value={adminPassword}\n                onChange={e => setAdminPassword(e.target.value)}\n                placeholder={t(\"master.tenantForm.placeholders.adminPassword\")}\n                required\n              />\n            </div>\n          </>\n        )}\n\n        <div style={{ marginTop: \"1.5rem\", display: \"flex\", gap: \"0.75rem\" }}>\n          <button type=\"submit\" className=\"btn\">\n            {t(\"common.save\")}\n          </button>\n          <button\n            type=\"button\"\n            className=\"btn btn-secondary\"\n            onClick={() => navigate(\"/master/tenants\")}\n          >\n            {t(\"common.cancel\")}\n          </button>\n        </div>\n      </form>\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\master\\pages\\TenantsList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\public\\CertificateValidator.tsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`validateCertificate` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\public\\CertificateValidator.tsx:24:19\n  22 |\n  23 |     useEffect(() => {\n> 24 |         if (code) validateCertificate();\n     |                   ^^^^^^^^^^^^^^^^^^^ `validateCertificate` accessed before it is declared\n  25 |     }, [code]);\n  26 |\n  27 |     const validateCertificate = async () => {\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\public\\CertificateValidator.tsx:27:5\n  25 |     }, [code]);\n  26 |\n> 27 |     const validateCertificate = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 28 |         try {\n     | ^^^^^^^^^^^^^\n> 29 |             // Note: Use baseURL-less request or ensure API client handles relative paths correctly \n     ‚Ä¶\n     | ^^^^^^^^^^^^^\n> 46 |         }\n     | ^^^^^^^^^^^^^\n> 47 |     };\n     | ^^^^^^^ `validateCertificate` is declared here\n  48 |\n  49 |     return (\n  50 |         <div className=\"min-h-screen bg-[#1a1108] text-[#f5e6d3] font-serif flex flex-col items-center justify-center p-4 relative overflow-hidden\">","line":24,"column":19,"nodeType":null,"endLine":24,"endColumn":38},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'validateCertificate'. Either include it or remove the dependency array.","line":25,"column":8,"nodeType":"ArrayExpression","endLine":25,"endColumn":14,"suggestions":[{"desc":"Update the dependencies array to be: [code, validateCertificate]","fix":{"range":[811,817],"text":"[code, validateCertificate]"}}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":39,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1402,1405],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1402,1405],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from 'react';\r\nimport { useParams } from 'react-router-dom';\r\nimport { api } from '../../api/client';\r\nimport { CheckCircle, XCircle, AlertTriangle, Download, Calendar, User, MapPin } from 'lucide-react';\r\n\r\ninterface CertificateData {\r\n    id: string;\r\n    code: string;\r\n    visitorName: string;\r\n    issuerName: string;\r\n    issuerLogo?: string;\r\n    title: string;\r\n    type: string;\r\n    issuedAt: string;\r\n    description: string;\r\n}\r\n\r\nexport const CertificateValidator: React.FC = () => {\r\n    const { code } = useParams();\r\n    const [status, setStatus] = useState<'loading' | 'valid' | 'invalid' | 'error'>('loading');\r\n    const [data, setData] = useState<CertificateData | null>(null);\r\n\r\n    useEffect(() => {\r\n        if (code) validateCertificate();\r\n    }, [code]);\r\n\r\n    const validateCertificate = async () => {\r\n        try {\r\n            // Note: Use baseURL-less request or ensure API client handles relative paths correctly \r\n            // if this page is rendered outside the main app context. \r\n            // Assuming standard api client works for now.\r\n            const res = await api.get(`/public/certificates/${code}`);\r\n            if (res.data.valid) {\r\n                setData(res.data.data);\r\n                setStatus('valid');\r\n            } else {\r\n                setStatus('invalid');\r\n            }\r\n        } catch (err: any) {\r\n            console.error(err);\r\n            if (err.response?.status === 404) {\r\n                setStatus('invalid');\r\n            } else {\r\n                setStatus('error');\r\n            }\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"min-h-screen bg-[#1a1108] text-[#f5e6d3] font-serif flex flex-col items-center justify-center p-4 relative overflow-hidden\">\r\n            {/* Background Texture */}\r\n            <div className=\"absolute inset-0 z-0 opacity-10 pointer-events-none\" style={{\r\n                backgroundImage: `url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23d4af37' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")`\r\n            }} />\r\n\r\n            <div className=\"relative z-10 w-full max-w-lg\">\r\n\r\n                {/* Header Logo or Brand */}\r\n                <div className=\"text-center mb-8\">\r\n                    <h1 className=\"text-2xl font-bold text-[#d4af37] tracking-widest uppercase\">Cultura Viva</h1>\r\n                    <p className=\"text-[#8b7355] text-xs uppercase tracking-widest mt-1\">Sistema de Valida√ß√£o Digital</p>\r\n                </div>\r\n\r\n                <div className=\"bg-[#2a1810] border border-[rgba(212,175,55,0.3)] rounded-lg shadow-2xl overflow-hidden backdrop-blur-sm\">\r\n\r\n                    {/* Status Header */}\r\n                    <div className={`p-6 text-center border-b ${status === 'valid' ? 'bg-green-900/20 border-green-800' :\r\n                            status === 'invalid' ? 'bg-red-900/20 border-red-800' :\r\n                                'bg-gray-900/20 border-gray-800'\r\n                        }`}>\r\n                        {status === 'loading' && <div className=\"text-[#d4af37]\">Verificando autenticidade...</div>}\r\n\r\n                        {status === 'valid' && (\r\n                            <div className=\"flex flex-col items-center gap-3\">\r\n                                <div className=\"w-16 h-16 rounded-full bg-green-500/10 flex items-center justify-center border-2 border-green-500 text-green-500 shadow-[0_0_20px_rgba(34,197,94,0.3)]\">\r\n                                    <CheckCircle size={32} />\r\n                                </div>\r\n                                <div>\r\n                                    <h2 className=\"text-xl font-bold text-green-400\">Certificado V√°lido</h2>\r\n                                    <p className=\"text-green-300/60 text-sm\">A autenticidade deste documento foi confirmada.</p>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {status === 'invalid' && (\r\n                            <div className=\"flex flex-col items-center gap-3\">\r\n                                <div className=\"w-16 h-16 rounded-full bg-red-500/10 flex items-center justify-center border-2 border-red-500 text-red-500 shadow-[0_0_20px_rgba(239,68,68,0.3)]\">\r\n                                    <XCircle size={32} />\r\n                                </div>\r\n                                <div>\r\n                                    <h2 className=\"text-xl font-bold text-red-400\">Certificado Inv√°lido</h2>\r\n                                    <p className=\"text-red-300/60 text-sm\">O c√≥digo fornecido n√£o foi encontrado ou foi revogado.</p>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {status === 'error' && (\r\n                            <div className=\"flex flex-col items-center gap-3\">\r\n                                <div className=\"w-16 h-16 rounded-full bg-yellow-500/10 flex items-center justify-center border-2 border-yellow-500 text-yellow-500\">\r\n                                    <AlertTriangle size={32} />\r\n                                </div>\r\n                                <h2 className=\"text-xl font-bold text-yellow-400\">Erro na Verifica√ß√£o</h2>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Certificate Details */}\r\n                    {status === 'valid' && data && (\r\n                        <div className=\"p-8 space-y-6\">\r\n                            {/* Visitor Info */}\r\n                            <div className=\"text-center space-y-2 pb-6 border-b border-[rgba(212,175,55,0.1)]\">\r\n                                <div className=\"text-[#8b7355] text-xs uppercase tracking-wider\">Certificado emitido para</div>\r\n                                <h3 className=\"text-2xl font-bold text-[#f5e6d3]\">{data.visitorName}</h3>\r\n                            </div>\r\n\r\n                            {/* Details Grid */}\r\n                            <div className=\"grid grid-cols-1 gap-4\">\r\n                                <div className=\"flex items-start gap-3 p-3 rounded bg-[#3a2818]/30\">\r\n                                    <User className=\"text-[#d4af37] shrink-0 mt-0.5\" size={18} />\r\n                                    <div>\r\n                                        <div className=\"text-[10px] text-[#8b7355] uppercase font-bold\">Atividade</div>\r\n                                        <div className=\"text-[#f5e6d3] font-medium\">{data.title}</div>\r\n                                        <div className=\"text-[#c9b58c] text-xs mt-0.5 leading-relaxed\">{data.description}</div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"flex items-start gap-3 p-3 rounded bg-[#3a2818]/30\">\r\n                                    <MapPin className=\"text-[#d4af37] shrink-0 mt-0.5\" size={18} />\r\n                                    <div>\r\n                                        <div className=\"text-[10px] text-[#8b7355] uppercase font-bold\">Emissor</div>\r\n                                        <div className=\"text-[#f5e6d3] font-medium\">{data.issuerName}</div>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <div className=\"flex items-start gap-3 p-3 rounded bg-[#3a2818]/30\">\r\n                                    <Calendar className=\"text-[#d4af37] shrink-0 mt-0.5\" size={18} />\r\n                                    <div>\r\n                                        <div className=\"text-[10px] text-[#8b7355] uppercase font-bold\">Data de Emiss√£o</div>\r\n                                        <div className=\"text-[#f5e6d3] font-medium\">{new Date(data.issuedAt).toLocaleDateString('pt-BR')}</div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Actions */}\r\n                            <div className=\"pt-4\">\r\n                                <button\r\n                                    onClick={() => window.print()}\r\n                                    className=\"w-full flex items-center justify-center gap-2 py-3 bg-gradient-to-r from-[#d4af37] to-[#b8941f] text-[#1a1108] font-bold rounded shadow-lg hover:shadow-[0_0_15px_rgba(212,175,55,0.4)] transition-all\"\r\n                                >\r\n                                    <Download size={18} />\r\n                                    Imprimir Comprovante\r\n                                </button>\r\n                            </div>\r\n\r\n                            {/* Footer Hash */}\r\n                            <div className=\"text-center mt-4\">\r\n                                <div className=\"text-[10px] text-[#8b7355]\">C√≥digo de Autenticidade</div>\r\n                                <div className=\"font-mono text-xs text-[#d4af37]/80 tracking-widest mt-0.5\">{data.code}</div>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n                </div>\r\n\r\n                <div className=\"text-center mt-8 text-[#8b7355] text-xs\">\r\n                    &copy; {new Date().getFullYear()} Cultura Viva. Plataforma de Gest√£o Museol√≥gica.\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\VisitorLayout.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":66,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2385,2388],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2385,2388],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":77,"column":53,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":77,"endColumn":56,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2762,2765],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2762,2765],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":106,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4634,4637],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4634,4637],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'renderNavLinks' is assigned a value but never used.","line":109,"column":9,"nodeType":null,"messageId":"unusedVar","endLine":109,"endColumn":23}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from \"react\";\r\nimport { Link, useLocation, useNavigate } from \"react-router-dom\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { LanguageSwitcher } from \"../../components/LanguageSwitcher\";\r\nimport { api } from \"../../api/client\";\r\n\r\nimport { useAuth } from \"../auth/AuthContext\";\r\nimport { WelcomeAnimation } from \"./components/WelcomeAnimation\";\r\n\r\nimport { GlobalSearch } from \"./components/GlobalSearch\";\r\nimport { DialerModal } from \"./components/DialerModal\";\r\nimport { AiChatWidget } from \"./components/AiChatWidget\";\r\nimport { GlobalAudioPlayer } from \"./components/GlobalAudioPlayer\";\r\n\r\nimport \"./VisitorLayout.css\";\r\n\r\n// Custom event for PWA install\r\ninterface BeforeInstallPromptEvent extends Event {\r\n  prompt: () => Promise<void>;\r\n  userChoice: Promise<{ outcome: 'accepted' | 'dismissed'; platform: string }>;\r\n}\r\n\r\nexport const VisitorLayout: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n  const navigate = useNavigate();\r\n  const { t } = useTranslation();\r\n  const location = useLocation();\r\n  const { logout, name, email, tenantId } = useAuth();\r\n\r\n  const [isMenuOpen, setIsMenuOpen] = useState(false);\r\n  const [isSearchOpen, setIsSearchOpen] = useState(false);\r\n  const [isDialerOpen, setIsDialerOpen] = useState(false);\r\n  const [showWelcome, setShowWelcome] = useState(true);\r\n  const [deferredPrompt, setDeferredPrompt] = useState<BeforeInstallPromptEvent | null>(null);\r\n\r\n  // Theme and Features State - MUST be declared before allLinks uses it\r\n  const [settings, setSettings] = useState<{\r\n    primaryColor: string;\r\n    secondaryColor: string;\r\n    historicalFont: boolean;\r\n    logoUrl?: string;\r\n    name?: string;\r\n    // Feature Flags\r\n    featureWorks?: boolean;\r\n    featureTrails?: boolean;\r\n    featureEvents?: boolean;\r\n    featureGamification?: boolean;\r\n    featureQRCodes?: boolean;\r\n    featureChatAI?: boolean;\r\n    featureShop?: boolean;\r\n    featureDonations?: boolean;\r\n    featureCertificates?: boolean;\r\n    featureReviews?: boolean;\r\n    featureGuestbook?: boolean;\r\n    featureAccessibility?: boolean;\r\n  } | null>(null);\r\n\r\n  useEffect(() => {\r\n    if (tenantId) {\r\n      api.get(`/tenants/${tenantId}/settings`)\r\n        .then(res => setSettings(res.data))\r\n        .catch(console.error);\r\n    }\r\n  }, [tenantId]);\r\n\r\n  useEffect(() => {\r\n    const handler = (e: any) => {\r\n      e.preventDefault();\r\n      setDeferredPrompt(e);\r\n    };\r\n    window.addEventListener(\"beforeinstallprompt\", handler);\r\n    return () => window.removeEventListener(\"beforeinstallprompt\", handler);\r\n  }, []);\r\n\r\n  const handleInstallClick = () => {\r\n    if (deferredPrompt) {\r\n      deferredPrompt.prompt();\r\n      deferredPrompt.userChoice.then((choiceResult: any) => {\r\n        if (choiceResult.outcome === \"accepted\") {\r\n          console.log(\"User accepted the install prompt\");\r\n        }\r\n        setDeferredPrompt(null);\r\n      });\r\n    }\r\n  };\r\n\r\n  const allLinks = [\r\n    { to: \"/home\", label: t(\"visitor.sidebar.home\"), icon: \"üè†\", feature: null }, // Always visible\r\n    { to: \"/obras\", label: t(\"visitor.sidebar.artworks\"), icon: \"üé®\", feature: \"featureWorks\" },\r\n    { to: \"/trilhas\", label: t(\"visitor.sidebar.trails\"), icon: \"üó∫Ô∏è\", feature: \"featureTrails\" },\r\n    { to: \"/mapa\", label: t(\"visitor.sidebar.map\", \"Mapa\"), icon: \"üìç\", feature: null }, // Always visible\r\n    { to: \"/eventos\", label: t(\"visitor.sidebar.events\"), icon: \"üìÖ\", feature: \"featureEvents\" },\r\n    { to: \"/desafios\", label: t(\"visitor.sidebar.challenges\", \"Desafios\"), icon: \"üéØ\", feature: \"featureGamification\" },\r\n    { to: \"/loja\", label: t(\"visitor.sidebar.shop\", \"Loja\"), icon: \"üõí\", feature: \"featureShop\" },\r\n    { to: \"/ranking\", label: t(\"visitor.sidebar.leaderboard\", \"Ranking\"), icon: \"üèÜ\", feature: \"featureGamification\" },\r\n    { to: \"/favoritos\", label: t(\"visitor.sidebar.favorites\", \"Favoritos\"), icon: \"‚ù§Ô∏è\", feature: \"featureReviews\" },\r\n    { to: \"/chat\", label: t(\"visitor.sidebar.aiChat\", \"Chat IA\"), icon: \"ü§ñ\", feature: \"featureChatAI\" },\r\n    { to: \"/scanner\", label: t(\"visitor.sidebar.scanner\"), icon: \"üì∏\", feature: \"featureQRCodes\" },\r\n    { to: \"/perfil\", label: t(\"visitor.sidebar.profile\"), icon: \"üë§\", feature: null }, // Always visible\r\n    { to: \"/livro-visitas\", label: t(\"visitor.sidebar.guestbook\"), icon: \"‚úçÔ∏è\", feature: \"featureGuestbook\" },\r\n  ];\r\n\r\n  // Filter links based on tenant features\r\n  const links = allLinks.filter(link => {\r\n    if (!link.feature) return true; // Always show links without feature requirement\r\n    if (!settings) return true; // Show all while loading\r\n    return (settings as any)[link.feature] !== false;\r\n  });\r\n\r\n  const renderNavLinks = (mobile = false) => (\r\n    <>\r\n      {links.map((link) => {\r\n        const isActive = location.pathname === link.to;\r\n        return (\r\n          <Link\r\n            key={link.to}\r\n            to={link.to}\r\n            onClick={() => mobile && setIsMenuOpen(false)}\r\n            className={`app-sidebar-link ${isActive ? \"active\" : \"\"}`}\r\n          >\r\n            {link.icon && <span>{link.icon}</span>}\r\n            {link.label}\r\n          </Link>\r\n        );\r\n      })}\r\n    </>\r\n  );\r\n\r\n  const themeStyles = settings ? {\r\n    \"--primary-color\": settings.primaryColor,\r\n    \"--secondary-color\": settings.secondaryColor,\r\n    fontFamily: settings.historicalFont ? \"Georgia, serif\" : \"system-ui\"\r\n  } as React.CSSProperties : {};\r\n\r\n  return (\r\n    <div id=\"visitor-layout\" className=\"layout-wrapper\" style={themeStyles}>\r\n      {showWelcome && name && email && (\r\n        <WelcomeAnimation\r\n          name={name}\r\n          email={email}\r\n          onComplete={() => setShowWelcome(false)}\r\n        />\r\n      )}\r\n\r\n      {/* Mobile Overlay */}\r\n      <div\r\n        className={`mobile-overlay ${isMenuOpen ? \"open\" : \"\"}`}\r\n        onClick={() => setIsMenuOpen(false)}\r\n      />\r\n\r\n      {/* SIDEBAR */}\r\n      <aside className={`layout-sidebar ${isMenuOpen ? \"open\" : \"\"}`}>\r\n        <div className=\"sidebar-header\">\r\n          <div className=\"app-brand\">\r\n            {settings?.logoUrl ? (\r\n              <img src={settings.logoUrl} alt=\"Logo\" className=\"app-logo-img\" style={{ width: 40, height: 40, borderRadius: \"50%\", objectFit: \"cover\" }} />\r\n            ) : (\r\n              <span className=\"app-logo\">CV</span>\r\n            )}\r\n            <div>\r\n              <div className=\"app-title\">{settings?.name || \"Cultura Viva\"}</div>\r\n              <div className=\"app-subtitle\">{t(\"visitor.home.subtitle\", \"Museus & Cidades Hist√≥ricas\")}</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <nav className=\"sidebar-content\">\r\n          <button\r\n            onClick={() => { setIsMenuOpen(false); setIsSearchOpen(true); }}\r\n            className=\"nav-item sidebar-action-btn\"\r\n            style={{ justifyContent: 'flex-start' }}\r\n          >\r\n            <span>üîç</span> {t(\"visitor.search.title\", \"Buscar\")}\r\n          </button>\r\n          <button\r\n            onClick={() => { setIsMenuOpen(false); setIsDialerOpen(true); }}\r\n            className=\"nav-item sidebar-action-btn\"\r\n            style={{ justifyContent: 'flex-start' }}\r\n          >\r\n            <span>üî¢</span> {t(\"visitor.dialer.button\", \"Digitar C√≥digo\")}\r\n          </button>\r\n\r\n          {links.map((link) => {\r\n            const isActive = location.pathname === link.to;\r\n            return (\r\n              <Link\r\n                key={link.to}\r\n                to={link.to}\r\n                onClick={() => setIsMenuOpen(false)}\r\n                className={`nav-item ${isActive ? \"active\" : \"\"}`}\r\n              >\r\n                {link.icon && <span style={{ fontSize: \"1.2rem\" }}>{link.icon}</span>}\r\n                {link.label}\r\n              </Link>\r\n            );\r\n          })}\r\n        </nav>\r\n\r\n        <div className=\"sidebar-footer\">\r\n          {deferredPrompt && (\r\n            <button\r\n              onClick={handleInstallClick}\r\n              className=\"btn btn-primary\"\r\n              style={{ width: \"100%\", marginBottom: \"0.75rem\", display: \"flex\", alignItems: \"center\", justifyContent: \"center\", gap: \"0.5rem\" }}\r\n            >\r\n              ‚¨áÔ∏è {t(\"visitor.sidebar.installApp\", \"Instalar App\")}\r\n            </button>\r\n          )}\r\n          <div style={{ marginBottom: \"1rem\", display: \"flex\", justifyContent: \"center\" }}>\r\n            <LanguageSwitcher style={{ position: \"static\" }} />\r\n          </div>\r\n          <button\r\n            onClick={() => navigate(\"/select-museum\")}\r\n            className=\"btn btn-secondary\"\r\n            style={{ width: \"100%\", marginBottom: \"0.5rem\", fontSize: \"0.9rem\" }}\r\n          >\r\n            {t(\"visitor.sidebar.changeMuseum\")}\r\n          </button>\r\n          <button\r\n            onClick={logout}\r\n            className=\"btn btn-secondary\"\r\n            style={{ width: \"100%\", color: \"#ef4444\", borderColor: \"#ef4444\", fontSize: \"0.9rem\" }}\r\n          >\r\n            {t(\"visitor.sidebar.logout\")}\r\n          </button>\r\n        </div>\r\n      </aside>\r\n\r\n      {/* MAIN CONTENT */}\r\n      <main className=\"layout-main\">\r\n        <header className=\"layout-header\">\r\n          {/* Mobile Toggle */}\r\n          <button className=\"menu-toggle\" onClick={() => setIsMenuOpen(true)}>\r\n            ‚ò∞\r\n          </button>\r\n\r\n          {/* Desktop/Mobile Common Header Items (if any, e.g. User Profile or Spacer) */}\r\n          <div style={{ marginLeft: \"auto\", display: \"flex\", alignItems: \"center\", gap: \"0.5rem\" }}>\r\n            <button\r\n              className=\"btn btn-secondary icon-btn mobile-only\"\r\n              style={{ display: 'flex' }}\r\n              onClick={() => setIsSearchOpen(true)}\r\n            >\r\n              üîç\r\n            </button>\r\n            <button\r\n              className=\"btn btn-secondary icon-btn mobile-only\"\r\n              style={{ display: 'flex' }}\r\n              onClick={() => setIsDialerOpen(true)}\r\n            >\r\n              üî¢\r\n            </button>\r\n          </div>\r\n        </header>\r\n\r\n        <div className=\"layout-content\">\r\n          <div className=\"layout-content-inner\">\r\n            {children}\r\n          </div>\r\n        </div>\r\n      </main>\r\n\r\n      <GlobalSearch isOpen={isSearchOpen} onClose={() => setIsSearchOpen(false)} />\r\n      <DialerModal isOpen={isDialerOpen} onClose={() => setIsDialerOpen(false)} />\r\n      <GlobalAudioPlayer />\r\n      {settings?.featureChatAI !== false && <AiChatWidget />}\r\n    </div>\r\n  );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\components\\AiChatWidget.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\components\\CheckoutModal.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'MapPin' is defined but never used.","line":2,"column":36,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":42},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[450,453],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[450,453],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'_' is defined but never used.","line":58,"column":63,"nodeType":null,"messageId":"unusedVar","endLine":58,"endColumn":64}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\r\nimport { X, Minus, Plus, Calendar, MapPin } from 'lucide-react';\r\nimport { api } from '../../../api/client';\r\nimport { useAuth } from '../../../modules/auth/AuthContext';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\ninterface Ticket {\r\n    id: string;\r\n    name: string;\r\n    type: string;\r\n    price: number;\r\n    quantity: number;\r\n    sold: number;\r\n}\r\n\r\ninterface CheckoutModalProps {\r\n    event: any;\r\n    tickets: Ticket[];\r\n    onClose: () => void;\r\n    onSuccess: () => void;\r\n}\r\n\r\nexport const CheckoutModal: React.FC<CheckoutModalProps> = ({ event, tickets, onClose, onSuccess }) => {\r\n    const { name, email, isAuthenticated } = useAuth();\r\n    const navigate = useNavigate();\r\n    const [quantities, setQuantities] = useState<Record<string, number>>({});\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    const totalAmount = Object.entries(quantities).reduce((acc, [ticketId, qty]) => {\r\n        const ticket = tickets.find(t => t.id === ticketId);\r\n        return acc + (qty * (Number(ticket?.price) || 0));\r\n    }, 0);\r\n\r\n    const totalItems = Object.values(quantities).reduce((a, b) => a + b, 0);\r\n\r\n    const handleUpdate = (ticketId: string, delta: number) => {\r\n        setQuantities(prev => ({\r\n            ...prev,\r\n            [ticketId]: Math.max(0, (prev[ticketId] || 0) + delta)\r\n        }));\r\n    };\r\n\r\n    const handleCheckout = async () => {\r\n        if (!isAuthenticated) {\r\n            // Save current location to return after login\r\n            localStorage.setItem('redirect_after_login', `/eventos/${event.id}`);\r\n            onClose();\r\n            navigate('/login');\r\n            return;\r\n        }\r\n\r\n        if (totalItems === 0) return;\r\n\r\n        setLoading(true);\r\n        try {\r\n            // Process each ticket type selection\r\n            // In a real app we would bundle this in one robust API call\r\n            const items = Object.entries(quantities).filter(([_, qty]) => qty > 0);\r\n\r\n            for (const [ticketId, qty] of items) {\r\n                for (let i = 0; i < qty; i++) {\r\n                    // For now, registering for logged user. \r\n                    // Future: Guest entries for extra tickets\r\n                    await api.post('/registrations', {\r\n                        eventId: event.id,\r\n                        ticketId,\r\n                        guestName: name || \"Visitante\",\r\n                        guestEmail: email || \"email@teste.com\"\r\n                    });\r\n                }\r\n            }\r\n\r\n            onSuccess();\r\n        } catch (e) {\r\n            console.error(e);\r\n            alert(\"Erro ao processar inscri√ß√£o. Tente novamente.\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fadeIn\">\r\n            <div className=\"bg-white dark:bg-gray-800 w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]\">\r\n                {/* Header */}\r\n                <div className=\"p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-gray-900\">\r\n                    <h3 className=\"font-bold text-lg text-gray-800 dark:text-gray-200\">Ingressos</h3>\r\n                    <button onClick={onClose} className=\"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full\">\r\n                        <X className=\"w-5 h-5 text-gray-500\" />\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Event Mini Info */}\r\n                <div className=\"p-4 bg-blue-50 dark:bg-blue-900/20 border-b border-blue-100 dark:border-blue-800\">\r\n                    <h4 className=\"font-bold text-blue-900 dark:text-blue-100\">{event.title}</h4>\r\n                    <p className=\"text-sm text-blue-700 dark:text-blue-300 mt-1 flex items-center gap-2\">\r\n                        <Calendar className=\"w-4 h-4\" /> {new Date(event.startDate).toLocaleDateString()}\r\n                    </p>\r\n                </div>\r\n\r\n                {/* Tickets List */}\r\n                <div className=\"p-6 overflow-y-auto flex-1 space-y-4\">\r\n                    {tickets.map(ticket => (\r\n                        <div key={ticket.id} className=\"flex justify-between items-center p-4 border border-gray-200 dark:border-gray-700 rounded-xl hover:border-blue-300 transition-colors\">\r\n                            <div>\r\n                                <p className=\"font-bold text-lg text-gray-900 dark:text-white\">{ticket.name}</p>\r\n                                <p className=\"text-gray-500 text-sm\">\r\n                                    {Number(ticket.price) > 0 ? `R$ ${Number(ticket.price).toFixed(2)}` : 'Gratuito'}\r\n                                    {ticket.quantity - ticket.sold < 10 && <span className=\"text-red-500 ml-2 text-xs font-bold\">(√öltimos!)</span>}\r\n                                </p>\r\n                            </div>\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <button\r\n                                    onClick={() => handleUpdate(ticket.id, -1)}\r\n                                    className=\"w-8 h-8 rounded border border-gray-300 flex items-center justify-center text-gray-500 hover:bg-gray-100 disabled:opacity-50\"\r\n                                    disabled={(quantities[ticket.id] || 0) <= 0}\r\n                                >\r\n                                    <Minus className=\"w-4 h-4\" />\r\n                                </button>\r\n                                <span className=\"w-6 text-center font-bold text-lg\">{quantities[ticket.id] || 0}</span>\r\n                                <button\r\n                                    onClick={() => handleUpdate(ticket.id, 1)}\r\n                                    className=\"w-8 h-8 rounded bg-blue-50 border border-blue-200 flex items-center justify-center text-blue-600 hover:bg-blue-100\"\r\n                                >\r\n                                    <Plus className=\"w-4 h-4\" />\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n\r\n                {/* Footer */}\r\n                <div className=\"p-4 border-t border-gray-100 dark:border-gray-700 bg-gray-50 dark:bg-gray-900\">\r\n                    <div className=\"flex justify-between items-center mb-4\">\r\n                        <span className=\"text-gray-500 text-sm\">Total</span>\r\n                        <span className=\"text-2xl font-bold text-gray-900 dark:text-white\">\r\n                            R$ {totalAmount.toFixed(2)}\r\n                        </span>\r\n                    </div>\r\n                    <button\r\n                        onClick={handleCheckout}\r\n                        disabled={totalItems === 0 || loading}\r\n                        className=\"w-full btn btn-primary py-4 text-lg font-bold shadow-lg shadow-blue-200 disabled:opacity-50 disabled:shadow-none\"\r\n                    >\r\n                        {loading ? 'Processando...' : `Confirmar Inscri√ß√£o (${totalItems})`}\r\n                    </button>\r\n                    {!isAuthenticated && (\r\n                        <p className=\"text-center text-xs text-gray-500 mt-2\">\r\n                            Voc√™ precisar√° fazer login para concluir.\r\n                        </p>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\components\\DialerModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\components\\EditProfileModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\components\\GlobalAudioPlayer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\components\\GlobalSearch.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\components\\GlobalSearch.tsx:46:13\n  44 |             return () => clearTimeout(timeoutId);\n  45 |         } else if (query.trim().length < 2) {\n> 46 |             setResults([]);\n     |             ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  47 |         }\n  48 |     }, [isOpen, query, tenantId]);\n  49 |","line":46,"column":13,"nodeType":null,"endLine":46,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useAuth } from \"../../auth/AuthContext\";\r\nimport { api } from \"../../../api/client\";\r\nimport \"./GlobalSearch.css\";\r\n\r\ninterface SearchResult {\r\n    id: string;\r\n    title: string;\r\n    type: \"work\" | \"artist\" | \"trail\" | \"event\";\r\n    description?: string;\r\n    url: string;\r\n}\r\n\r\ninterface GlobalSearchProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n}\r\n\r\nexport const GlobalSearch: React.FC<GlobalSearchProps> = ({ isOpen, onClose }) => {\r\n    const { t } = useTranslation();\r\n    const navigate = useNavigate();\r\n    const [query, setQuery] = useState(\"\");\r\n    const [results, setResults] = useState<SearchResult[]>([]);\r\n\r\n    const { tenantId } = useAuth();\r\n\r\n    useEffect(() => {\r\n        if (isOpen && query.trim().length >= 2 && tenantId) {\r\n            const search = async () => {\r\n                try {\r\n                    const res = await api.get(`/search`, {\r\n                        params: { q: query, tenantId }\r\n                    });\r\n                    setResults(res.data);\r\n                } catch (error) {\r\n                    console.error(\"Error searching items\", error);\r\n                }\r\n            };\r\n\r\n            // Debounce manual\r\n            const timeoutId = setTimeout(search, 300);\r\n            return () => clearTimeout(timeoutId);\r\n        } else if (query.trim().length < 2) {\r\n            setResults([]);\r\n        }\r\n    }, [isOpen, query, tenantId]);\r\n\r\n    const handleSelect = (url: string) => {\r\n        navigate(url);\r\n        onClose();\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className=\"global-search-overlay\" onClick={onClose}>\r\n            <div\r\n                className=\"global-search-container\"\r\n                onClick={(e) => e.stopPropagation()}\r\n            >\r\n                <div className=\"global-search-header\">\r\n                    <span className=\"search-icon\">üîç</span>\r\n                    <input\r\n                        type=\"text\"\r\n                        autoFocus\r\n                        placeholder={t(\"visitor.search.placeholder\", \"Busque por obras, artistas, trilhas...\")}\r\n                        value={query}\r\n                        onChange={(e) => setQuery(e.target.value)}\r\n                        className=\"search-input\"\r\n                    />\r\n                    <button onClick={onClose} className=\"close-button\">\r\n                        √ó\r\n                    </button>\r\n                </div>\r\n\r\n                <div className=\"search-results\">\r\n                    {results.length === 0 && query.trim() && (\r\n                        <p className=\"no-results\">\r\n                            {t(\"visitor.search.noResults\", \"Nenhum resultado encontrado.\")}\r\n                        </p>\r\n                    )}\r\n\r\n                    {results.map((item) => (\r\n                        <div\r\n                            key={item.id}\r\n                            onClick={() => handleSelect(item.url)}\r\n                            className=\"search-result-item\"\r\n                        >\r\n                            <div className=\"result-icon\">\r\n                                {item.type === \"work\" && \"üé®\"}\r\n                                {item.type === \"artist\" && \"üë®‚Äçüé®\"}\r\n                                {item.type === \"trail\" && \"üó∫Ô∏è\"}\r\n                                {item.type === \"event\" && \"üìÖ\"}\r\n                            </div>\r\n                            <div className=\"result-content\">\r\n                                <h4 className=\"result-title\">{item.title}</h4>\r\n                                {item.description && (\r\n                                    <p className=\"result-description\">{item.description}</p>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\components\\MuseumMap.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'indoorBounds' is assigned a value but never used.","line":64,"column":5,"nodeType":null,"messageId":"unusedVar","endLine":64,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'zoom' is assigned a value but never used.","line":68,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":68,"endColumn":16}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from \"react\";\r\nimport { MapContainer, TileLayer, Marker, Popup, useMap, ImageOverlay, Circle, Polyline } from \"react-leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport L from \"leaflet\";\r\n\r\n// Fix default icon issue in Leaflet + React\r\nimport icon from \"leaflet/dist/images/marker-icon.png\";\r\nimport iconShadow from \"leaflet/dist/images/marker-shadow.png\";\r\n\r\nconst DefaultIcon = L.icon({\r\n    iconUrl: icon,\r\n    shadowUrl: iconShadow,\r\n    iconSize: [25, 41],\r\n    iconAnchor: [12, 41]\r\n});\r\n\r\nL.Marker.prototype.options.icon = DefaultIcon;\r\n\r\ntype MapMode = \"outdoor\" | \"indoor\";\r\n\r\ninterface POI {\r\n    id: string;\r\n    title: string;\r\n    lat: number;\r\n    lng: number;\r\n    description?: string;\r\n}\r\n\r\ninterface MuseumMapProps {\r\n    outdoorCenter: [number, number]; // [lat, lng]\r\n    indoorImageUrl?: string;\r\n    indoorBounds?: [[number, number], [number, number]]; // [[lat, lng], [lat, lng]]\r\n    pois: POI[];\r\n}\r\n\r\n// Component helper to change view\r\nfunction ChangeView({ center, zoom }: { center: [number, number]; zoom: number }) {\r\n    const map = useMap();\r\n    map.setView(center, zoom);\r\n    return null;\r\n}\r\n\r\n// Haversine formula to calculate distance in km\r\nfunction calculateDistance(lat1: number, lon1: number, lat2: number, lon2: number) {\r\n    const R = 6371; // Radius of the earth in km\r\n    const dLat = deg2rad(lat2 - lat1);\r\n    const dLon = deg2rad(lon2 - lon1);\r\n    const a =\r\n        Math.sin(dLat / 2) * Math.sin(dLat / 2) +\r\n        Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *\r\n        Math.sin(dLon / 2) * Math.sin(dLon / 2);\r\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n    const d = R * c; // Distance in km\r\n    return d;\r\n}\r\n\r\nfunction deg2rad(deg: number) {\r\n    return deg * (Math.PI / 180);\r\n}\r\n\r\nexport const MuseumMap: React.FC<MuseumMapProps> = ({\r\n    outdoorCenter,\r\n    indoorImageUrl,\r\n    indoorBounds = [[0, 0], [1000, 1000]],\r\n    pois\r\n}) => {\r\n    const [mode, setMode] = useState<MapMode>(\"outdoor\");\r\n    const [zoom] = useState(15);\r\n    const [userLocation, setUserLocation] = useState<{ lat: number; lng: number; accuracy: number } | null>(null);\r\n    const [aspectRatio, setAspectRatio] = useState<number>(1);\r\n\r\n    useEffect(() => {\r\n        if (mode === \"indoor\" && indoorImageUrl) {\r\n            const img = new Image();\r\n            img.src = indoorImageUrl;\r\n            img.onload = () => {\r\n                if (img.width && img.height) {\r\n                    setAspectRatio(img.width / img.height);\r\n                }\r\n            };\r\n        }\r\n    }, [mode, indoorImageUrl]);\r\n\r\n    // Toggle mode handler removed as it was unused (buttons set mode directly)\r\n\r\n    useEffect(() => {\r\n        if (mode === \"outdoor\" && \"geolocation\" in navigator) {\r\n            navigator.geolocation.getCurrentPosition(\r\n                (position) => {\r\n                    const { latitude, longitude, accuracy } = position.coords;\r\n                    setUserLocation({ lat: latitude, lng: longitude, accuracy });\r\n                },\r\n                (error) => console.error(\"Erro ao obter localiza√ß√£o\", error),\r\n                { enableHighAccuracy: true }\r\n            );\r\n        }\r\n    }, [mode]);\r\n\r\n    // Add Polyline support\r\n    const [destinationId, setDestinationId] = useState<string | null>(null);\r\n\r\n    // Simple mocked graph/routes for demo purposes\r\n    // In a real app, this would use a graph algorithm (Dijkstra)\r\n    const getRouteTo = (destId: string): [number, number][] => {\r\n        const dest = pois.find(p => p.id === destId);\r\n        if (!dest) return [];\r\n\r\n        // Mock route: Center -> Random Point -> Destination\r\n        // Assuming starting point is \"Center\" or User Location\r\n        const start = outdoorCenter;\r\n        const midPoint: [number, number] = [\r\n            (start[0] + dest.lat) / 2,\r\n            (start[1] + dest.lng) / 2 + 0.0005 // Little curve\r\n        ];\r\n\r\n        return [start, midPoint, [dest.lat, dest.lng]];\r\n    };\r\n\r\n    return (\r\n        <div style={{\r\n            position: \"relative\",\r\n            width: \"100%\",\r\n            aspectRatio: mode === \"indoor\" ? `${aspectRatio}` : \"auto\",\r\n            height: mode === \"indoor\" ? \"auto\" : \"500px\",\r\n            borderRadius: \"1rem\",\r\n            overflow: \"hidden\",\r\n            border: \"1px solid var(--border-subtle)\"\r\n        }}>\r\n            {/* Controls */}\r\n            <div\r\n                style={{\r\n                    position: \"absolute\",\r\n                    top: \"10px\",\r\n                    right: \"10px\",\r\n                    zIndex: 1000,\r\n                    background: \"var(--bg-card)\",\r\n                    padding: \"0.5rem\",\r\n                    borderRadius: \"0.5rem\",\r\n                    boxShadow: \"0 2px 10px rgba(0,0,0,0.2)\",\r\n                    display: \"flex\",\r\n                    flexDirection: \"column\",\r\n                    gap: \"0.5rem\",\r\n                    alignItems: \"flex-end\"\r\n                }}\r\n            >\r\n                <div style={{ display: \"flex\", gap: \"0.5rem\" }}>\r\n                    <button\r\n                        onClick={() => setMode(\"outdoor\")}\r\n                        className={`btn ${mode === \"outdoor\" ? \"btn-primary\" : \"btn-secondary\"} `}\r\n                        style={{ fontSize: \"0.8rem\", padding: \"0.4rem 0.8rem\" }}\r\n                    >\r\n                        üèôÔ∏è Cidade\r\n                    </button>\r\n                    <button\r\n                        onClick={() => setMode(\"indoor\")}\r\n                        className={`btn ${mode === \"indoor\" ? \"btn-primary\" : \"btn-secondary\"} `}\r\n                        style={{ fontSize: \"0.8rem\", padding: \"0.4rem 0.8rem\" }}\r\n                    >\r\n                        üèõÔ∏è Planta\r\n                    </button>\r\n                </div>\r\n\r\n                {/* Destination Selector for Wayfinding Demo */}\r\n                {mode === \"indoor\" && pois.length > 0 && (\r\n                    <select\r\n                        className=\"input\"\r\n                        style={{ fontSize: \"0.8rem\", padding: \"0.25rem\", width: \"150px\" }}\r\n                        onChange={(e) => setDestinationId(e.target.value)}\r\n                        value={destinationId || \"\"}\r\n                    >\r\n                        <option value=\"\">üéØ Ir para...</option>\r\n                        {pois.map(p => <option key={p.id} value={p.id}>{p.title}</option>)}\r\n                    </select>\r\n                )}\r\n            </div>\r\n\r\n            <MapContainer\r\n                center={mode === \"outdoor\" ? outdoorCenter : [50, 50]}\r\n                zoom={mode === \"outdoor\" ? 15 : 1}\r\n                scrollWheelZoom={true}\r\n                style={{ width: \"100%\", height: \"100%\", borderRadius: \"1rem\" }}\r\n                crs={mode === \"outdoor\" ? L.CRS.EPSG3857 : L.CRS.Simple}\r\n            >\r\n                {mode === \"outdoor\" ? (\r\n                    <>\r\n                        <ChangeView center={outdoorCenter} zoom={15} />\r\n                        <TileLayer\r\n                            attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n                            url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\r\n                        />\r\n                        {/* Outdoor Markers */}\r\n                        <Marker position={outdoorCenter}>\r\n                            <Popup>\r\n                                <b>Museu Principal</b><br />\r\n                                Voc√™ est√° aqui.\r\n                            </Popup>\r\n                        </Marker>\r\n\r\n                        {/* User Location */}\r\n                        {userLocation && (\r\n                            <>\r\n                                <Marker position={[userLocation.lat, userLocation.lng]} icon={new L.Icon({\r\n                                    iconUrl: \"https://raw.githubusercontent.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png\",\r\n                                    shadowUrl: \"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png\",\r\n                                    iconSize: [25, 41],\r\n                                    iconAnchor: [12, 41],\r\n                                    popupAnchor: [1, -34],\r\n                                    shadowSize: [41, 41]\r\n                                })}>\r\n                                    <Popup>\r\n                                        <b>Sua Localiza√ß√£o</b><br />\r\n                                        Precis√£o: {Math.round(userLocation.accuracy)}m<br />\r\n                                        Dist√¢ncia do Museu: {calculateDistance(userLocation.lat, userLocation.lng, outdoorCenter[0], outdoorCenter[1]).toFixed(2)} km\r\n                                    </Popup>\r\n                                </Marker>\r\n                                <Circle\r\n                                    center={[userLocation.lat, userLocation.lng]}\r\n                                    radius={userLocation.accuracy}\r\n                                    pathOptions={{ color: 'blue', fillColor: 'blue', fillOpacity: 0.1 }}\r\n                                />\r\n                            </>\r\n                        )}\r\n                    </>\r\n                ) : (\r\n                    <>\r\n                        {indoorImageUrl ? (\r\n                            <ImageOverlay\r\n                                url={indoorImageUrl}\r\n                                bounds={[[0, 0], [100, 100]]}\r\n                            />\r\n                        ) : (\r\n                            <div style={{\r\n                                position: \"absolute\",\r\n                                top: \"50%\",\r\n                                left: \"50%\",\r\n                                transform: \"translate(-50%, -50%)\",\r\n                                zIndex: 1000,\r\n                                color: \"#333\",\r\n                                textAlign: \"center\"\r\n                            }}>\r\n                                <p>Imagem da planta n√£o configurada.</p>\r\n                            </div>\r\n                        )}\r\n                        {/* Indoor Markers: Filter POIs that have internal coordinates */}\r\n                        {pois.filter(p => p.lat != null && p.lng != null).map(poi => {\r\n                            // If we use 0-100 logic, poi.lat is y, poi.lng is x.\r\n                            // Ensure they are within bounds or logic matches AdminMapEditor\r\n                            return (\r\n                                <Marker key={poi.id} position={[poi.lat, poi.lng]}>\r\n                                    <Popup>\r\n                                        <b>{poi.title}</b><br />\r\n                                        {poi.description}\r\n                                        <button\r\n                                            className=\"btn btn-sm btn-primary\"\r\n                                            style={{ marginTop: \"0.5rem\", width: \"100%\" }}\r\n                                            onClick={() => setDestinationId(poi.id)}\r\n                                        >\r\n                                            Ir para c√° üèÉ\r\n                                        </button>\r\n                                    </Popup>\r\n                                </Marker>\r\n                            );\r\n                        })}\r\n\r\n                        {/* Route Line */}\r\n                        {destinationId && (\r\n                            <Polyline\r\n                                positions={getRouteTo(destinationId)}\r\n                                color=\"blue\"\r\n                                dashArray={[10, 10]}\r\n                                weight={4}\r\n                            />\r\n                        )}\r\n                    </>\r\n                )}\r\n            </MapContainer>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\components\\SettingsModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\components\\ShareCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\components\\TicketCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\components\\WelcomeAnimation.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setIsFirstTime' is assigned a value but never used.","line":14,"column":25,"nodeType":null,"messageId":"unusedVar","endLine":14,"endColumn":39}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\ninterface WelcomeAnimationProps {\r\n    name: string;\r\n    email: string;\r\n    onComplete: () => void;\r\n}\r\n\r\nexport const WelcomeAnimation: React.FC<WelcomeAnimationProps> = ({ name, email, onComplete }) => {\r\n    const { t } = useTranslation();\r\n    const [show, setShow] = useState(true);\r\n    const [isFirstTime, setIsFirstTime] = useState(() => {\r\n        const storageKey = `welcome_seen_${email}`;\r\n        const hasSeen = localStorage.getItem(storageKey);\r\n        if (!hasSeen) {\r\n            localStorage.setItem(storageKey, \"true\");\r\n            return true;\r\n        }\r\n        return false;\r\n    });\r\n\r\n    useEffect(() => {\r\n        // Timer para fechar\r\n        const timer = setTimeout(() => {\r\n            setShow(false);\r\n        }, 3500); // 3.5 segundos de exibi√ß√£o\r\n\r\n        return () => clearTimeout(timer);\r\n    }, []);\r\n\r\n    return (\r\n        <AnimatePresence onExitComplete={onComplete}>\r\n            {show && (\r\n                <motion.div\r\n                    initial={{ opacity: 0 }}\r\n                    animate={{ opacity: 1 }}\r\n                    exit={{ opacity: 0 }}\r\n                    transition={{ duration: 0.5 }}\r\n                    style={{\r\n                        position: \"fixed\",\r\n                        top: 0,\r\n                        left: 0,\r\n                        width: \"100vw\",\r\n                        height: \"100vh\",\r\n                        background: \"linear-gradient(135deg, #0f172a 0%, #1e293b 100%)\",\r\n                        display: \"flex\",\r\n                        flexDirection: \"column\",\r\n                        alignItems: \"center\",\r\n                        justifyContent: \"center\",\r\n                        zIndex: 2147483647,\r\n                        padding: \"2rem\",\r\n                        textAlign: \"center\"\r\n                    }}\r\n                >\r\n                    {/* C√≠rculos decorativos animados */}\r\n                    <motion.div\r\n                        animate={{\r\n                            scale: [1, 1.2, 1],\r\n                            opacity: [0.3, 0.5, 0.3],\r\n                        }}\r\n                        transition={{\r\n                            duration: 4,\r\n                            repeat: Infinity,\r\n                            ease: \"easeInOut\"\r\n                        }}\r\n                        style={{\r\n                            position: \"absolute\",\r\n                            width: \"300px\",\r\n                            height: \"300px\",\r\n                            borderRadius: \"50%\",\r\n                            background: \"radial-gradient(circle, rgba(56,189,248,0.2) 0%, transparent 70%)\",\r\n                            filter: \"blur(40px)\",\r\n                            zIndex: 0\r\n                        }}\r\n                    />\r\n\r\n                    <motion.div\r\n                        initial={{ y: 20, opacity: 0 }}\r\n                        animate={{ y: 0, opacity: 1 }}\r\n                        transition={{ delay: 0.3, duration: 0.8 }}\r\n                        style={{ zIndex: 1 }}\r\n                    >\r\n                        <h1 style={{\r\n                            fontSize: \"2.5rem\",\r\n                            fontWeight: \"bold\",\r\n                            color: \"#f8fafc\",\r\n                            marginBottom: \"1rem\",\r\n                            background: \"linear-gradient(to right, #38bdf8, #818cf8)\",\r\n                            WebkitBackgroundClip: \"text\",\r\n                            WebkitTextFillColor: \"transparent\"\r\n                        }}>\r\n                            {isFirstTime\r\n                                ? t(\"welcome.firstTime\", { name })\r\n                                : t(\"welcome.returning\", { name })}\r\n                        </h1>\r\n                    </motion.div>\r\n\r\n                    <motion.div\r\n                        initial={{ scale: 0.8, opacity: 0 }}\r\n                        animate={{ scale: 1, opacity: 1 }}\r\n                        transition={{ delay: 0.8, duration: 0.5 }}\r\n                        style={{ zIndex: 1 }}\r\n                    >\r\n                        <p style={{\r\n                            fontSize: \"1.2rem\",\r\n                            color: \"#94a3b8\",\r\n                            maxWidth: \"600px\",\r\n                            lineHeight: 1.6\r\n                        }}>\r\n                            {t(\"welcome.subtitle\")}\r\n                        </p>\r\n                    </motion.div>\r\n\r\n                    {/* √çcone ou Logo animado */}\r\n                    <motion.div\r\n                        initial={{ opacity: 0, y: 20 }}\r\n                        animate={{ opacity: 1, y: 0 }}\r\n                        transition={{ delay: 1.2, duration: 0.5 }}\r\n                        style={{ marginTop: \"3rem\", fontSize: \"3rem\" }}\r\n                    >\r\n                        üèõÔ∏è\r\n                    </motion.div>\r\n\r\n                </motion.div>\r\n            )}\r\n        </AnimatePresence>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\components\\WorkNote.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'useEffect' is defined but never used.","line":1,"column":27,"nodeType":null,"messageId":"unusedVar","endLine":1,"endColumn":36}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\ninterface WorkNoteProps {\r\n    workId: string;\r\n}\r\n\r\nexport const WorkNote: React.FC<WorkNoteProps> = ({ workId }) => {\r\n    const { t } = useTranslation();\r\n    const [note, setNote] = useState(() => {\r\n        const allNotes = JSON.parse(localStorage.getItem(\"visitor_notes\") || \"{}\");\r\n        return allNotes[workId] || \"\";\r\n    });\r\n    const [saved, setSaved] = useState(false);\r\n\r\n    const handleSave = () => {\r\n        const allNotes = JSON.parse(localStorage.getItem(\"visitor_notes\") || \"{}\");\r\n        if (note.trim()) {\r\n            allNotes[workId] = note;\r\n        } else {\r\n            delete allNotes[workId];\r\n        }\r\n        localStorage.setItem(\"visitor_notes\", JSON.stringify(allNotes));\r\n        setSaved(true);\r\n        setTimeout(() => setSaved(false), 2000);\r\n    };\r\n\r\n    return (\r\n        <div className=\"card\" style={{ padding: \"1rem\", marginTop: \"1rem\" }}>\r\n            <h3 className=\"card-title\" style={{ fontSize: \"1rem\", marginBottom: \"0.5rem\" }}>\r\n                üìù {t(\"visitor.work.myNotes\", \"Minhas Anota√ß√µes\")}\r\n            </h3>\r\n            <textarea\r\n                className=\"form-input\"\r\n                rows={3}\r\n                placeholder={t(\"visitor.work.notesPlaceholder\", \"Escreva o que achou desta obra...\")}\r\n                value={note}\r\n                onChange={(e) => setNote(e.target.value)}\r\n                style={{ width: \"100%\", resize: \"vertical\", marginBottom: \"0.5rem\" }}\r\n            />\r\n            <div style={{ display: \"flex\", justifyContent: \"flex-end\", alignItems: \"center\", gap: \"0.5rem\" }}>\r\n                {saved && <span style={{ color: \"green\", fontSize: \"0.8rem\" }}>Salvo!</span>}\r\n                <button className=\"btn btn-secondary\" onClick={handleSave} style={{ padding: \"0.25rem 0.75rem\", fontSize: \"0.85rem\" }}>\r\n                    {t(\"common.save\", \"Salvar\")}\r\n                </button>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\context\\AudioContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":130,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":130,"endColumn":22}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useRef, useEffect, ReactNode } from 'react';\r\n\r\ninterface AudioTrack {\r\n    title: string;\r\n    url: string;\r\n    artist?: string;\r\n    coverUrl?: string; // For album art\r\n}\r\n\r\ninterface AudioContextType {\r\n    isPlaying: boolean;\r\n    currentTrack: AudioTrack | null;\r\n    progress: number; // 0 to 100\r\n    duration: number;\r\n    currentTime: number;\r\n    isMinimized: boolean;\r\n    playTrack: (track: AudioTrack) => void;\r\n    togglePlay: () => void;\r\n    closePlayer: () => void;\r\n    setMinimized: (minimized: boolean) => void;\r\n    seek: (time: number) => void;\r\n}\r\n\r\nconst AudioContext = createContext<AudioContextType | undefined>(undefined);\r\n\r\nexport const AudioProvider: React.FC<{ children: ReactNode }> = ({ children }) => {\r\n    const audioRef = useRef<HTMLAudioElement | null>(null);\r\n    const [isPlaying, setIsPlaying] = useState(false);\r\n    const [currentTrack, setCurrentTrack] = useState<AudioTrack | null>(null);\r\n    const [progress, setProgress] = useState(0);\r\n    const [duration, setDuration] = useState(0);\r\n    const [currentTime, setCurrentTime] = useState(0);\r\n    const [isMinimized, setIsMinimized] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const audio = audioRef.current;\r\n        if (!audio) return;\r\n\r\n        const handleTimeUpdate = () => {\r\n            setCurrentTime(audio.currentTime);\r\n            if (audio.duration) {\r\n                setDuration(audio.duration);\r\n                setProgress((audio.currentTime / audio.duration) * 100);\r\n            }\r\n        };\r\n\r\n        const handleEnded = () => {\r\n            setIsPlaying(false);\r\n            setProgress(100);\r\n        };\r\n\r\n        audio.addEventListener('timeupdate', handleTimeUpdate);\r\n        audio.addEventListener('ended', handleEnded);\r\n        audio.addEventListener('loadedmetadata', handleTimeUpdate);\r\n\r\n        return () => {\r\n            audio.removeEventListener('timeupdate', handleTimeUpdate);\r\n            audio.removeEventListener('ended', handleEnded);\r\n            audio.removeEventListener('loadedmetadata', handleTimeUpdate);\r\n        };\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (currentTrack && audioRef.current) {\r\n            // Only load if different url to avoid reset on re-render if that happens (though state protects it)\r\n            if (audioRef.current.src !== currentTrack.url) {\r\n                audioRef.current.src = currentTrack.url;\r\n                audioRef.current.play().then(() => setIsPlaying(true)).catch(e => console.error(\"Auto-play blocked\", e));\r\n            }\r\n        }\r\n    }, [currentTrack]);\r\n\r\n    const playTrack = (track: AudioTrack) => {\r\n        if (currentTrack?.url === track.url) {\r\n            togglePlay();\r\n            return;\r\n        }\r\n        setCurrentTrack(track);\r\n        setIsMinimized(false);\r\n    };\r\n\r\n    const togglePlay = () => {\r\n        if (audioRef.current) {\r\n            if (isPlaying) {\r\n                audioRef.current.pause();\r\n                setIsPlaying(false);\r\n            } else {\r\n                audioRef.current.play();\r\n                setIsPlaying(true);\r\n            }\r\n        }\r\n    };\r\n\r\n    const closePlayer = () => {\r\n        if (audioRef.current) {\r\n            audioRef.current.pause();\r\n            audioRef.current.currentTime = 0;\r\n        }\r\n        setIsPlaying(false);\r\n        setCurrentTrack(null);\r\n    };\r\n\r\n    const seek = (time: number) => {\r\n        if (audioRef.current) {\r\n            audioRef.current.currentTime = time;\r\n            setCurrentTime(time);\r\n        }\r\n    }\r\n\r\n    return (\r\n        <AudioContext.Provider value={{\r\n            isPlaying,\r\n            currentTrack,\r\n            progress,\r\n            duration,\r\n            currentTime,\r\n            isMinimized,\r\n            playTrack,\r\n            togglePlay,\r\n            closePlayer,\r\n            setMinimized: setIsMinimized,\r\n            seek\r\n        }}>\r\n            {children}\r\n            <audio ref={audioRef} style={{ display: 'none' }} />\r\n        </AudioContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useAudio = () => {\r\n    const context = useContext(AudioContext);\r\n    if (!context) {\r\n        throw new Error(\"useAudio must be used within an AudioProvider\");\r\n    }\r\n    return context;\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\context\\GeoFencingProvider.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":14,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":14,"endColumn":27},{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-hooks/exhaustive-deps').","line":104,"column":9,"severity":1,"nodeType":null,"fix":{"range":[3946,4001],"text":" "}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":118,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":118,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4494,4497],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4494,4497],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":1,"source":"import React, { createContext, useContext, useEffect, useState, useRef, useCallback } from \"react\";\r\nimport { api } from \"../../../api/client\";\r\n\r\ntype GeoContextType = {\r\n    userLocation: { lat: number; lng: number } | null;\r\n    permission: \"granted\" | \"denied\" | \"prompt\";\r\n};\r\n\r\nconst GeoContext = createContext<GeoContextType>({\r\n    userLocation: null,\r\n    permission: \"prompt\",\r\n});\r\n\r\nexport const useGeoFencing = () => useContext(GeoContext);\r\n\r\n// Helper to safely get tenantId from localStorage\r\nconst getTenantIdFromStorage = (): string | null => {\r\n    try {\r\n        const stored = window.localStorage.getItem(\"museus_auth_v1\");\r\n        if (stored) {\r\n            const parsed = JSON.parse(stored);\r\n            return parsed.tenantId ?? null;\r\n        }\r\n    } catch {\r\n        // Ignore parse errors\r\n    }\r\n    return null;\r\n};\r\n\r\ntype GeoWork = {\r\n    id: string;\r\n    title: string;\r\n    latitude: number;\r\n    longitude: number;\r\n    radius?: number;\r\n    imageUrl?: string;\r\n    [key: string]: unknown; // Allow other props\r\n};\r\n\r\nexport const GeoFencingProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {\r\n    const [userLocation, setUserLocation] = useState<{ lat: number; lng: number } | null>(null);\r\n    const [permission, setPermission] = useState<\"granted\" | \"denied\" | \"prompt\">(\"prompt\");\r\n    const [works, setWorks] = useState<GeoWork[]>([]);\r\n    const [notifiedWorks, setNotifiedWorks] = useState<Set<string>>(new Set());\r\n    const [tenantId, setTenantId] = useState<string | null>(getTenantIdFromStorage);\r\n\r\n    // Refs for stale closure prevention\r\n    const worksRef = useRef(works);\r\n    const notifiedWorksRef = useRef(notifiedWorks);\r\n    const userLocationRef = useRef(userLocation);\r\n\r\n    // Sync refs\r\n    useEffect(() => { worksRef.current = works; }, [works]);\r\n    useEffect(() => { notifiedWorksRef.current = notifiedWorks; }, [notifiedWorks]);\r\n    useEffect(() => { userLocationRef.current = userLocation; }, [userLocation]);\r\n\r\n    // Helpers\r\n    const calculateDistance = (lat1: number, lon1: number, lat2: number, lon2: number) => {\r\n        const R = 6371e3; // metres\r\n        const œÜ1 = (lat1 * Math.PI) / 180;\r\n        const œÜ2 = (lat2 * Math.PI) / 180;\r\n        const ŒîœÜ = ((lat2 - lat1) * Math.PI) / 180;\r\n        const ŒîŒª = ((lon2 - lon1) * Math.PI) / 180;\r\n\r\n        const a =\r\n            Math.sin(ŒîœÜ / 2) * Math.sin(ŒîœÜ / 2) +\r\n            Math.cos(œÜ1) * Math.cos(œÜ2) * Math.sin(ŒîŒª / 2) * Math.sin(ŒîŒª / 2);\r\n        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\r\n\r\n        return R * c;\r\n    };\r\n\r\n    const triggerNotification = useCallback((work: GeoWork) => {\r\n        // Browser Notification\r\n        if (typeof Notification !== \"undefined\" && Notification.permission === \"granted\") {\r\n            new Notification(`Voc√™ est√° perto de uma obra!`, {\r\n                body: `Descubra \"${work.title}\" a poucos passos de voc√™.`,\r\n                icon: (work.imageUrl as string) || \"/icon-192x192.png\"\r\n            });\r\n        } else if (typeof Notification !== \"undefined\" && Notification.permission !== \"denied\") {\r\n            Notification.requestPermission().then((perm) => {\r\n                if (perm === \"granted\") {\r\n                    triggerNotification(work);\r\n                }\r\n            });\r\n        }\r\n\r\n        // Optional: Vibrate\r\n        if (navigator.vibrate) navigator.vibrate(200);\r\n    }, []);\r\n\r\n    const checkProximity = useCallback((lat: number, lng: number) => {\r\n        worksRef.current.forEach((work) => {\r\n            if (notifiedWorksRef.current.has(work.id)) return;\r\n\r\n            const distance = calculateDistance(lat, lng, work.latitude, work.longitude);\r\n            const radius = work.radius || 5; // meters\r\n\r\n            if (distance <= radius) {\r\n                triggerNotification(work);\r\n                setNotifiedWorks((prev) => new Set(prev).add(work.id));\r\n            }\r\n        });\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [triggerNotification]); // Deps can be minimal as we use refs\r\n\r\n    const loadWorks = useCallback(async () => {\r\n        if (!tenantId) {\r\n            setWorks([]);\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const res = await api.get(`/works?tenantId=${tenantId}`);\r\n            const worksArray = Array.isArray(res.data)\r\n                ? res.data\r\n                : (res.data?.data || res.data?.works || []);\r\n            const geoWorks = worksArray.filter((w: any): w is GeoWork => typeof w.latitude === 'number' && typeof w.longitude === 'number');\r\n            setWorks(geoWorks);\r\n        } catch (err) {\r\n            console.error(\"Failed to load works for geofencing\", err);\r\n            setWorks([]);\r\n        }\r\n    }, [tenantId]);\r\n\r\n    // Effects\r\n\r\n    // Storage listener\r\n    useEffect(() => {\r\n        const handleStorageChange = () => {\r\n            setTenantId(getTenantIdFromStorage());\r\n        };\r\n\r\n        window.addEventListener(\"storage\", handleStorageChange);\r\n        const interval = setInterval(() => {\r\n            const newTenantId = getTenantIdFromStorage();\r\n            if (newTenantId !== tenantId) {\r\n                setTenantId(newTenantId);\r\n            }\r\n        }, 1000);\r\n\r\n        return () => {\r\n            window.removeEventListener(\"storage\", handleStorageChange);\r\n            clearInterval(interval);\r\n        };\r\n    }, [tenantId]);\r\n\r\n    // Load Works\r\n    useEffect(() => {\r\n        if (tenantId) {\r\n            loadWorks();\r\n        }\r\n    }, [tenantId, loadWorks]);\r\n\r\n    // Check when works change if we have location\r\n    useEffect(() => {\r\n        if (userLocationRef.current) {\r\n            checkProximity(userLocationRef.current.lat, userLocationRef.current.lng);\r\n        }\r\n    }, [works, checkProximity]);\r\n\r\n    // Geolocation Watcher\r\n    useEffect(() => {\r\n        if (!navigator.geolocation) {\r\n            console.warn(\"Geolocation not supported\");\r\n            return;\r\n        }\r\n\r\n        const watchId = navigator.geolocation.watchPosition(\r\n            (position) => {\r\n                setPermission(\"granted\");\r\n                const { latitude, longitude } = position.coords;\r\n                setUserLocation({ lat: latitude, lng: longitude });\r\n                // Check proximity with fresh coordinates\r\n                checkProximity(latitude, longitude);\r\n            },\r\n            (error) => {\r\n                console.warn(\"Geolocation error\", error);\r\n                if (error.code === error.PERMISSION_DENIED) {\r\n                    setPermission(\"denied\");\r\n                }\r\n            },\r\n            { enableHighAccuracy: true, maximumAge: 10000, timeout: 5000 }\r\n        );\r\n\r\n        return () => navigator.geolocation.clearWatch(watchId);\r\n    }, [checkProximity]); // checkProximity is now stable (mostly) or we rely on it\r\n\r\n    return (\r\n        <GeoContext.Provider value={{ userLocation, permission }}>\r\n            {children}\r\n        </GeoContext.Provider>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\Achievements.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\ChallengesPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'CheckCircle' is defined but never used.","line":3,"column":58,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":69},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'UserProgress' is defined but never used.","line":18,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":23},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchHunts'. Either include it or remove the dependency array.","line":40,"column":8,"nodeType":"ArrayExpression","endLine":40,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [fetchHunts, tenantId]","fix":{"range":[1275,1285],"text":"[fetchHunts, tenantId]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { Target, Trophy, Map, ChevronRight, Star, Clock, CheckCircle } from 'lucide-react';\r\nimport { api } from '../../../api/client';\r\nimport { useAuth } from '../../auth/AuthContext';\r\nimport { DailyChallengeWidget, XpProgressBar } from '../../../components/gamification/ChallengeWidget';\r\nimport { MuseumPlatformer } from './MuseumPlatformer';\r\nimport { Gamepad2 } from 'lucide-react';\r\n\r\ninterface ScavengerHunt {\r\n    id: string;\r\n    title: string;\r\n    description: string | null;\r\n    xpReward: number;\r\n    _count: { steps: number };\r\n}\r\n\r\ninterface UserProgress {\r\n    currentStep: number;\r\n    completed: boolean;\r\n}\r\n\r\n/**\r\n * Visitor Challenges Page\r\n * Daily challenges and scavenger hunts\r\n */\r\nexport const ChallengesPage: React.FC = () => {\r\n    const { t } = useTranslation();\r\n    const { tenantId } = useAuth();\r\n    const [hunts, setHunts] = useState<ScavengerHunt[]>([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [userXp, setUserXp] = useState(0);\r\n    const [showGame, setShowGame] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (tenantId) {\r\n            fetchHunts();\r\n            fetchUserStats();\r\n        }\r\n    }, [tenantId]);\r\n\r\n    const fetchHunts = async () => {\r\n        try {\r\n            const res = await api.get(`/challenges/hunts?tenantId=${tenantId}`);\r\n            setHunts(res.data);\r\n        } catch (error) {\r\n            console.error('Error fetching hunts:', error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const fetchUserStats = async () => {\r\n        try {\r\n            const res = await api.get('/visitors/me');\r\n            setUserXp(res.data.xp || 0);\r\n        } catch (error) {\r\n            console.error('Error fetching user stats:', error);\r\n        }\r\n    };\r\n\r\n    const calculateLevel = (xp: number) => {\r\n        // Each level = 500 XP\r\n        return Math.floor(xp / 500) + 1;\r\n    };\r\n\r\n    return (\r\n        <div className=\"challenges-page\">\r\n            <header className=\"page-header\">\r\n                <div className=\"header-icon\">\r\n                    <Target size={32} />\r\n                </div>\r\n                <div>\r\n                    <h1>{t('visitor.challenges.title', 'Desafios')}</h1>\r\n                    <p className=\"subtitle\">\r\n                        {t('visitor.challenges.subtitle', 'Complete miss√µes e ganhe XP!')}\r\n                    </p>\r\n                </div>\r\n            </header>\r\n\r\n            {/* User XP */}\r\n            <section className=\"xp-section\">\r\n                <XpProgressBar currentXp={userXp} level={calculateLevel(userXp)} />\r\n            </section>\r\n\r\n            {/* Arcade Game Promo */}\r\n            <section className=\"section bg-gradient-to-r from-indigo-900 to-purple-900 rounded-2xl p-6 text-white relative overflow-hidden mb-8 shadow-xl border border-indigo-700\">\r\n                <div className=\"relative z-10 flex flex-col md:flex-row items-center gap-6\">\r\n                    <div className=\"bg-white/20 p-4 rounded-full\">\r\n                        <Gamepad2 size={40} className=\"text-yellow-400\" />\r\n                    </div>\r\n                    <div className=\"flex-1 text-center md:text-left\">\r\n                        <h2 className=\"text-2xl font-black text-yellow-400 italic\">ART RUN</h2>\r\n                        <p className=\"text-indigo-200 mb-4\">Jogue a nova aventura platformer! Colete moedas e ganhe XP real.</p>\r\n                        <button\r\n                            onClick={() => setShowGame(true)}\r\n                            className=\"bg-yellow-500 hover:bg-yellow-400 text-indigo-900 font-bold px-8 py-3 rounded-xl transition-transform hover:scale-105 shadow-lg shadow-yellow-500/30\"\r\n                        >\r\n                            JOGAR AGORA\r\n                        </button>\r\n                    </div>\r\n                    {/* Decor */}\r\n                    <div className=\"hidden md:block opacity-20 transform rotate-12\">\r\n                        <Trophy size={120} />\r\n                    </div>\r\n                </div>\r\n            </section>\r\n\r\n            {showGame && <MuseumPlatformer onClose={() => setShowGame(false)} />}\r\n\r\n\r\n            {/* Daily Challenge */}\r\n            <section className=\"section\">\r\n                <h2 className=\"section-title\">\r\n                    <Clock size={20} />\r\n                    {t('visitor.challenges.daily', 'Desafio do Dia')}\r\n                </h2>\r\n                <DailyChallengeWidget />\r\n            </section>\r\n\r\n            {/* Scavenger Hunts */}\r\n            <section className=\"section\">\r\n                <h2 className=\"section-title\">\r\n                    <Map size={20} />\r\n                    {t('visitor.challenges.hunts', 'Ca√ßas ao Tesouro')}\r\n                </h2>\r\n\r\n                {loading ? (\r\n                    <div className=\"loading\">Carregando...</div>\r\n                ) : hunts.length === 0 ? (\r\n                    <div className=\"empty-state\">\r\n                        <Trophy size={48} />\r\n                        <h3>Nenhuma ca√ßa ativa</h3>\r\n                        <p>Volte em breve para novas aventuras!</p>\r\n                    </div>\r\n                ) : (\r\n                    <div className=\"hunts-list\">\r\n                        {hunts.map(hunt => (\r\n                            <HuntCard key={hunt.id} hunt={hunt} />\r\n                        ))}\r\n                    </div>\r\n                )}\r\n            </section>\r\n\r\n            <style>{`\r\n                .challenges-page {\r\n                    padding: 20px;\r\n                }\r\n                \r\n                .page-header {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 16px;\r\n                    margin-bottom: 24px;\r\n                }\r\n                \r\n                .header-icon {\r\n                    width: 64px;\r\n                    height: 64px;\r\n                    border-radius: 16px;\r\n                    background: linear-gradient(135deg, #8b5cf6, #6366f1);\r\n                    display: flex;\r\n                    align-items: center;\r\n                    justify-content: center;\r\n                    color: white;\r\n                }\r\n                \r\n                .page-header h1 {\r\n                    margin: 0;\r\n                    font-size: 1.5rem;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                }\r\n                \r\n                .subtitle {\r\n                    margin: 4px 0 0;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .xp-section {\r\n                    margin-bottom: 24px;\r\n                }\r\n                \r\n                .section {\r\n                    margin-bottom: 32px;\r\n                }\r\n                \r\n                .section-title {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 8px;\r\n                    margin: 0 0 16px;\r\n                    font-size: 1.1rem;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                }\r\n                \r\n                .hunts-list {\r\n                    display: flex;\r\n                    flex-direction: column;\r\n                    gap: 12px;\r\n                }\r\n                \r\n                .loading, .empty-state {\r\n                    text-align: center;\r\n                    padding: 40px 20px;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .empty-state h3 {\r\n                    margin: 16px 0 8px;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n};\r\n\r\n// Hunt Card Component\r\nconst HuntCard: React.FC<{ hunt: ScavengerHunt }> = ({ hunt }) => {\r\n    const [starting, setStarting] = useState(false);\r\n\r\n    const handleStart = async () => {\r\n        setStarting(true);\r\n        try {\r\n            await api.post(`/challenges/hunts/${hunt.id}/start`);\r\n            // Navigate to hunt detail or show first clue\r\n            window.location.href = `/desafios/cacas/${hunt.id}`;\r\n        } catch (error) {\r\n            console.error('Error starting hunt:', error);\r\n        } finally {\r\n            setStarting(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"hunt-card\">\r\n            <div className=\"hunt-icon\">üó∫Ô∏è</div>\r\n            <div className=\"hunt-info\">\r\n                <h4>{hunt.title}</h4>\r\n                <p>{hunt.description}</p>\r\n                <div className=\"hunt-meta\">\r\n                    <span className=\"hunt-steps\">\r\n                        <Map size={14} /> {hunt._count.steps} pistas\r\n                    </span>\r\n                    <span className=\"hunt-reward\">\r\n                        <Star size={14} fill=\"#fbbf24\" /> {hunt.xpReward} XP\r\n                    </span>\r\n                </div>\r\n            </div>\r\n            <button className=\"start-btn\" onClick={handleStart} disabled={starting}>\r\n                {starting ? '...' : <ChevronRight size={20} />}\r\n            </button>\r\n\r\n            <style>{`\r\n                .hunt-card {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 16px;\r\n                    padding: 16px;\r\n                    background: var(--bg-card, #1f2937);\r\n                    border-radius: 16px;\r\n                    border: 1px solid var(--border-color, #374151);\r\n                }\r\n                \r\n                .hunt-icon {\r\n                    width: 50px;\r\n                    height: 50px;\r\n                    border-radius: 12px;\r\n                    background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(99, 102, 241, 0.2));\r\n                    display: flex;\r\n                    align-items: center;\r\n                    justify-content: center;\r\n                    font-size: 1.5rem;\r\n                }\r\n                \r\n                .hunt-info {\r\n                    flex: 1;\r\n                }\r\n                \r\n                .hunt-info h4 {\r\n                    margin: 0 0 4px;\r\n                    color: var(--fg-main, #f3f4f6);\r\n                }\r\n                \r\n                .hunt-info p {\r\n                    margin: 0 0 8px;\r\n                    font-size: 0.85rem;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .hunt-meta {\r\n                    display: flex;\r\n                    gap: 16px;\r\n                }\r\n                \r\n                .hunt-steps, .hunt-reward {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 4px;\r\n                    font-size: 0.8rem;\r\n                    color: var(--fg-muted, #9ca3af);\r\n                }\r\n                \r\n                .hunt-reward {\r\n                    color: #fbbf24;\r\n                }\r\n                \r\n                .start-btn {\r\n                    width: 44px;\r\n                    height: 44px;\r\n                    border-radius: 50%;\r\n                    background: linear-gradient(135deg, #8b5cf6, #6366f1);\r\n                    border: none;\r\n                    color: white;\r\n                    cursor: pointer;\r\n                    display: flex;\r\n                    align-items: center;\r\n                    justify-content: center;\r\n                }\r\n            `}</style>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\ChatAI.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\EventDetail.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Globe' is defined but never used.","line":7,"column":21,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":26},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TicketIcon' is defined but never used.","line":7,"column":46,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":56},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Clock' is defined but never used.","line":8,"column":29,"nodeType":null,"messageId":"unusedVar","endLine":8,"endColumn":34},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'t' is assigned a value but never used.","line":58,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":58,"endColumn":12},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":66,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":66,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1597,1600],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1597,1600],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'ticketQuantity' is assigned a value but never used.","line":71,"column":10,"nodeType":null,"messageId":"unusedVar","endLine":71,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setTicketQuantity' is assigned a value but never used.","line":71,"column":26,"nodeType":null,"messageId":"unusedVar","endLine":71,"endColumn":43},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":72,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1880,1883],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1880,1883],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'setSubmitting' is assigned a value but never used.","line":73,"column":22,"nodeType":null,"messageId":"unusedVar","endLine":73,"endColumn":35},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\EventDetail.tsx:78:7\n  76 |   useEffect(() => {\n  77 |     if (isDemoMode) {\n> 78 |       setEvent({\n     |       ^^^^^^^^ Avoid calling setState() directly within an effect\n  79 |         id: \"1\", title: \"Oficina de Aquarela\",\n  80 |         description: \"Aprenda t√©cnicas. Lorem ipsum dolor sit amet...\",\n  81 |         location: \"Atelier 1\", startDate: new Date().toISOString(),","line":78,"column":7,"nodeType":null,"endLine":78,"endColumn":15},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":99,"column":89,"nodeType":null,"messageId":"unusedVar","endLine":99,"endColumn":90},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'e' is defined but never used.","line":102,"column":79,"nodeType":null,"messageId":"unusedVar","endLine":102,"endColumn":80}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from \"react\";\nimport { useParams, Link } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport { Helmet } from \"react-helmet-async\";\nimport { api, isDemoMode } from \"../../../api/client\";\nimport {\n  MapPin, Calendar, Globe, Share2, Ticket as TicketIcon,\n  User, CheckCircle, Video, Clock\n} from \"lucide-react\";\n\ntype Ticket = {\n  id: string;\n  name: string;\n  type: 'FREE' | 'PAID';\n  price: number;\n  quantity: number;\n  sold: number;\n};\n\ntype FormField = {\n  id: string;\n  label: string;\n  type: 'text' | 'textarea' | 'select' | 'checkbox';\n  required: boolean;\n  options?: string[];\n};\n\ntype EventDetail = {\n  id: string;\n  title: string;\n  description?: string;\n  location?: string;\n  startDate: string;\n  endDate?: string;\n\n  // New Fields\n  coverImageUrl?: string;\n  producerName?: string;\n  producerDescription?: string;\n  producerLogoUrl?: string;\n  isOnline: boolean;\n  meetingLink?: string;\n  platform?: string;\n\n  address?: string;\n  number?: string;\n  city?: string;\n  state?: string;\n\n  // Sympla Killer Features\n  customFormSchema?: FormField[];\n  galleryUrls?: string[];\n\n  tenant?: { name: string };\n};\n\nexport const EventDetail: React.FC = () => {\n  const { t, i18n } = useTranslation();\n  const { id } = useParams<{ id: string }>();\n  // Navigation\n  // const navigate = useNavigate(); // IF needed\n\n  const [event, setEvent] = useState<EventDetail | null>(null);\n  const [tickets, setTickets] = useState<Ticket[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [attendance, setAttendance] = useState<any>(null);\n\n  // Checkout State\n  const [isCheckoutOpen, setIsCheckoutOpen] = useState(false);\n  const [selectedTicketId, setSelectedTicketId] = useState<string>(\"\");\n  const [ticketQuantity, setTicketQuantity] = useState(1);\n  const [answers, setAnswers] = useState<Record<string, any>>({});\n  const [submitting, setSubmitting] = useState(false);\n\n  // Demo Fallback\n  useEffect(() => {\n    if (isDemoMode) {\n      setEvent({\n        id: \"1\", title: \"Oficina de Aquarela\",\n        description: \"Aprenda t√©cnicas. Lorem ipsum dolor sit amet...\",\n        location: \"Atelier 1\", startDate: new Date().toISOString(),\n        isOnline: false, coverImageUrl: \"https://images.unsplash.com/photo-1513364776144-60967b0f800f\"\n      });\n      setLoading(false);\n      return;\n    }\n\n    if (id) {\n      setLoading(true);\n      Promise.all([\n        api.get(`/events/${id}`),\n        api.get(`/events/${id}/tickets`).catch(() => ({ data: [] })),\n        api.get(`/events/${id}/my-attendance`).catch(() => ({ data: { attended: false } }))\n      ]).then(([evRes, tickRes, attRes]) => {\n        const evData = evRes.data;\n\n        // Parse JSON fields if they come as strings (safe check)\n        if (typeof evData.customFormSchema === 'string') {\n          try { evData.customFormSchema = JSON.parse(evData.customFormSchema); } catch (e) { evData.customFormSchema = []; }\n        }\n        if (typeof evData.galleryUrls === 'string') {\n          try { evData.galleryUrls = JSON.parse(evData.galleryUrls); } catch (e) { evData.galleryUrls = []; }\n        }\n\n        setEvent(evData);\n        setTickets(tickRes.data);\n        if (attRes.data?.attended) setAttendance(attRes.data.attendance);\n      }).finally(() => setLoading(false));\n    }\n  }, [id]);\n\n  if (loading) return <div className=\"p-8 text-center animate-pulse\">Carregando detalhes...</div>;\n  if (!event) return <div className=\"p-8 text-center\">Evento n√£o encontrado</div>;\n\n\n\n  const formatDate = (d: string) => new Date(d).toLocaleDateString(i18n.language, {\n    weekday: 'long', day: 'numeric', month: 'long', hour: '2-digit', minute: '2-digit'\n  });\n\n  return (\n    <div className=\"pb-24\">\n      <Helmet>\n        <title>{event.title} | Museus</title>\n        <meta name=\"description\" content={event.description?.substring(0, 150)} />\n        {/* Open Graph / Facebook / WhatsApp */}\n        <meta property=\"og:type\" content=\"website\" />\n        <meta property=\"og:title\" content={`Evento: ${event.title}`} />\n        <meta property=\"og:description\" content={event.description?.substring(0, 150)} />\n        <meta property=\"og:image\" content={event.coverImageUrl} />\n        <meta property=\"og:url\" content={window.location.href} />\n      </Helmet>\n\n      {/* Cover Image Parallax */}\n      <div className=\"relative h-64 md:h-80 w-full overflow-hidden bg-gray-900\">\n        <img\n          src={event.coverImageUrl || \"https://images.unsplash.com/photo-1540575467063-178a50c2df87\"}\n          className=\"w-full h-full object-cover opacity-80\"\n          alt={event.title}\n        />\n        <div className=\"absolute inset-0 bg-gradient-to-t from-gray-900 via-transparent to-transparent\"></div>\n        <Link to=\"/eventos\" className=\"absolute top-4 left-4 p-2 bg-black/30 rounded-full text-white backdrop-blur-sm hover:bg-black/50 transition-all\">\n          ‚Üê Voltar\n        </Link>\n      </div>\n\n      <div className=\"max-w-4xl mx-auto px-4 -mt-20 relative z-10\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-6 md:p-8 border border-gray-100 dark:border-gray-700\">\n          {/* Header Info */}\n          <div className=\"flex flex-col md:flex-row justify-between gap-6 mb-8\">\n            <div>\n              <span className={`inline-block px-3 py-1 rounded-full text-xs font-bold mb-3 ${event.isOnline ? 'bg-purple-100 text-purple-700' : 'bg-blue-100 text-blue-700'}`}>\n                {event.isOnline ? \"Evento Online\" : \"Presencial\"}\n              </span>\n              <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-2\">{event.title}</h1>\n              {event.producerName && (\n                <p className=\"text-gray-500 text-sm flex items-center gap-1\">\n                  Organizado por <strong className=\"text-gray-700 dark:text-gray-300\">{event.producerName}</strong>\n                </p>\n              )}\n            </div>\n\n            <div className=\"flex flex-col gap-3 min-w-[200px]\">\n              <div className=\"p-4 bg-gray-50 dark:bg-gray-900 rounded-xl flex items-start gap-3\">\n                <Calendar className=\"w-5 h-5 text-blue-600 mt-1\" />\n                <div>\n                  <p className=\"font-bold text-gray-800 dark:text-gray-200\">Data e Hora</p>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400 capitalize\">{formatDate(event.startDate)}</p>\n                </div>\n              </div>\n\n              {/* Photo Gallery (Sympla Killer) */}\n              {event.galleryUrls && event.galleryUrls.length > 0 && (\n                <div className=\"space-y-4\">\n                  <h3 className=\"section-title text-xl\">Galeria</h3>\n                  <div className=\"grid grid-cols-2 md:grid-cols-3 gap-2\">\n                    {event.galleryUrls.map((url, idx) => (\n                      <div key={idx} className=\"aspect-square rounded-lg overflow-hidden bg-gray-100 cursor-pointer hover:opacity-90 transition-opacity\">\n                        <img src={url} alt={`Galeria ${idx}`} className=\"w-full h-full object-cover\" />\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n\n          <div className=\"grid md:grid-cols-3 gap-8\">\n            <div className=\"md:col-span-2 space-y-8\">\n              {/* Description */}\n              <div className=\"prose dark:prose-invert max-w-none\">\n                <h3 className=\"section-title text-xl mb-4\">Sobre o Evento</h3>\n                <div className=\"whitespace-pre-line text-gray-600 dark:text-gray-300\">\n                  {event.description || \"Sem descri√ß√£o.\"}\n                </div>\n              </div>\n\n              {/* Producer */}\n              {event.producerDescription && (\n                <div className=\"bg-gray-50 dark:bg-gray-700/30 p-6 rounded-xl border border-gray-100\">\n                  <h3 className=\"font-bold text-lg mb-2 flex items-center gap-2\">\n                    <User className=\"w-5 h-5 text-gray-500\" /> Sobre o Produtor\n                  </h3>\n                  <p className=\"text-gray-600 dark:text-gray-400 text-sm\">{event.producerDescription}</p>\n                </div>\n              )}\n            </div>\n\n            <div className=\"space-y-6\">\n              {/* Location / Map */}\n              <div className=\"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-5 shadow-sm\">\n                <h3 className=\"font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2\">\n                  {event.isOnline ? <Video className=\"w-5 h-5\" /> : <MapPin className=\"w-5 h-5\" />}\n                  {event.isOnline ? \"Onde assistir\" : \"Localiza√ß√£o\"}\n                </h3>\n\n                {event.isOnline ? (\n                  <div className=\"text-sm text-gray-600\">\n                    <p className=\"mb-2\"><strong>Plataforma:</strong> {event.platform || \"Zoom/Meet\"}</p>\n                    {attendance ? (\n                      <a href={event.meetingLink} target=\"_blank\" className=\"btn btn-primary w-full text-center block\">\n                        Acessar Transmiss√£o\n                      </a>\n                    ) : (\n                      <div className=\"p-3 bg-yellow-50 text-yellow-800 rounded border border-yellow-200 text-xs text-center\">\n                        Link dispon√≠vel ap√≥s inscri√ß√£o\n                      </div>\n                    )}\n                  </div>\n                ) : (\n                  <div className=\"text-sm space-y-2\">\n                    <p className=\"font-medium text-gray-800\">{event.location}</p>\n                    {event.address && <p className=\"text-gray-500\">{event.address}, {event.number}</p>}\n                    {event.city && <p className=\"text-gray-500\">{event.city} - {event.state}</p>}\n\n                    {/* Static Map Placeholder - In real app use Google Maps Embed */}\n                    <div className=\"w-full h-32 bg-gray-200 rounded mt-4 flex items-center justify-center text-gray-400 text-xs\">\n                      Mapa Indispon√≠vel (Demo)\n                    </div>\n                  </div>\n                )}\n              </div>\n\n              {/* Share */}\n              <button className=\"w-full py-3 border border-gray-200 rounded-xl flex items-center justify-center gap-2 hover:bg-gray-50 transition-colors font-medium text-gray-700\">\n                <Share2 className=\"w-4 h-4\" /> Compartilhar Evento\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Sticky Bottom Bar for Mobile / CTA */}\n      <div className=\"fixed bottom-0 left-0 right-0 p-4 bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-800 shadow-lg z-50 md:sticky md:bottom-4 md:mx-auto md:max-w-4xl md:rounded-2xl md:mb-4\">\n        <div className=\"flex items-center justify-between max-w-4xl mx-auto\">\n          <div className=\"hidden md:block\">\n            <p className=\"text-xs text-gray-500 uppercase font-bold tracking-wider\">Ingressos a partir de</p>\n            <p className=\"text-xl font-bold text-green-600\">\n              {tickets.length > 0 ? (Math.min(...tickets.map(t => Number(t.price))) === 0 ? 'Gr√°tis' : `R$ ${Math.min(...tickets.map(t => Number(t.price)))}`) : 'Indispon√≠vel'}\n            </p>\n          </div>\n\n          {attendance ? (\n            <div className=\"flex-1 md:flex-none flex gap-3\">\n              <div className=\"flex-1 bg-green-50 text-green-700 px-4 py-3 rounded-xl font-bold flex items-center justify-center gap-2 border border-green-200\">\n                <CheckCircle className=\"w-5 h-5\" /> Inscrito\n              </div>\n              {/* If event ended, show Download Button logic here */}\n            </div>\n          ) : (\n            <button\n              onClick={() => setIsCheckoutOpen(true)}\n              className=\"flex-1 md:flex-none bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-blue-200 transition-all transform hover:scale-105\"\n            >\n              Garantir Ingressos\n            </button>\n          )}\n        </div>\n      </div>\n\n      {/* Checkout Modal */}\n      {isCheckoutOpen && (\n        <div className=\"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-fadeIn\">\n          <div className=\"bg-white dark:bg-gray-900 w-full max-w-lg rounded-2xl shadow-2xl overflow-hidden max-h-[90vh] flex flex-col\">\n            <div className=\"p-4 border-b border-gray-100 dark:border-gray-800 flex justify-between items-center bg-gray-50 dark:bg-gray-800/50\">\n              <h3 className=\"font-bold text-lg\">Realizar Inscri√ß√£o</h3>\n              <button onClick={() => setIsCheckoutOpen(false)} className=\"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300\">‚úï</button>\n            </div>\n\n            <div className=\"p-6 overflow-y-auto flex-1 space-y-6\">\n              {/* Ticket Selection */}\n              <div>\n                <label className=\"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2\">Selecione o Ingresso</label>\n                <div className=\"space-y-2\">\n                  {tickets.map(t => (\n                    <label key={t.id} className={`flex items-center justify-between p-3 rounded-lg border cursor-pointer transition-all ${selectedTicketId === t.id ? 'border-blue-500 bg-blue-50 dark:bg-blue-900/20' : 'border-gray-200 dark:border-gray-700'}`}>\n                      <div className=\"flex items-center gap-3\">\n                        <input\n                          type=\"radio\"\n                          name=\"ticket\"\n                          value={t.id}\n                          checked={selectedTicketId === t.id}\n                          onChange={() => setSelectedTicketId(t.id)}\n                          className=\"w-4 h-4 text-blue-600\"\n                        />\n                        <div>\n                          <p className=\"font-medium text-gray-900 dark:text-white\">{t.name}</p>\n                          <p className=\"text-xs text-gray-500\">{t.quantity - t.sold} dispon√≠veis</p>\n                        </div>\n                      </div>\n                      <div className=\"font-bold text-green-600\">\n                        {Number(t.price) === 0 ? \"Gr√°tis\" : `R$ ${Number(t.price)}`}\n                      </div>\n                    </label>\n                  ))}\n                </div>\n              </div>\n\n              {/* Dynamic Form Questions */}\n              {event?.customFormSchema && event.customFormSchema.length > 0 && (\n                <div className=\"space-y-4 pt-4 border-t border-gray-100 dark:border-gray-800\">\n                  <h4 className=\"font-bold text-gray-800 dark:text-gray-200\">Perguntas do Organizador</h4>\n                  {event.customFormSchema.map((field, idx) => (\n                    <div key={idx} className=\"form-group\">\n                      <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                        {field.label} {field.required && <span className=\"text-red-500\">*</span>}\n                      </label>\n\n                      {field.type === 'textarea' ? (\n                        <textarea\n                          className=\"w-full p-2 rounded border border-gray-300 dark:border-gray-600 bg-transparent\"\n                          rows={3}\n                          value={answers[field.label] || ''}\n                          onChange={e => setAnswers({ ...answers, [field.label]: e.target.value })}\n                        />\n                      ) : field.type === 'select' ? (\n                        <select\n                          className=\"w-full p-2 rounded border border-gray-300 dark:border-gray-600 bg-transparent\"\n                          value={answers[field.label] || ''}\n                          onChange={e => setAnswers({ ...answers, [field.label]: e.target.value })}\n                        >\n                          <option value=\"\">Selecione...</option>\n                          {field.options?.map((opt, i) => <option key={i} value={opt}>{opt}</option>)}\n                        </select>\n                      ) : (\n                        <input\n                          type={field.type === 'text' ? 'text' : 'text'}\n                          className=\"w-full p-2 rounded border border-gray-300 dark:border-gray-600 bg-transparent\"\n                          value={answers[field.label] || ''}\n                          onChange={e => setAnswers({ ...answers, [field.label]: e.target.value })}\n                        />\n                      )}\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n\n            <div className=\"p-4 border-t border-gray-100 dark:border-gray-800 bg-gray-50 dark:bg-gray-800/50 flex justify-end gap-2\">\n              <button\n                onClick={() => setIsCheckoutOpen(false)}\n                className=\"px-4 py-2 rounded text-gray-600 hover:bg-gray-200 transition-colors\"\n              >\n                Cancelar\n              </button>\n              <button\n                onClick={handleRegister}\n                disabled={submitting}\n                className=\"px-6 py-2 rounded bg-blue-600 hover:bg-blue-700 text-white font-bold shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2\"\n              >\n                {submitting ? \"Processando...\" : \"Confirmar Inscri√ß√£o\"}\n                {!submitting && <CheckCircle className=\"w-4 h-4\" />}\n              </button>\n            </div>\n          </div>\n        </div>\n      )\n      }\n    </div >\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\EventsList.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'EventItem' is defined but never used.","line":7,"column":6,"nodeType":null,"messageId":"unusedVar","endLine":7,"endColumn":15},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\EventsList.tsx:32:5\n  30 |     if (!tenantId) return;\n  31 |\n> 32 |     setLoading(true);\n     |     ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  33 |     api\n  34 |       .get(\"/events\", { params: { tenantId } })\n  35 |       .then((res) => {","line":32,"column":5,"nodeType":null,"endLine":32,"endColumn":15}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":37,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[944,947],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[944,947],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport { api } from \"../../../api/client\";\nimport { useAuth } from \"../../auth/AuthContext\";\n\ntype EventItem = {\n  id: string;\n  title: string;\n  date?: string;\n  time?: string;\n  location?: string;\n};\n\nexport const EventsList: React.FC = () => {\n  const { t } = useTranslation();\n  type EventItem = {\n    id: string;\n    title: string;\n    date?: string;\n    time?: string;\n    location?: string;\n  };\n\n  const [events, setEvents] = useState<EventItem[]>([]);\n  const [loading, setLoading] = useState(true);\n  const { tenantId } = useAuth();\n\n  useEffect(() => {\n    if (!tenantId) return;\n\n    setLoading(true);\n    api\n      .get(\"/events\", { params: { tenantId } })\n      .then((res) => {\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        const apiEvents = (res.data as any[]).map((e) => ({\n          id: e.id,\n          title: e.title,\n          date: e.startDate ? new Date(e.startDate).toLocaleDateString() : \"\",\n          time: e.startDate ? new Date(e.startDate).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }) : \"\",\n          location: e.location ?? \"\"\n        }));\n        setEvents(apiEvents);\n      })\n      .catch(() => {\n        console.error(\"Failed to fetch events\");\n      })\n      .finally(() => setLoading(false));\n  }, [tenantId]);\n\n  return (\n    <div>\n      <h1 className=\"section-title\">{t(\"visitor.events.title\")}</h1>\n      <p className=\"section-subtitle\">\n        {t(\"visitor.events.subtitle\")}\n      </p>\n\n      {loading ? (\n        <div className=\"card-grid\">\n          {[1, 2].map(i => (\n            <div key={i} className=\"card\" style={{ height: \"150px\", animation: \"pulse 1.5s infinite\", background: \"rgba(255,255,255,0.05)\" }}></div>\n          ))}\n        </div>\n      ) : events.length === 0 ? (\n        <div className=\"card\" style={{ textAlign: \"center\", padding: \"3rem\" }}>\n          <div style={{ fontSize: \"3rem\", marginBottom: \"1rem\" }}>üìÖ</div>\n          <h3>{t(\"visitor.events.emptyTitle\", \"Nenhum evento agendado\")}</h3>\n          <p style={{ color: \"#9ca3af\" }}>{t(\"visitor.events.emptyDesc\", \"Fique de olho! Em breve teremos novos eventos e workshops.\")}</p>\n        </div>\n      ) : (\n        <div className=\"card-grid\">\n          {events.map(ev => (\n            <Link key={ev.id} to={`/eventos/${ev.id}`} style={{ textDecoration: \"none\" }}>\n              <article className=\"card\">\n                <h2 className=\"card-title\">{ev.title}</h2>\n                <p className=\"card-subtitle\">\n                  {ev.date} ‚Ä¢ {ev.time}\n                </p>\n                <p style={{ fontSize: \"0.85rem\", color: \"#e5e7eb\" }}>{t(\"visitor.events.location\")}: {ev.location}</p>\n              </article>\n            </Link>\n          ))}\n        </div>\n      )}\n      <style>{`\n        @keyframes pulse {\n          0% { opacity: 0.6; }\n          50% { opacity: 0.3; }\n          100% { opacity: 0.6; }\n        }\n      `}</style>\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\Favorites.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\GuestbookPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'name' is assigned a value but never used.","line":19,"column":40,"nodeType":null,"messageId":"unusedVar","endLine":19,"endColumn":44},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchEntries'. Either include it or remove the dependency array.","line":27,"column":8,"nodeType":"ArrayExpression","endLine":27,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [fetchEntries, tenantId]","fix":{"range":[872,882],"text":"[fetchEntries, tenantId]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { api } from \"../../../api/client\";\r\nimport { useAuth } from \"../../auth/AuthContext\";\r\nimport { getFullUrl } from \"../../../utils/url\";\r\n\r\ntype GuestbookEntry = {\r\n    id: string;\r\n    message: string;\r\n    visitor: {\r\n        name: string | null;\r\n        photoUrl: string | null;\r\n    };\r\n    createdAt: string;\r\n};\r\n\r\nexport const GuestbookPage: React.FC = () => {\r\n    const { t } = useTranslation();\r\n    const { tenantId, isAuthenticated, name, email } = useAuth();\r\n    const [entries, setEntries] = useState<GuestbookEntry[]>([]);\r\n    const [newMessage, setNewMessage] = useState(\"\");\r\n    const [loading, setLoading] = useState(false);\r\n    const [submitting, setSubmitting] = useState(false);\r\n\r\n    useEffect(() => {\r\n        fetchEntries();\r\n    }, [tenantId]);\r\n\r\n    const fetchEntries = async () => {\r\n        if (!tenantId) return;\r\n        setLoading(true);\r\n        try {\r\n            const res = await api.get(`/guestbook?tenantId=${tenantId}`);\r\n            setEntries(res.data);\r\n        } catch (error) {\r\n            console.error(\"Failed to fetch guestbook\", error);\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!newMessage.trim() || !tenantId) return;\r\n\r\n        setSubmitting(true);\r\n        try {\r\n            await api.post(\"/guestbook\", {\r\n                message: newMessage,\r\n                tenantId,\r\n                email: email\r\n            });\r\n\r\n            setNewMessage(\"\");\r\n            fetchEntries();\r\n        } catch (error) {\r\n            console.error(\"Failed to post message\", error);\r\n            alert(t(\"visitor.guestbook.error\", \"Erro ao enviar mensagem.\"));\r\n        } finally {\r\n            setSubmitting(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div style={{ maxWidth: \"800px\", margin: \"0 auto\", padding: \"1rem\" }}>\r\n            <h1 className=\"section-title\">{t(\"visitor.guestbook.title\", \"Livro de Visitas\")}</h1>\r\n            <p className=\"section-subtitle\" style={{ marginBottom: \"2rem\" }}>\r\n                {t(\"visitor.guestbook.subtitle\", \"Deixe sua marca no museu! Compartilhe sua experi√™ncia.\")}\r\n            </p>\r\n\r\n            {/* Form */}\r\n            {isAuthenticated ? (\r\n                <div className=\"card\" style={{ padding: \"1.5rem\", marginBottom: \"2rem\" }}>\r\n                    <form onSubmit={handleSubmit}>\r\n                        <textarea\r\n                            className=\"input\"\r\n                            value={newMessage}\r\n                            onChange={(e) => setNewMessage(e.target.value)}\r\n                            placeholder={t(\"visitor.guestbook.placeholder\", \"Escreva sua mensagem aqui...\")}\r\n                            rows={3}\r\n                            style={{ resize: \"vertical\", marginBottom: \"1rem\" }}\r\n                            maxLength={500}\r\n                            required\r\n                        />\r\n                        <div style={{ display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\r\n                            <span style={{ fontSize: \"0.8rem\", color: \"#9ca3af\" }}>\r\n                                {newMessage.length}/500\r\n                            </span>\r\n                            <button\r\n                                type=\"submit\"\r\n                                className=\"btn btn-primary\"\r\n                                disabled={submitting || !newMessage.trim()}\r\n                            >\r\n                                {submitting ? t(\"common.sending\", \"Enviando...\") : t(\"visitor.guestbook.submit\", \"Assinar Livro\")}\r\n                            </button>\r\n                        </div>\r\n                    </form>\r\n                </div>\r\n            ) : (\r\n                <div className=\"card\" style={{ padding: \"1.5rem\", marginBottom: \"2rem\", textAlign: \"center\" }}>\r\n                    <p>{t(\"visitor.guestbook.loginRequired\", \"Fa√ßa login para deixar uma mensagem.\")}</p>\r\n                    <button\r\n                        onClick={() => window.location.href = \"/login\"}\r\n                        className=\"btn btn-secondary\"\r\n                        style={{ marginTop: \"1rem\" }}\r\n                    >\r\n                        {t(\"auth.login\")}\r\n                    </button>\r\n                </div>\r\n            )}\r\n\r\n            {/* List */}\r\n            <div style={{ display: \"flex\", flexDirection: \"column\", gap: \"1rem\" }}>\r\n                {loading ? (\r\n                    <div style={{ padding: \"2rem\", display: \"flex\", flexDirection: \"column\", gap: \"1rem\", alignItems: \"center\" }}>\r\n                        <div className=\"spinner\" style={{ width: \"30px\", height: \"30px\", border: \"3px solid rgba(255,255,255,0.1)\", borderTopColor: \"var(--primary-color)\", borderRadius: \"50%\", animation: \"spin 1s linear infinite\" }}></div>\r\n                        <style>{`@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }`}</style>\r\n                    </div>\r\n                ) : entries.length === 0 ? (\r\n                    <p style={{ textAlign: \"center\", color: \"#9ca3af\" }}>\r\n                        {t(\"visitor.guestbook.empty\", \"Seja o primeiro a assinar!\")}\r\n                    </p>\r\n                ) : (\r\n                    entries.map((entry) => (\r\n                        <article key={entry.id} className=\"card\" style={{ padding: \"1.5rem\" }}>\r\n                            <p style={{ fontSize: \"1.1rem\", lineHeight: 1.6, marginBottom: \"1rem\", fontStyle: \"italic\" }}>\r\n                                \"{entry.message}\"\r\n                            </p>\r\n                            <div style={{ display: \"flex\", alignItems: \"center\", gap: \"0.75rem\" }}>\r\n                                <div\r\n                                    style={{\r\n                                        width: \"2.5rem\",\r\n                                        height: \"2.5rem\",\r\n                                        borderRadius: \"50%\",\r\n                                        backgroundColor: \"#374151\",\r\n                                        display: \"flex\",\r\n                                        alignItems: \"center\",\r\n                                        justifyContent: \"center\",\r\n                                        fontSize: \"1.2rem\",\r\n                                        overflow: \"hidden\"\r\n                                    }}\r\n                                >\r\n                                    {entry.visitor.photoUrl ? (\r\n                                        <img src={getFullUrl(entry.visitor.photoUrl) ?? undefined} alt={entry.visitor.name || \"Visitor\"} style={{ width: \"100%\", height: \"100%\", objectFit: \"cover\" }} />\r\n                                    ) : (\r\n                                        \"üë§\"\r\n                                    )}\r\n                                </div>\r\n                                <div>\r\n                                    <div style={{ fontWeight: \"bold\", fontSize: \"0.9rem\" }}>\r\n                                        {entry.visitor.name || t(\"common.anonymous\")}\r\n                                    </div>\r\n                                    <div style={{ fontSize: \"0.8rem\", color: \"#9ca3af\" }}>\r\n                                        {new Date(entry.createdAt).toLocaleDateString()}\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </article>\r\n                    ))\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\Home.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":54,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":57,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[502,505],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[502,505],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[569,572],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[569,572],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { useTranslation } from \"react-i18next\";\nimport { useAuth } from \"../../auth/AuthContext\";\nimport { api } from \"../../../api/client\";\nimport { getFullUrl } from \"../../../utils/url\";\n\nexport const Home: React.FC = () => {\n  const { t } = useTranslation();\n  const { name, tenantId, role } = useAuth();\n  const navigate = useNavigate();\n  const [featuredWorks, setFeaturedWorks] = useState<any[]>([]);\n  const [featuredTrails, setFeaturedTrails] = useState<any[]>([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    if (role === \"master\") {\n      navigate(\"/master\", { replace: true });\n      return;\n    }\n    if (role === \"admin\") {\n      navigate(\"/admin\", { replace: true });\n      return;\n    }\n  }, [role, navigate]);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        setLoading(true);\n        const [worksRes, trailsRes] = await Promise.all([\n          api.get(`/works?tenantId=${tenantId}&limit=3`),\n          api.get(`/trails?tenantId=${tenantId}&limit=2`)\n        ]);\n        // API returns { data: works[], pagination: {} }\n        setFeaturedWorks(Array.isArray(worksRes.data) ? worksRes.data : (worksRes.data.data || []));\n        setFeaturedTrails(Array.isArray(trailsRes.data) ? trailsRes.data : (trailsRes.data.data || trailsRes.data || []));\n      } catch (err) {\n        console.error(\"Error fetching home data\", err);\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    if (tenantId) {\n      fetchData();\n    }\n  }, [tenantId]);\n\n  return (\n    <div style={{ maxWidth: '1200px' }}> {/* Limit width for readability but align left via layout */}\n\n      {/* HERO SECTION - Premium Gold */}\n      <section style={{\n        marginBottom: \"3rem\",\n        paddingBottom: \"2rem\",\n        borderBottom: \"1px solid var(--border-color)\"\n      }}>\n        <div style={{\n          display: \"inline-block\",\n          padding: \"0.25rem 0.75rem\",\n          borderRadius: \"99px\",\n          background: \"rgba(212, 175, 55, 0.1)\",\n          color: \"var(--primary-color)\",\n          fontSize: \"0.85rem\",\n          fontWeight: \"bold\",\n          marginBottom: \"1rem\",\n          border: \"1px solid var(--primary-color)\"\n        }}>\n          {t(\"visitor.home.badge\", \"Modo Visitante\")}\n        </div>\n\n        <h1 className=\"section-title\" style={{\n          fontSize: \"2.5rem\",\n          color: \"var(--primary-color)\",\n          marginBottom: \"0.5rem\",\n          fontFamily: \"'Georgia', serif\"\n        }}>\n          {t(\"visitor.home.title\", { name: name || t(\"common.visitor\", \"Visitante\") })}\n        </h1>\n\n        <p className=\"section-subtitle\" style={{\n          maxWidth: \"800px\",\n          fontSize: \"1.1rem\",\n          lineHeight: \"1.6\",\n          color: \"#B0A090\",\n          fontStyle: \"italic\"\n        }}>\n          {t(\"visitor.home.subtitle\", \"Explore a hist√≥ria e a cultura dos nossos museus com suporte a acessibilidade e guias inteligentes.\")}\n        </p>\n\n        <div style={{ display: \"flex\", gap: \"1rem\", marginTop: \"2rem\" }}>\n          <Link to=\"/trilhas\" className=\"btn btn-primary\" style={{ padding: \"0.8rem 2rem\", fontSize: \"1rem\" }}>\n            {t(\"visitor.home.startTrail\")}\n          </Link>\n          <Link to=\"/mapa\" className=\"btn btn-secondary\" style={{ padding: \"0.8rem 2rem\", fontSize: \"1rem\" }}>\n            {t(\"visitor.home.viewMap\")}\n          </Link>\n        </div>\n      </section>\n\n      {/* FEATURED ARTWORKS */}\n      <section style={{ marginBottom: \"3rem\" }}>\n        <h2 className=\"section-title\" style={{\n          fontSize: \"2rem\",\n          color: \"var(--primary-color)\",\n          fontFamily: \"'Georgia', serif\",\n          marginBottom: \"0.5rem\"\n        }}>\n          {t(\"visitor.home.featuredArtworks\")}\n        </h2>\n        <p className=\"section-subtitle\" style={{ color: \"#888\", marginBottom: \"1.5rem\" }}>\n          {t(\"visitor.home.featuredSubtitle\")}\n        </p>\n\n        {loading ? (\n          <div className=\"card-grid\" style={{ display: \"grid\", gridTemplateColumns: \"repeat(auto-fill, minmax(300px, 1fr))\", gap: \"1.5rem\" }}>\n            {[1, 2, 3].map(i => (\n              <div key={i} className=\"card\" style={{ height: \"250px\", animation: \"pulse 1.5s infinite\", background: \"rgba(255,255,255,0.05)\" }}></div>\n            ))}\n          </div>\n        ) : featuredWorks.length > 0 ? (\n          <div className=\"card-grid\" style={{ display: \"grid\", gridTemplateColumns: \"repeat(auto-fill, minmax(300px, 1fr))\", gap: \"1.5rem\" }}>\n            {featuredWorks.map(work => (\n              <article key={work.id} className=\"card\" style={{ display: \"flex\", flexDirection: \"column\" }}>\n                {work.imageUrl && (\n                  <div style={{\n                    height: \"180px\",\n                    width: \"100%\",\n                    marginBottom: \"1rem\",\n                    borderRadius: \"4px\",\n                    background: `url(${getFullUrl(work.imageUrl)}) center/cover no-repeat`,\n                    backgroundColor: \"#000\"\n                  }} />\n                )}\n                <h3 className=\"card-title\" style={{ fontSize: \"1.4rem\", marginBottom: \"0.5rem\" }}>{work.title}</h3>\n                <p className=\"card-subtitle\" style={{ fontSize: \"0.9rem\", color: \"#ccc\", fontStyle: \"italic\", marginBottom: \"1rem\" }}>\n                  {work.artist} {work.year ? `‚Ä¢ ${work.year}` : ''}\n                </p>\n                <div className=\"card-meta\" style={{ display: \"flex\", gap: \"0.5rem\", marginBottom: \"auto\" }}>\n                  {work.category && (\n                    <span className=\"chip\" style={{\n                      fontSize: \"0.75rem\",\n                      padding: \"2px 8px\",\n                      borderRadius: \"12px\",\n                      background: \"rgba(255,255,255,0.1)\",\n                      border: \"1px solid rgba(255,255,255,0.2)\"\n                    }}>\n                      {work.category.name || work.category}\n                    </span>\n                  )}\n                  <span className=\"chip\" style={{\n                    fontSize: \"0.75rem\",\n                    padding: \"2px 8px\",\n                    borderRadius: \"12px\",\n                    background: \"rgba(255,255,255,0.1)\",\n                    border: \"1px solid rgba(255,255,255,0.2)\"\n                  }}>\n                    Acess√≠vel\n                  </span>\n                </div>\n                <Link to={`/obras/${work.id}`} className=\"btn btn-secondary\" style={{ marginTop: \"1rem\", width: \"100%\", textAlign: \"center\" }}>\n                  {t(\"visitor.home.viewDetails\")}\n                </Link>\n              </article>\n            ))}\n          </div>\n        ) : (\n          <div className=\"card\" style={{ textAlign: \"center\", padding: \"3rem\", background: \"rgba(0,0,0,0.2)\", border: \"1px dashed rgba(255,255,255,0.1)\" }}>\n            <span style={{ fontSize: \"2rem\", display: \"block\", marginBottom: \"1rem\", opacity: 0.5 }}>üé®</span>\n            <p style={{ color: \"#aaa\" }}>{t(\"common.noResults\", \"Nenhuma obra em destaque no momento.\")}</p>\n          </div>\n        )}\n      </section>\n\n      {/* RECOMMENDED TRAILS */}\n      <section>\n        <h2 className=\"section-title\" style={{\n          fontSize: \"2rem\",\n          color: \"var(--primary-color)\",\n          fontFamily: \"'Georgia', serif\",\n          marginBottom: \"0.5rem\"\n        }}>\n          {t(\"visitor.home.recommendedTrails\")}\n        </h2>\n\n        {loading ? (\n          <div style={{ height: \"100px\" }}>Loading...</div>\n        ) : featuredTrails.length > 0 ? (\n          <div className=\"card-grid\" style={{ display: \"grid\", gridTemplateColumns: \"repeat(auto-fill, minmax(300px, 1fr))\", gap: \"1.5rem\", marginTop: \"1rem\" }}>\n            {featuredTrails.map(trail => (\n              <article key={trail.id} className=\"card\">\n                <h3 className=\"card-title\" style={{ fontSize: \"1.3rem\" }}>{trail.title}</h3>\n                <p style={{ color: \"var(--text-secondary)\", fontSize: \"0.9rem\", margin: \"0.5rem 0\" }}>{trail.description}</p>\n                <Link to={`/trilhas/${trail.id}`} className=\"btn btn-secondary\" style={{ marginTop: \"1rem\" }}>\n                  {t(\"visitor.home.viewTrails\")}\n                </Link>\n              </article>\n            ))}\n          </div>\n        ) : (\n          <p style={{ color: \"#666\" }}>{t(\"common.noResults\", \"Nenhuma trilha encontrada.\")}</p>\n        )}\n      </section>\n\n      <style>{`\n        @keyframes pulse {\n          0% { opacity: 0.6; }\n          50% { opacity: 0.3; }\n          100% { opacity: 0.6; }\n        }\n      `}</style>\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\LeaderboardPage.tsx","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'tenantId' is assigned a value but never used.","line":18,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":18,"endColumn":21},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\LeaderboardPage.tsx:24:9\n  22 |\n  23 |     useEffect(() => {\n> 24 |         setLoading(true);\n     |         ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  25 |         api.get(\"/leaderboard\")\n  26 |             .then(res => {\n  27 |                 if (res.data.ranking) {","line":24,"column":9,"nodeType":null,"endLine":24,"endColumn":19}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from \"react\";\r\nimport { useTranslation } from \"react-i18next\";\r\nimport { api } from \"../../../api/client\";\r\nimport { useAuth } from \"../../auth/AuthContext\";\r\nimport { getFullUrl } from \"../../../utils/url\";\r\n\r\ntype LeaderboardEntry = {\r\n    id: string;\r\n    name: string | null;\r\n    photoUrl: string | null;\r\n    xp: number;\r\n    rank: number;\r\n    achievementsCount: number;\r\n};\r\n\r\nexport const LeaderboardPage: React.FC = () => {\r\n    const { t } = useTranslation();\r\n    const { tenantId } = useAuth();\r\n    const [entries, setEntries] = useState<LeaderboardEntry[]>([]);\r\n    const [myRank, setMyRank] = useState<LeaderboardEntry | null>(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        setLoading(true);\r\n        api.get(\"/leaderboard\")\r\n            .then(res => {\r\n                if (res.data.ranking) {\r\n                    setEntries(res.data.ranking);\r\n                    setMyRank(res.data.myRank);\r\n                } else {\r\n                    setEntries(res.data);\r\n                }\r\n            })\r\n            .catch(err => console.error(\"Erro ao carregar ranking\", err))\r\n            .finally(() => setLoading(false));\r\n    }, []);\r\n\r\n    if (loading) return (\r\n        <div style={{ display: 'flex', flexDirection: 'column', justifyContent: 'center', alignItems: 'center', minHeight: '50vh', gap: '1rem' }}>\r\n            <div style={{ width: '40px', height: '40px', border: '3px solid var(--accent-gold)', borderTopColor: 'transparent', borderRadius: '50%', animation: 'spin 1s linear infinite' }}></div>\r\n            <p>{t(\"common.loading\")}</p>\r\n            <style>{`@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }`}</style>\r\n        </div>\r\n    );\r\n\r\n    const top3 = entries.slice(0, 3);\r\n    const rest = entries.slice(3);\r\n\r\n    const renderPodiumItem = (entry: LeaderboardEntry, place: number) => {\r\n        const placeClass = place === 1 ? 'first' : place === 2 ? 'second' : 'third';\r\n\r\n        return (\r\n            <div key={entry.id} className={`podium-item ${placeClass}`}>\r\n                <div className=\"podium-avatar-container\">\r\n                    {entry.photoUrl ? (\r\n                        <img src={getFullUrl(entry.photoUrl) ?? undefined} alt={entry.name || \"User\"} className=\"podium-avatar\" />\r\n                    ) : (\r\n                        <div className=\"podium-avatar\" style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '2rem' }}>üë§</div>\r\n                    )}\r\n                    <div className=\"podium-rank-badge\">\r\n                        {place}\r\n                    </div>\r\n                </div>\r\n                <div className=\"podium-name\">\r\n                    {entry.name || t(\"common.anonymous\", \"An√¥nimo\")}\r\n                </div>\r\n                <div className=\"podium-xp\">\r\n                    {entry.xp} XP\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const renderListItem = (entry: LeaderboardEntry, index: number, isMe: boolean = false) => (\r\n        <div key={entry.id || index} className={`leaderboard-item ${isMe ? 'is-me' : ''}`}>\r\n            <div className=\"item-rank\">\r\n                #{entry.rank}\r\n            </div>\r\n\r\n            {entry.photoUrl ? (\r\n                <img src={getFullUrl(entry.photoUrl) ?? undefined} alt={entry.name || \"User\"} className=\"item-avatar\" />\r\n            ) : (\r\n                <div className=\"item-avatar\" style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '1.5rem', background: 'var(--bg-elevated)' }}>üë§</div>\r\n            )}\r\n\r\n            <div className=\"item-info\">\r\n                <div className=\"item-name\">\r\n                    {entry.name || t(\"common.anonymous\", \"An√¥nimo\")}\r\n                    {isMe && <span className=\"item-me-tag\">{t(\"common.you\", \"(Voc√™)\")}</span>}\r\n                </div>\r\n            </div>\r\n\r\n            <div style={{ textAlign: 'right' }}>\r\n                <div className=\"item-xp\">{entry.xp}</div>\r\n                <span className=\"item-xp-label\">XP TOTAL</span>\r\n            </div>\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <div className=\"page-container\" style={{ paddingBottom: '100px' }}>\r\n            <div className=\"leaderboard-header\">\r\n                <h1 className=\"section-title\" style={{ fontSize: '2.5rem', marginBottom: '0.5rem' }}>{t(\"visitor.leaderboard.title\", \"Ranking Global\")}</h1>\r\n                <p className=\"section-subtitle\" style={{ fontSize: '1.1rem' }}>{t(\"visitor.leaderboard.subtitle\", \"Os maiores exploradores da cultura\")}</p>\r\n            </div>\r\n\r\n            {/* My Rank Top Card */}\r\n            {myRank && (\r\n                <div className=\"my-rank-card\">\r\n                    <div className=\"my-rank-info\">\r\n                        <div className=\"my-rank-number\">\r\n                            <span className=\"rank-label\">RANK</span>\r\n                            <span className=\"rank-value\">#{myRank.rank}</span>\r\n                        </div>\r\n                        <div>\r\n                            <div style={{ fontSize: '0.9rem', color: 'var(--fg-muted)', textTransform: 'uppercase' }}>{t(\"visitor.leaderboard.myRank\", \"Sua Posi√ß√£o\")}</div>\r\n                            <div style={{ fontSize: '1.2rem', fontWeight: 'bold', color: 'var(--fg-main)' }}>{myRank.name}</div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div style={{ textAlign: 'right' }}>\r\n                        <div style={{ fontSize: '2rem', fontWeight: 'bold', color: 'var(--accent-gold)' }}>{myRank.xp}</div>\r\n                        <div style={{ fontSize: '0.75rem', color: 'var(--fg-soft)', fontWeight: 'bold' }}>XP TOTAL</div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Podium */}\r\n            {entries.length > 0 && (\r\n                <div className=\"leaderboard-podium\">\r\n                    {entries[1] && renderPodiumItem(entries[1], 2)}\r\n                    {entries[0] && renderPodiumItem(entries[0], 1)}\r\n                    {entries[2] && renderPodiumItem(entries[2], 3)}\r\n                </div>\r\n            )}\r\n\r\n            {/* List */}\r\n            <div className=\"leaderboard-list\">\r\n                {rest.length === 0 && top3.length === 0 ? (\r\n                    <div className=\"card\" style={{ textAlign: 'center', padding: '3rem' }}>\r\n                        <div style={{ fontSize: '3rem', marginBottom: '1rem' }}>üèÜ</div>\r\n                        <p style={{ color: 'var(--fg-muted)' }}>{t(\"visitor.leaderboard.empty\", \"Nenhum visitante pontuou ainda.\")}</p>\r\n                    </div>\r\n                ) : (\r\n                    rest.map((entry) => renderListItem(entry, -1))\r\n                )}\r\n            </div>\r\n\r\n            {/* Sticky User Rank (Bottom) */}\r\n            {myRank && (\r\n                <div className=\"sticky-rank-bar\">\r\n                    <div style={{ maxWidth: '1200px', margin: '0 auto', display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>\r\n                        <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>\r\n                            <div style={{\r\n                                width: '40px', height: '40px', borderRadius: '50%',\r\n                                background: 'var(--accent-gold)', color: 'var(--bg-page)',\r\n                                display: 'flex', alignItems: 'center', justifyContent: 'center', fontWeight: 'bold'\r\n                            }}>\r\n                                #{myRank.rank}\r\n                            </div>\r\n                            <div>\r\n                                <div style={{ fontSize: '0.75rem', color: 'var(--fg-muted)' }}>{t(\"visitor.leaderboard.myRank\", \"Sua Posi√ß√£o\")}</div>\r\n                                <div style={{ fontWeight: 'bold' }}>{t(\"common.you\", \"Voc√™\")}</div>\r\n                            </div>\r\n                        </div>\r\n                        <div style={{ fontWeight: 'bold', color: 'var(--accent-gold)', fontSize: '1.2rem' }}>\r\n                            {myRank.xp} XP\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\MapView.tsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\MapView.tsx:20:7\n  18 |   useEffect(() => {\n  19 |     if (tenantId) {\n> 20 |       setLoading(true);\n     |       ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  21 |       // Fetch settings and works in parallel\n  22 |       Promise.all([\n  23 |         api.get(`/tenants/${tenantId}/settings`),","line":20,"column":7,"nodeType":null,"endLine":20,"endColumn":17},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'worksRes' is defined but never used.","line":26,"column":30,"nodeType":null,"messageId":"unusedVar","endLine":26,"endColumn":38}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { MuseumMap } from \"../components/MuseumMap\";\nimport { api } from \"../../../api/client\";\nimport { useAuth } from \"../../auth/AuthContext\";\n\nexport const MapView: React.FC = () => {\n  const { t } = useTranslation();\n  const { tenantId } = useAuth();\n  const [loading, setLoading] = useState(true);\n  const [mapSettings, setMapSettings] = useState<{\n    outdoorCenter: [number, number];\n    indoorImageUrl?: string;\n  } | null>(null);\n\n  const [pois, setPois] = useState<{ id: string; title: string; lat: number; lng: number; description: string }[]>([]);\n\n  useEffect(() => {\n    if (tenantId) {\n      setLoading(true);\n      // Fetch settings and works in parallel\n      Promise.all([\n        api.get(`/tenants/${tenantId}/settings`),\n        api.get(`/works`, { params: { tenantId } })\n      ])\n        .then(([settingsRes, worksRes]) => {\n          const s = settingsRes.data;\n          setMapSettings({\n            outdoorCenter: [s.latitude || -20.385574, s.longitude || -43.503578],\n            indoorImageUrl: s.mapImageUrl\n          });\n\n          // Map works to POIs if they have coordinates (simulated for now as works might not have x/y yet)\n          // In a real app, works would have x/y coordinates for the indoor map.\n          // For now, we filter works that might have location data or just show a few as example if we had the data.\n          // Since the backend Work model doesn't explicitly have x/y for indoor map yet, \n          // we will just show an empty list or a placeholder if no works have location.\n          // But to make it \"real\", let's assume we might add x/y to works later. \n          // For now, let's just use the works list to populate if we had the data.\n\n          // As we don't have x/y in Work model yet, we will just leave POIs empty to be honest,\n          // or maybe map some if the description contains \"Sala 1\" etc?\n          // Let's keep it empty to avoid \"fake\" data, but ready to receive.\n          setPois([]);\n        })\n        .catch(err => console.error(\"Erro ao carregar dados do mapa\", err))\n        .finally(() => setLoading(false));\n    } else {\n      setLoading(false);\n    }\n  }, [tenantId]);\n\n  if (loading) return (\n    <div style={{ display: 'flex', flexDirection: 'column', justifyContent: 'center', alignItems: 'center', minHeight: '50vh', gap: '1rem' }}>\n      <div className=\"spinner\" style={{ width: \"40px\", height: \"40px\", border: \"4px solid var(--border)\", borderTopColor: \"var(--primary)\", borderRadius: \"50%\", animation: \"spin 1s linear infinite\" }}></div>\n      <p>{t(\"common.loading\")}</p>\n      <style>{`@keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }`}</style>\n    </div>\n  );\n\n  if (!tenantId) return <div className=\"p-8 text-center\">{t(\"visitor.map.selectMuseum\", \"Selecione um museu para ver o mapa.\")}</div>;\n\n  if (!mapSettings) return <div className=\"p-8 text-center\">{t(\"visitor.map.notConfigured\", \"Mapa n√£o configurado para este museu.\")}</div>;\n\n  return (\n    <div>\n      <h1 className=\"section-title\">{t(\"visitor.map.title\")}</h1>\n      <p className=\"section-subtitle\">\n        {t(\"visitor.map.subtitle\")}\n      </p>\n\n      <div style={{ marginTop: \"1rem\" }}>\n        <MuseumMap\n          outdoorCenter={mapSettings.outdoorCenter}\n          indoorImageUrl={mapSettings.indoorImageUrl}\n          pois={pois}\n        />\n      </div>\n\n      <div className=\"card\" style={{ marginTop: \"1rem\", padding: \"1rem\" }}>\n        <h3>üìç {t(\"visitor.map.legend\")}</h3>\n        <ul style={{ listStyle: \"none\", padding: 0, marginTop: \"0.5rem\" }}>\n          <li style={{ marginBottom: \"0.5rem\" }}>üèõÔ∏è <b>{t(\"visitor.map.legendMain\", \"Museu Principal\")}</b>: {t(\"visitor.map.legendAddress\", \"Pra√ßa Tiradentes, 123\")}</li>\n          <li>üé® <b>{t(\"visitor.map.legendExhibition\", \"Exposi√ß√£o Permanente\")}</b>: {t(\"visitor.map.legendFloors\", \"1¬∫ e 2¬∫ Andar\")}</li>\n        </ul>\n      </div>\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\MuseumPlatformer.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The 'levels' logical expression could make the dependencies of useCallback Hook (at line 464) change on every render. To fix this, wrap the initialization of 'levels' in its own useMemo() Hook.","line":292,"column":11,"nodeType":"VariableDeclarator","endLine":292,"endColumn":67},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"The ref value 'game.current' will likely have changed by the time this effect cleanup function runs. If this ref points to a node rendered by React, copy 'game.current' to a variable inside the effect, and use that variable in the cleanup function.","line":788,"column":43,"nodeType":"Identifier","endLine":788,"endColumn":50}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":292,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":292,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13403,13406],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13403,13406],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":292,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":292,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13429,13432],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13429,13432],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: This value cannot be modified\n\nModifying a value previously passed as an argument to a hook is not allowed. Consider moving the modification before calling the hook.\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\MuseumPlatformer.tsx:515:21\n  513 |                 if (tile.type === 'E' || tile.type === 'S' || tile.type === 'F' || tile.type === 'B') {\n  514 |                     // eslint-disable-next-line react-hooks/immutability\n> 515 |                     tile.animFrame = ((tile.animFrame || 0) + 1) % 4;\n      |                     ^^^^ `game` cannot be modified\n  516 |                 }\n  517 |             }\n  518 |         }","line":515,"column":21,"nodeType":null,"endLine":515,"endColumn":25,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useEffect, useRef, useState, useCallback } from 'react';\r\nimport { ArrowLeft, RefreshCw, Trophy, ChevronRight, Star } from 'lucide-react';\r\nimport { api } from '../../../api/client';\r\nimport { useAuth } from '../../auth/AuthContext';\r\n\r\n// --- GAME CONSTANTS ---\r\nconst TILE_SIZE = 40;\r\nconst GRAVITY = 0.5;\r\nconst FRICTION = 0.8;\r\nconst JUMP_FORCE = -12;\r\nconst SPEED = 5;\r\nconst ANIMATION_FRAME_DURATION = 150; // ms per frame\r\n\r\n// --- SPRITE SHEET CONFIG ---\r\nconst SPRITE_SHEETS = {\r\n    player: {\r\n        walk: { src: '/assets/characters/visitor_walk.png', frames: 4, frameWidth: 256 },\r\n        jump: { src: '/assets/characters/visitor_jump.png', frames: 1, frameWidth: 256 },\r\n    },\r\n    enemy: {\r\n        walk: { src: '/assets/characters/enemy_walk.png', frames: 4, frameWidth: 256 },\r\n    },\r\n    statue: {\r\n        walk: { src: '/assets/characters/statue_walk.png', frames: 4, frameWidth: 256 },\r\n    },\r\n    frame: {\r\n        walk: { src: '/assets/characters/frame_walk.png', frames: 4, frameWidth: 256 },\r\n    },\r\n    boss: {\r\n        attack: { src: '/assets/characters/boss_attack.png', frames: 3, frameWidth: 341 },\r\n    }\r\n};\r\n\r\n// --- CONFIGURATION (Default Theme - \"Museum Guardian\" AAA) ---\r\nconst DEFAULT_THEME = {\r\n    name: 'Guardi√£o do Museu',\r\n    colors: {\r\n        sky: '#1a1a2e',        // Deep Museum Night\r\n        ground: '#2D1B0E',     // Rich Dark Wood\r\n        platform: '#4A3728',   // Mahogany\r\n        player: '#00ACC1',     // Teal (matches visitor jacket)\r\n        coin: '#FFD700',       // Gold\r\n        goal: '#66BB6A',       // Green Exit\r\n        spike: '#8B0000'       // Dark Red Danger\r\n    },\r\n    // AAA Parallax Backgrounds\r\n    backgrounds: {\r\n        far: '/assets/game/bg_far.png',\r\n        mid: '/assets/game/bg_mid.png',\r\n        platform: '/assets/game/platform.png',\r\n        artifact: '/assets/game/artifact.png'\r\n    },\r\n    // 10 Progressive Levels\r\n    levels: [\r\n        // Level 1: Reception (Tutorial)\r\n        [\r\n            \"..................................................\",\r\n            \"..................................................\",\r\n            \"..................................................\",\r\n            \"......................CC..........................\",\r\n            \".....................====.........................\",\r\n            \"............CC....................................\",\r\n            \"...........====...................CC..............\",\r\n            \".................................====.............\",\r\n            \"....C.........................................G...\",\r\n            \".......................^^^...................###..\",\r\n            \"##################################################\"\r\n        ],\r\n        // Level 2: Main Hall (Verticality)\r\n        [\r\n            \"..................................................\",\r\n            \"..............................................G...\",\r\n            \".............................................==...\",\r\n            \"......................................CC..........\",\r\n            \".....................................====.........\",\r\n            \"......................CC..........................\",\r\n            \"............CC.......====.........................\",\r\n            \"...........====...................................\",\r\n            \"..................................===.............\",\r\n            \"....C.............................................\",\r\n            \"##################################################\"\r\n        ],\r\n        // Level 3: Ancient Gallery (Introducing Enemies)\r\n        [\r\n            \"..................................................\",\r\n            \"..................................................\",\r\n            \"......................................G...........\",\r\n            \"..........................E..........===..........\",\r\n            \".........................====.....................\",\r\n            \".............E....................................\",\r\n            \"............====..................................\",\r\n            \".......................CC......CC.................\",\r\n            \"....C.................====....====................\",\r\n            \"..................................................\",\r\n            \"##################################################\"\r\n        ],\r\n        // Level 4: Sculpture Garden (Precision Jumps)\r\n        [\r\n            \"..................................................\",\r\n            \"...........................................G......\",\r\n            \"..........................................===.....\",\r\n            \"..................................===.............\",\r\n            \"..........................===.....................\",\r\n            \"..................===............S................\",\r\n            \"..........===...................===...............\",\r\n            \"..................................................\",\r\n            \"....C.............S......................^^^......\",\r\n            \".................===....................#####.....\",\r\n            \"##################################################\"\r\n        ],\r\n        // Level 5: Egyptian Wing (Traps)\r\n        [\r\n            \"..................................................\",\r\n            \"..................................................\",\r\n            \".....................................G............\",\r\n            \"....................................===...........\",\r\n            \"..........................^^......................\",\r\n            \".........................====.....................\",\r\n            \".............^^...................................\",\r\n            \"............====...................^^.............\",\r\n            \"....C.............................====............\",\r\n            \".......................^^^........................\",\r\n            \"##################################################\"\r\n        ],\r\n        // Level 6: Grand Hall (Mixed Challenge)\r\n        [\r\n            \"..................................................\",\r\n            \".........................................G........\",\r\n            \"............................E...........===.......\",\r\n            \"...........................===....................\",\r\n            \"..................................................\",\r\n            \".............S.......................S............\",\r\n            \"............====....................====..........\",\r\n            \".......................^^.........................\",\r\n            \"....C.................====........................\",\r\n            \"..................................................\",\r\n            \"######...#######...#######...#######...###########\"\r\n        ],\r\n        // Level 7: Dark Attic (Floating Platforms)\r\n        [\r\n            \"..................................................\",\r\n            \"..................................................\",\r\n            \"..............................................G...\",\r\n            \".............................................==...\",\r\n            \".....................................==...........\",\r\n            \"...........................==.....................\",\r\n            \".................==...............................\",\r\n            \".......==.........................................\",\r\n            \"....C.........................E...........E.......\",\r\n            \"..............^^^............===.........===......\",\r\n            \"##################################################\"\r\n        ],\r\n        // Level 8: Restoration Lab (Mechanism Focus)\r\n        [\r\n            \"..................................................\",\r\n            \"................G.................................\",\r\n            \"...............===................................\",\r\n            \".........................F................F.......\",\r\n            \".......................====.............====......\",\r\n            \".............F....................................\",\r\n            \"...........====...................................\",\r\n            \"..................................................\",\r\n            \"....C.........................^^^.................\",\r\n            \".............................#####................\",\r\n            \"##################################################\"\r\n        ],\r\n        // Level 9: Clock Tower (High Danger)\r\n        [\r\n            \"..................................................\",\r\n            \"..................................................\",\r\n            \"................................................G.\",\r\n            \"...............................................==.\",\r\n            \"......................................==..........\",\r\n            \".............................==...................\",\r\n            \"....................==............................\",\r\n            \"...........==.....................................\",\r\n            \"....C.............................................\",\r\n            \"...................^^^...................^^^......\",\r\n            \"#####....#####....#####....#####....#####....#####\"\r\n        ],\r\n        // Level 10: The Vault (Boss Fight)\r\n        [\r\n            \"..................................................\",\r\n            \"..................................................\",\r\n            \"..................................................\",\r\n            \"..................................................\",\r\n            \"..................................................\",\r\n            \".........................B........................\",\r\n            \"..................................................\",\r\n            \"..................................................\",\r\n            \"....C.........................................G...\",\r\n            \"..................................................\",\r\n            \"##################################################\"\r\n        ]\r\n    ]\r\n};\r\n\r\n// --- TYPES ---\r\ninterface Entity {\r\n    x: number;\r\n    y: number;\r\n    width: number;\r\n    height: number;\r\n    vx: number;\r\n    vy: number;\r\n    isGrounded: boolean;\r\n    isDead: boolean;\r\n}\r\n\r\ninterface Particle {\r\n    x: number;\r\n    y: number;\r\n    vx: number;\r\n    vy: number;\r\n    life: number;\r\n    color: string;\r\n}\r\n\r\ninterface GameTile {\r\n    x: number;\r\n    y: number;\r\n    type: string;\r\n    collected?: boolean;\r\n    vx?: number;\r\n    vy?: number;\r\n    animFrame?: number;\r\n    originX?: number;\r\n    originY?: number;\r\n}\r\n\r\ninterface LeaderboardEntry {\r\n    userId: string;\r\n    name: string;\r\n    xp: number;\r\n    level: number;\r\n    rank?: number;\r\n}\r\n\r\n// Pre-load images for animation\r\nconst preloadedImages: { [key: string]: HTMLImageElement } = {};\r\nconst preloadImages = () => {\r\n    // Preload sprite sheets\r\n    Object.entries(SPRITE_SHEETS).forEach(([entityType, animations]) => {\r\n        Object.entries(animations).forEach(([animName, config]) => {\r\n            const key = `${entityType}_${animName}`;\r\n            const img = new Image();\r\n            img.src = config.src;\r\n            preloadedImages[key] = img;\r\n        });\r\n    });\r\n\r\n    // Preload AAA backgrounds\r\n    const bgImages = [\r\n        { key: 'bg_far', src: '/assets/game/bg_far.png' },\r\n        { key: 'bg_mid', src: '/assets/game/bg_mid.png' },\r\n        { key: 'platform', src: '/assets/game/platform.png' },\r\n        { key: 'artifact', src: '/assets/game/artifact.png' }\r\n    ];\r\n    bgImages.forEach(({ key, src }) => {\r\n        const img = new Image();\r\n        img.src = src;\r\n        preloadedImages[key] = img;\r\n    });\r\n};\r\npreloadImages();\r\n\r\n\r\nexport const MuseumPlatformer: React.FC<{ onClose: () => void; theme?: typeof DEFAULT_THEME }> = ({ onClose, theme = DEFAULT_THEME }) => {\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n    const { tenantId } = useAuth(); // Need tenantId for leaderboard\r\n\r\n    // Character Options\r\n    const CHARACTERS = [\r\n        { id: 'male_light', name: 'Visitante 1', sprite: '/assets/characters/visitor_male_light.png', color: '#FFE0B2' },\r\n        { id: 'male_medium', name: 'Visitante 2', sprite: '/assets/characters/visitor_male_medium.png', color: '#BCAAA4' },\r\n        { id: 'male_dark', name: 'Visitante 3', sprite: '/assets/characters/visitor_male_dark.png', color: '#6D4C41' },\r\n        { id: 'female_light', name: 'Visitante 4', sprite: '/assets/characters/visitor_female_light.png', color: '#FFE0B2' },\r\n        { id: 'female_medium', name: 'Visitante 5', sprite: '/assets/characters/visitor_female_medium.png', color: '#BCAAA4' },\r\n        { id: 'female_dark', name: 'Visitante 6', sprite: '/assets/characters/visitor_female_dark.png', color: '#6D4C41' },\r\n    ];\r\n\r\n    // UI State\r\n    const [gameState, setGameState] = useState<'SELECT_CHARACTER' | 'START' | 'PLAYING' | 'GAMEOVER' | 'WIN' | 'CAMPAIGN_WIN'>('SELECT_CHARACTER');\r\n    const [selectedCharacter, setSelectedCharacter] = useState(CHARACTERS[0]);\r\n    const [score, setScore] = useState(0);\r\n    const [coins, setCoins] = useState(0);\r\n    const [leaderboard, setLeaderboard] = useState<LeaderboardEntry[]>([]);\r\n    const [currentLevelIdx, setCurrentLevelIdx] = useState(0);\r\n\r\n    // Normalize theme levels (support single or array)\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    const levels = (theme as any).levels || [(theme as any).level];\r\n\r\n    // Game Mutable State (Ref to avoid re-renders in loop)\r\n    const game = useRef({\r\n        player: { x: 50, y: 50, width: 60, height: 80, vx: 0, vy: 0, isGrounded: false, isDead: false } as Entity,\r\n        keys: { left: false, right: false, up: false },\r\n        camera: { x: 0 },\r\n        tiles: [] as GameTile[],\r\n        particles: [] as Particle[],\r\n        levelWidth: 0,\r\n        levelHeight: 0,\r\n        animationFrame: 0,\r\n        // Animation State\r\n        playerAnimFrame: 0,\r\n        lastFrameTime: 0,\r\n        facingRight: true,\r\n    });\r\n\r\n    // Player sprite based on character selection\r\n    const playerSpriteRef = useRef<HTMLImageElement | null>(null);\r\n\r\n    const fetchLeaderboard = useCallback(async () => {\r\n        if (!tenantId) return;\r\n        try {\r\n            const res = await api.get(`/gamification/leaderboard?tenantId=${tenantId}`);\r\n            setLeaderboard(res.data);\r\n        } catch (e) {\r\n            console.error(\"Failed to load leaderboard\", e);\r\n        }\r\n    }, [tenantId]);\r\n\r\n    const spawnParticles = useCallback((x: number, y: number, color: string, count: number) => {\r\n        for (let i = 0; i < count; i++) {\r\n            game.current.particles.push({\r\n                x, y,\r\n                vx: (Math.random() - 0.5) * 10,\r\n                vy: (Math.random() - 0.5) * 10,\r\n                life: 1.0,\r\n                color\r\n            });\r\n        }\r\n    }, []);\r\n\r\n    const saveProgress = useCallback(async () => {\r\n        console.log(\"Saving XP:\", score);\r\n        try {\r\n            await api.post('/gamification/xp', { amount: score + 500, reason: 'GAME_WIN' });\r\n        } catch (e) { console.error(e); }\r\n    }, [score]);\r\n\r\n    const die = useCallback(() => {\r\n        game.current.player.isDead = true;\r\n        setGameState('GAMEOVER');\r\n        spawnParticles(game.current.player.x, game.current.player.y, theme.colors.player, 20);\r\n    }, [theme, spawnParticles]);\r\n\r\n    const checkCollision = useCallback((p: Entity, tiles: GameTile[], axis: 'x' | 'y') => {\r\n        for (const tile of tiles) {\r\n            if (tile.collected) continue; // Skip collected coins\r\n\r\n            // AABB Collision Test\r\n            if (\r\n                p.x < tile.x + (tile.type === 'B' ? 60 : TILE_SIZE) && // Boss is wider\r\n                p.x + p.width > tile.x &&\r\n                p.y < tile.y + (tile.type === 'B' ? 60 : TILE_SIZE) &&\r\n                p.y + p.height > tile.y\r\n            ) {\r\n                // Determine Type Behavior\r\n                if (tile.type === 'C') {\r\n                    // Collect Coin\r\n                    tile.collected = true;\r\n                    setCoins(prev => prev + 1);\r\n                    setScore(prev => prev + 100);\r\n                    spawnParticles(tile.x + TILE_SIZE / 2, tile.y + TILE_SIZE / 2, theme.colors.coin, 5);\r\n                    continue; // No physical collision\r\n                }\r\n\r\n                if (tile.type === 'E' || tile.type === 'B') {\r\n                    // Enemy Interaction\r\n                    // Mario Logic: Jump on top to kill?\r\n                    const isJumpingOnTop = p.vy > 0 && p.y + p.height < tile.y + 20;\r\n\r\n                    if (isJumpingOnTop) {\r\n                        // Kill Enemy\r\n                        tile.collected = true; // \"Kill\" by hiding\r\n                        p.vy = -8; // Bounce\r\n                        setScore(prev => prev + (tile.type === 'B' ? 1000 : 200));\r\n                        spawnParticles(tile.x, tile.y, '#555', 10);\r\n                        if (tile.type === 'B') {\r\n                            // Boss Defeated!\r\n                        }\r\n                    } else {\r\n                        // Die\r\n                        die();\r\n                        return;\r\n                    }\r\n                    continue;\r\n                }\r\n\r\n                if (tile.type === 'G') {\r\n                    // Level Goal Reached\r\n                    if (currentLevelIdx < levels.length - 1) {\r\n                        setGameState('WIN'); // Intermediate Win\r\n                    } else {\r\n                        setGameState('CAMPAIGN_WIN'); // Final Win\r\n                        saveProgress();\r\n                    }\r\n                    return;\r\n                }\r\n\r\n                if (tile.type === '^') {\r\n                    die();\r\n                    return;\r\n                }\r\n\r\n                // Solid Block Collision (# or =)\r\n                if (axis === 'x') {\r\n                    if (tile.type === 'E' || tile.type === 'B') continue;\r\n\r\n                    if (p.vx > 0) p.x = tile.x - p.width;\r\n                    if (p.vx < 0) p.x = tile.x + TILE_SIZE;\r\n                    p.vx = 0;\r\n                } else {\r\n                    if (tile.type === 'E' || tile.type === 'B') continue;\r\n\r\n                    if (p.vy > 0) { // Falling\r\n                        p.y = tile.y - p.height;\r\n                        p.isGrounded = true;\r\n                        p.vy = 0;\r\n                    } else if (p.vy < 0) { // Hitting head\r\n                        p.y = tile.y + TILE_SIZE;\r\n                        p.vy = 0;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }, [currentLevelIdx, levels.length, theme, die, saveProgress, spawnParticles]);\r\n\r\n    const initLevel = useCallback((levelIndex: number = 0) => {\r\n        const tiles = [];\r\n        const rows = levels[levelIndex];\r\n        if (!rows) return;\r\n\r\n        game.current.levelHeight = rows.length * TILE_SIZE;\r\n        game.current.levelWidth = rows[0].length * TILE_SIZE;\r\n\r\n        for (let r = 0; r < rows.length; r++) {\r\n            for (let c = 0; c < rows[r].length; c++) {\r\n                const char = rows[r][c];\r\n                if (char !== '.') {\r\n                    tiles.push({\r\n                        x: c * TILE_SIZE,\r\n                        y: r * TILE_SIZE,\r\n                        type: char,\r\n                        vx: 0,\r\n                        vy: 0,\r\n                        originX: c * TILE_SIZE,\r\n                        originY: r * TILE_SIZE\r\n                    });\r\n                }\r\n            }\r\n        }\r\n        game.current.tiles = tiles;\r\n        game.current.player = { x: 50, y: 50, width: 60, height: 80, vx: 0, vy: 0, isGrounded: false, isDead: false };\r\n        game.current.camera.x = 0;\r\n\r\n        if (levelIndex === 0) {\r\n            setCoins(0);\r\n            setScore(0);\r\n        }\r\n\r\n        setGameState('PLAYING');\r\n    }, [levels]);\r\n\r\n    const handleKeyDown = useCallback((e: KeyboardEvent) => {\r\n        if (e.code === 'ArrowLeft' || e.code === 'KeyA') game.current.keys.left = true;\r\n        if (e.code === 'ArrowRight' || e.code === 'KeyD') game.current.keys.right = true;\r\n        if (e.code === 'ArrowUp' || e.code === 'Space' || e.code === 'KeyW') {\r\n            game.current.keys.up = true;\r\n        }\r\n    }, []);\r\n\r\n    const handleKeyUp = useCallback((e: KeyboardEvent) => {\r\n        if (e.code === 'ArrowLeft' || e.code === 'KeyA') game.current.keys.left = false;\r\n        if (e.code === 'ArrowRight' || e.code === 'KeyD') game.current.keys.right = false;\r\n        if (e.code === 'ArrowUp' || e.code === 'Space' || e.code === 'KeyW') game.current.keys.up = false;\r\n    }, []);\r\n\r\n    const update = useCallback(() => {\r\n        if (gameState !== 'PLAYING') return;\r\n        const { player, keys, tiles } = game.current;\r\n\r\n        // --- 1. MOVEMENT & PHYSICS ---\r\n        if (keys.left) {\r\n            player.vx = -SPEED;\r\n            game.current.facingRight = false;\r\n        }\r\n        if (keys.right) {\r\n            player.vx = SPEED;\r\n            game.current.facingRight = true;\r\n        }\r\n        if (!keys.left && !keys.right) player.vx *= FRICTION;\r\n\r\n        // Jump\r\n        if (keys.up && player.isGrounded) {\r\n            player.vy = JUMP_FORCE;\r\n            player.isGrounded = false;\r\n        }\r\n\r\n        player.vy += GRAVITY;\r\n\r\n        // --- ANIMATION FRAME UPDATE ---\r\n        const now = performance.now();\r\n        if (now - game.current.lastFrameTime > ANIMATION_FRAME_DURATION) {\r\n            game.current.lastFrameTime = now;\r\n            if (Math.abs(player.vx) > 0.5) {\r\n                game.current.playerAnimFrame = (game.current.playerAnimFrame + 1) % 4;\r\n            } else {\r\n                game.current.playerAnimFrame = 0;\r\n            }\r\n            for (const tile of tiles) {\r\n                if (tile.type === 'E' || tile.type === 'S' || tile.type === 'F' || tile.type === 'B') {\r\n                    // eslint-disable-next-line react-hooks/immutability\r\n                    tile.animFrame = ((tile.animFrame || 0) + 1) % 4;\r\n                }\r\n            }\r\n        }\r\n\r\n        // --- 2. X COLLISION ---\r\n        player.x += player.vx;\r\n        checkCollision(player, tiles, 'x');\r\n\r\n        // --- 3. Y COLLISION ---\r\n        player.y += player.vy;\r\n        player.isGrounded = false;\r\n        checkCollision(player, tiles, 'y');\r\n\r\n        // --- 4. GAME OVER/WIN CHECK ---\r\n        if (player.y > game.current.levelHeight) {\r\n            die();\r\n        }\r\n\r\n        // --- 5. CAMERA ---\r\n        game.current.camera.x = player.x - 400;\r\n        if (game.current.camera.x < 0) game.current.camera.x = 0;\r\n        if (game.current.camera.x > game.current.levelWidth - 800) game.current.camera.x = game.current.levelWidth - 800;\r\n\r\n        // --- 6. PARTICLES ---\r\n        for (let i = game.current.particles.length - 1; i >= 0; i--) {\r\n            const p = game.current.particles[i];\r\n            p.x += p.vx;\r\n            p.y += p.vy;\r\n            p.vy += 0.2;\r\n            p.life -= 0.05;\r\n            if (p.life <= 0) game.current.particles.splice(i, 1);\r\n        }\r\n\r\n        // --- 7. ENTITIES ---\r\n        for (const tile of tiles) {\r\n            if (tile.type === 'E') {\r\n                if (!tile.vx) tile.vx = -2;\r\n                tile.x += tile.vx;\r\n                if (!tile.originX) tile.originX = tile.x;\r\n                if (tile.x < tile.originX - 100) tile.vx = 2;\r\n                if (tile.x > tile.originX + 100) tile.vx = -2;\r\n            }\r\n            if (tile.type === 'B') {\r\n                if (!tile.vx) tile.vx = 3;\r\n                tile.x += tile.vx;\r\n                if (!tile.originX) tile.originX = tile.x;\r\n                if (tile.x < tile.originX - 200) tile.vx = 3;\r\n                if (tile.x > tile.originX + 200) tile.vx = -3;\r\n                if (Math.random() < 0.02) tile.y -= 10;\r\n                if (tile.y < (tile.originY || 0)) tile.y += 1;\r\n            }\r\n        }\r\n    }, [gameState, die, checkCollision]);\r\n\r\n    const draw = useCallback((ctx: CanvasRenderingContext2D) => {\r\n        const canvasW = ctx.canvas.width;\r\n        const canvasH = ctx.canvas.height;\r\n        const cameraX = game.current.camera.x;\r\n\r\n        // Backgrounds\r\n        const gradient = ctx.createLinearGradient(0, 0, 0, canvasH);\r\n        gradient.addColorStop(0, theme.colors.sky);\r\n        gradient.addColorStop(0.5, '#302b63');\r\n        gradient.addColorStop(1, '#24243e');\r\n        ctx.fillStyle = gradient;\r\n        ctx.fillRect(0, 0, canvasW, canvasH);\r\n\r\n        const bgFar = preloadedImages['bg_far'];\r\n        if (bgFar && bgFar.complete) {\r\n            const parallaxFar = cameraX * 0.1;\r\n            const bgWidth = canvasW * 1.5;\r\n            const bgX = -(parallaxFar % bgWidth);\r\n            ctx.drawImage(bgFar, bgX, 0, bgWidth, canvasH);\r\n            ctx.drawImage(bgFar, bgX + bgWidth, 0, bgWidth, canvasH);\r\n        }\r\n\r\n        const bgMid = preloadedImages['bg_mid'];\r\n        if (bgMid && bgMid.complete) {\r\n            const parallaxMid = cameraX * 0.3;\r\n            const midY = canvasH * 0.4;\r\n            const midH = canvasH * 0.6;\r\n            const midW = canvasW * 2;\r\n            const midX = -(parallaxMid % midW);\r\n            ctx.globalAlpha = 0.9;\r\n            ctx.drawImage(bgMid, midX, midY, midW, midH);\r\n            ctx.drawImage(bgMid, midX + midW, midY, midW, midH);\r\n            ctx.globalAlpha = 1;\r\n        }\r\n\r\n        // Vignette\r\n        const vignetteGradient = ctx.createRadialGradient(\r\n            canvasW / 2, canvasH / 2, canvasH * 0.3,\r\n            canvasW / 2, canvasH / 2, canvasH\r\n        );\r\n        vignetteGradient.addColorStop(0, 'rgba(0,0,0,0)');\r\n        vignetteGradient.addColorStop(1, 'rgba(0,0,0,0.4)');\r\n        ctx.fillStyle = vignetteGradient;\r\n        ctx.fillRect(0, 0, canvasW, canvasH);\r\n\r\n        ctx.save();\r\n        ctx.translate(-cameraX, 0);\r\n\r\n        const platformImg = preloadedImages['platform'];\r\n        const artifactImg = preloadedImages['artifact'];\r\n\r\n        for (const tile of game.current.tiles) {\r\n            if (tile.collected) continue;\r\n\r\n            if (tile.type === '#' || tile.type === '=') {\r\n                if (platformImg && platformImg.complete) {\r\n                    ctx.drawImage(platformImg, tile.x, tile.y, TILE_SIZE, TILE_SIZE);\r\n                } else {\r\n                    ctx.fillStyle = theme.colors.platform;\r\n                    ctx.fillRect(tile.x, tile.y, TILE_SIZE, TILE_SIZE);\r\n                    ctx.strokeStyle = '#D4AF37';\r\n                    ctx.strokeRect(tile.x + 1, tile.y + 1, TILE_SIZE - 2, TILE_SIZE - 2);\r\n                }\r\n                continue;\r\n            }\r\n\r\n            if (tile.type === 'C') {\r\n                if (artifactImg && artifactImg.complete) {\r\n                    ctx.shadowColor = theme.colors.coin;\r\n                    ctx.shadowBlur = 15;\r\n                    ctx.drawImage(artifactImg, tile.x - 5, tile.y - 5, TILE_SIZE + 10, TILE_SIZE + 10);\r\n                    ctx.shadowBlur = 0;\r\n                } else {\r\n                    ctx.fillStyle = theme.colors.coin;\r\n                    ctx.beginPath();\r\n                    ctx.arc(tile.x + TILE_SIZE / 2, tile.y + TILE_SIZE / 2, 15, 0, Math.PI * 2);\r\n                    ctx.fill();\r\n                }\r\n                continue;\r\n            }\r\n\r\n            if (tile.type === '^') {\r\n                ctx.fillStyle = theme.colors.spike;\r\n                ctx.beginPath();\r\n                ctx.moveTo(tile.x, tile.y + TILE_SIZE);\r\n                ctx.lineTo(tile.x + TILE_SIZE / 2, tile.y);\r\n                ctx.lineTo(tile.x + TILE_SIZE, tile.y + TILE_SIZE);\r\n                ctx.fill();\r\n                continue;\r\n            }\r\n\r\n            if (tile.type === 'G') {\r\n                ctx.fillStyle = theme.colors.goal;\r\n                ctx.fillRect(tile.x, tile.y, TILE_SIZE, TILE_SIZE);\r\n                continue;\r\n            }\r\n\r\n            if (tile.type === 'E') {\r\n                const enemyImg = preloadedImages['enemy_walk'];\r\n                if (enemyImg && enemyImg.complete) {\r\n                    const sheet = SPRITE_SHEETS.enemy.walk;\r\n                    const frameWidth = sheet.frameWidth;\r\n                    const frame = tile.animFrame || 0;\r\n                    const sx = frame * frameWidth;\r\n                    ctx.drawImage(enemyImg, sx, 0, frameWidth, enemyImg.height, tile.x - 10, tile.y - 20, 60, 60);\r\n                } else {\r\n                    ctx.fillStyle = '#FF5722';\r\n                    ctx.fillRect(tile.x, tile.y + 10, TILE_SIZE, TILE_SIZE - 10);\r\n                }\r\n                continue;\r\n            }\r\n\r\n            if (tile.type === 'B') {\r\n                const bossImg = preloadedImages['boss_attack'];\r\n                if (bossImg && bossImg.complete) {\r\n                    const sheet = SPRITE_SHEETS.boss.attack;\r\n                    const frameWidth = sheet.frameWidth;\r\n                    const frame = (tile.animFrame || 0) % 3;\r\n                    const sx = frame * frameWidth;\r\n                    ctx.drawImage(bossImg, sx, 0, frameWidth, bossImg.height, tile.x - 30, tile.y - 40, 120, 100);\r\n                } else {\r\n                    ctx.fillStyle = '#880E4F';\r\n                    ctx.fillRect(tile.x, tile.y, 60, 60);\r\n                }\r\n                continue;\r\n            }\r\n        }\r\n\r\n        // Draw Player\r\n        if (!game.current.player.isDead) {\r\n            const p = game.current.player;\r\n            const isMoving = Math.abs(p.vx) > 0.5;\r\n            const playerImg = playerSpriteRef.current;\r\n\r\n            if (playerImg && playerImg.complete) {\r\n                const totalFrames = 4;\r\n                const frameWidth = playerImg.width / totalFrames;\r\n                const frameHeight = playerImg.height;\r\n                const frame = isMoving ? game.current.playerAnimFrame % totalFrames : 0;\r\n                const sx = frame * frameWidth;\r\n\r\n                ctx.save();\r\n                if (!game.current.facingRight) {\r\n                    ctx.translate(p.x + p.width, p.y);\r\n                    ctx.scale(-1, 1);\r\n                    ctx.drawImage(playerImg, sx, 0, frameWidth, frameHeight, 0, -20, 80, 100);\r\n                } else {\r\n                    ctx.drawImage(playerImg, sx, 0, frameWidth, frameHeight, p.x - 10, p.y - 20, 80, 100);\r\n                }\r\n                ctx.restore();\r\n            } else {\r\n                ctx.fillStyle = selectedCharacter.color;\r\n                ctx.fillRect(p.x, p.y, p.width, p.height);\r\n            }\r\n        }\r\n\r\n        // Particles\r\n        for (const p of game.current.particles) {\r\n            ctx.fillStyle = p.color;\r\n            ctx.globalAlpha = p.life;\r\n            ctx.fillRect(p.x, p.y, 6, 6);\r\n            ctx.globalAlpha = 1;\r\n        }\r\n\r\n        ctx.restore();\r\n    }, [theme, selectedCharacter]);\r\n\r\n    const animateRef = useRef<() => void>(() => { });\r\n\r\n    const animate = useCallback(() => {\r\n        update();\r\n        const canvas = canvasRef.current;\r\n        if (canvas) {\r\n            const ctx = canvas.getContext('2d');\r\n            if (ctx) draw(ctx);\r\n        }\r\n        game.current.animationFrame = requestAnimationFrame(animateRef.current);\r\n    }, [update, draw]);\r\n\r\n    useEffect(() => {\r\n        animateRef.current = animate;\r\n    }, [animate]);\r\n\r\n    const nextLevel = useCallback(() => {\r\n        if (currentLevelIdx < levels.length - 1) {\r\n            setCurrentLevelIdx(prev => prev + 1);\r\n        } else {\r\n            setGameState('CAMPAIGN_WIN');\r\n            saveProgress();\r\n        }\r\n    }, [currentLevelIdx, levels.length, saveProgress]);\r\n\r\n    // Effects\r\n    useEffect(() => {\r\n        const img = new Image();\r\n        img.src = selectedCharacter.sprite;\r\n        img.onload = () => {\r\n            playerSpriteRef.current = img;\r\n        };\r\n    }, [selectedCharacter]);\r\n\r\n    useEffect(() => {\r\n        if (gameState === 'GAMEOVER' || gameState === 'CAMPAIGN_WIN') {\r\n            fetchLeaderboard();\r\n        }\r\n    }, [gameState, fetchLeaderboard]);\r\n\r\n    useEffect(() => {\r\n        if (gameState === 'PLAYING') {\r\n            initLevel(currentLevelIdx);\r\n            window.addEventListener('keydown', handleKeyDown);\r\n            window.addEventListener('keyup', handleKeyUp);\r\n\r\n            game.current.animationFrame = requestAnimationFrame(animate);\r\n\r\n            return () => {\r\n                window.removeEventListener('keydown', handleKeyDown);\r\n                window.removeEventListener('keyup', handleKeyUp);\r\n                cancelAnimationFrame(game.current.animationFrame);\r\n            };\r\n        }\r\n    }, [currentLevelIdx, initLevel, handleKeyDown, handleKeyUp, animate, gameState]);\r\n\r\n    // --- RENDER UI ---\r\n    return (\r\n        <div className=\"fixed inset-0 bg-gradient-to-b from-gray-900 to-gray-800 z-50 flex flex-col items-center justify-center p-4\">\r\n\r\n            {/* CHARACTER SELECTION SCREEN */}\r\n            {gameState === 'SELECT_CHARACTER' && (\r\n                <div className=\"flex flex-col items-center justify-center w-full max-w-3xl\">\r\n                    {/* Logo */}\r\n                    <img src=\"/assets/characters/select_male.jpg\" alt=\"Art Run Select\" className=\"w-full max-w-md rounded-xl mb-6 shadow-2xl\" />\r\n\r\n                    <h2 className=\"text-3xl font-black text-white mb-6 tracking-wider\">SELECT YOUR VISITOR</h2>\r\n\r\n                    {/* Character Grid */}\r\n                    <div className=\"grid grid-cols-3 gap-4 mb-8\">\r\n                        {CHARACTERS.map((char) => (\r\n                            <button\r\n                                key={char.id}\r\n                                onClick={() => setSelectedCharacter(char)}\r\n                                className={`\r\n                                        p-4 rounded-xl border-4 transition-all hover:scale-105\r\n                                        ${selectedCharacter.id === char.id\r\n                                        ? 'border-yellow-400 bg-yellow-400/20 shadow-lg shadow-yellow-400/30'\r\n                                        : 'border-gray-600 bg-gray-700/50 hover:border-gray-500'}\r\n                                    `}\r\n                            >\r\n                                <div\r\n                                    className=\"w-16 h-16 rounded-full mx-auto mb-2\"\r\n                                    style={{ backgroundColor: char.color }}\r\n                                />\r\n                                <p className=\"text-white text-sm font-medium\">{char.name}</p>\r\n                            </button>\r\n                        ))}\r\n                    </div>\r\n\r\n                    {/* Start Button */}\r\n                    <button\r\n                        onClick={() => {\r\n                            setCurrentLevelIdx(0);\r\n                            initLevel(0);\r\n                        }}\r\n                        className=\"px-12 py-4 bg-gradient-to-r from-blue-500 to-cyan-500 text-white text-xl font-black rounded-xl hover:scale-105 transition-all shadow-xl shadow-blue-500/30\"\r\n                    >\r\n                        JOGAR AGORA!\r\n                    </button>\r\n\r\n                    <button onClick={onClose} className=\"mt-4 text-gray-400 hover:text-white text-sm\">\r\n                        ‚Üê Voltar aos Desafios\r\n                    </button>\r\n                </div>\r\n            )}\r\n\r\n            {/* GAME UI (only show when not selecting character) */}\r\n            {gameState !== 'SELECT_CHARACTER' && (\r\n                <>\r\n                    {/* Header / Score */}\r\n                    <div className=\"absolute top-4 left-4 right-4 flex justify-between items-center text-white pointer-events-none\">\r\n                        <div className=\"flex gap-4 text-xl font-bold font-mono\">\r\n                            <span className=\"text-yellow-400\">COINS: {coins}</span>\r\n                            <span>SCORE: {score}</span>\r\n                            <span className=\"text-gray-400 text-sm\">Level {currentLevelIdx + 1}/{levels.length}</span>\r\n                        </div>\r\n                        <div>\r\n                            <button onClick={onClose} className=\"pointer-events-auto bg-white/10 p-2 rounded hover:bg-white/20\">\r\n                                <ArrowLeft className=\"w-6 h-6\" />\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Game Canvas */}\r\n                    <div className=\"relative rounded-2xl overflow-hidden shadow-2xl border-4 border-gray-800\">\r\n                        <canvas\r\n                            ref={canvasRef}\r\n                            width={800}\r\n                            height={450}\r\n                            className=\"bg-sky-300 max-w-full h-auto\"\r\n                        />\r\n\r\n                        {/* Overlays */}\r\n                        {gameState === 'GAMEOVER' && (\r\n                            <div className=\"absolute inset-0 bg-black/80 flex flex-col items-center justify-center text-white p-4\">\r\n                                <h2 className=\"text-5xl font-black mb-2 text-red-500\">GAME OVER</h2>\r\n                                <p className=\"mb-6 font-mono text-xl\">Score: {score}</p>\r\n\r\n                                {/* Mini Leaderboard */}\r\n                                <div className=\"bg-white/10 p-4 rounded-xl mb-6 w-full max-w-sm backdrop-blur-md\">\r\n                                    <h3 className=\"text-yellow-400 font-bold mb-2 flex items-center gap-2\"><Trophy size={16} /> TOP PLAYERS</h3>\r\n                                    <div className=\"space-y-2 text-sm\">\r\n                                        {leaderboard.slice(0, 3).map((p, i) => (\r\n                                            <div key={i} className=\"flex justify-between border-b border-white/10 pb-1\">\r\n                                                <span>#{p.rank} {p.name}</span>\r\n                                                <span className=\"text-yellow-400 font-mono\">{p.xp} XP</span>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <button\r\n                                    onClick={() => initLevel(currentLevelIdx)}\r\n                                    className=\"flex items-center gap-2 px-8 py-3 bg-red-600 rounded-xl hover:bg-red-700 font-bold transition-transform hover:scale-105\"\r\n                                >\r\n                                    <RefreshCw /> Tentar Novamente\r\n                                </button>\r\n                                <button onClick={onClose} className=\"mt-4 text-gray-400 hover:text-white\">Sair</button>\r\n                            </div>\r\n                        )}\r\n\r\n                        {gameState === 'WIN' && (\r\n                            <div className=\"absolute inset-0 bg-black/85 flex flex-col items-center justify-center text-white text-center p-8\">\r\n                                <Trophy className=\"w-20 h-20 text-yellow-400 mb-4 animate-bounce\" />\r\n                                <h2 className=\"text-4xl font-black mb-2 text-yellow-500\">LEVEL COMPLETED!</h2>\r\n                                <p className=\"mb-6 opacity-80\">Voc√™ completou a fase {currentLevelIdx + 1}/{levels.length}</p>\r\n                                <p className=\"text-2xl font-mono mb-6 text-green-400\">Score Atual: {score} XP</p>\r\n\r\n                                <button\r\n                                    onClick={() => nextLevel()}\r\n                                    className=\"px-8 py-3 bg-green-600 rounded-lg hover:bg-green-700 font-bold shadow-lg shadow-green-600/20 flex items-center gap-2\"\r\n                                >\r\n                                    Pr√≥xima Fase <ChevronRight />\r\n                                </button>\r\n                            </div>\r\n                        )}\r\n\r\n                        {gameState === 'CAMPAIGN_WIN' && (\r\n                            <div className=\"absolute inset-0 bg-black/90 flex flex-col items-center justify-center text-white text-center p-8\">\r\n                                <div className=\"relative\">\r\n                                    <Star className=\"w-24 h-24 text-yellow-500 mb-4 animate-spin-slow\" />\r\n                                    <Trophy className=\"w-12 h-12 text-white absolute top-6 left-6\" />\r\n                                </div>\r\n                                <h2 className=\"text-5xl font-black mb-2 text-transparent bg-clip-text bg-gradient-to-r from-yellow-400 to-orange-500\">\r\n                                    CAMPAIGN CLEARED!\r\n                                </h2>\r\n                                <p className=\"mb-6 text-xl text-gray-300\">Voc√™ zerou a campanha \"{theme.name || 'Art Run'}\"!</p>\r\n                                <div className=\"bg-white/10 p-6 rounded-2xl mb-8 border border-white/20\">\r\n                                    <p className=\"text-sm uppercase tracking-widest text-gray-400 mb-2\">XP TOTAL</p>\r\n                                    <p className=\"text-6xl font-mono font-bold text-green-400\">{score + 1000}</p>\r\n                                </div>\r\n\r\n                                {/* Leaderboard */}\r\n                                <div className=\"w-full max-w-sm mb-6\">\r\n                                    <h3 className=\"text-left text-sm font-bold text-yellow-500 mb-2\">RANKING FINAL</h3>\r\n                                    <div className=\"bg-black/50 rounded-lg p-2 max-h-40 overflow-y-auto\">\r\n                                        {leaderboard.map((p, i) => (\r\n                                            <div key={i} className=\"flex justify-between border-b border-light/10 py-1 text-sm\">\r\n                                                <span>#{p.rank} {p.name}</span>\r\n                                                <span>{p.xp}</span>\r\n                                            </div>\r\n                                        ))}\r\n                                    </div>\r\n                                </div>\r\n\r\n                                <button\r\n                                    onClick={onClose}\r\n                                    className=\"px-10 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 rounded-xl hover:scale-105 transition-all font-bold shadow-xl lg:text-xl\"\r\n                                >\r\n                                    Voltar ao Menu\r\n                                </button>\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n\r\n                    {/* Mobile Controls Hint */}\r\n                    <div className=\"mt-4 text-gray-500 text-sm font-mono hidden md:block\">\r\n                        Controls: Arrows / WASD to Move ‚Ä¢ SPACE to Jump\r\n                    </div>\r\n\r\n                    {/* Mobile Touch Controls */}\r\n                    <div className=\"md:hidden w-full max-w-lg mt-4 flex justify-between gap-4 select-none\">\r\n                        <div className=\"flex gap-2\">\r\n                            <ControlBtn\r\n                                onDown={() => { game.current.keys.left = true; }}\r\n                                onUp={() => { game.current.keys.left = false; }}\r\n                                icon=\"‚Üê\"\r\n                            />\r\n                            <ControlBtn\r\n                                onDown={() => { game.current.keys.right = true; }}\r\n                                onUp={() => { game.current.keys.right = false; }}\r\n                                icon=\"‚Üí\"\r\n                            />\r\n                        </div>\r\n                        <ControlBtn\r\n                            onDown={() => { game.current.keys.up = true; }}\r\n                            onUp={() => { game.current.keys.up = false; }}\r\n                            icon=\"JUMP\"\r\n                            large\r\n                        />\r\n                    </div>\r\n                </>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\ninterface ControlBtnProps {\r\n    onDown: () => void;\r\n    onUp: () => void;\r\n    icon: React.ReactNode;\r\n    large?: boolean;\r\n}\r\n\r\nconst ControlBtn: React.FC<ControlBtnProps> = ({ onDown, onUp, icon, large }) => (\r\n    <button\r\n        onPointerDown={(e) => { e.preventDefault(); onDown(); }}\r\n        onPointerUp={(e) => { e.preventDefault(); onUp(); }}\r\n        onPointerLeave={(e) => { e.preventDefault(); onUp(); }}\r\n        className={`\r\n            flex items-center justify-center rounded-2xl bg-white/10 active:bg-white/30 text-white font-bold backdrop-blur-sm border border-white/20 transition-all active:scale-95\r\n            ${large ? 'w-24 h-16 text-sm bg-blue-500/30' : 'w-16 h-16 text-2xl'}\r\n        `}\r\n    >\r\n        {icon}\r\n    </button>\r\n);\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\Passport.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\QrVisit.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\ScannerPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\SchedulingPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\SelectMuseum.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\ShopPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\SmartItineraryResult.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\SmartItineraryWizard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\Souvenir.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\TrailDetail.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\TrailDetail.tsx:40:5\n  38 |\n  39 |     // eslint-disable-next-line react-hooks/set-state-in-effect\n> 40 |     setApiLoading(true);\n     |     ^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  41 |     setError(false);\n  42 |     api\n  43 |       .get(`/trails/${id}`)","line":40,"column":5,"nodeType":null,"endLine":40,"endColumn":18,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":46,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":46,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1494,1497],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1494,1497],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":50,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1678,1681],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1678,1681],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\TrailsList.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\TrailsList.tsx:26:5\n  24 |\n  25 |     // eslint-disable-next-line react-hooks/set-state-in-effect\n> 26 |     setLoading(true);\n     |     ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  27 |     api\n  28 |       .get(\"/trails\", { params: { tenantId } })\n  29 |       .then((res) => {","line":26,"column":5,"nodeType":null,"endLine":26,"endColumn":15,"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":31,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":31,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[930,933],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[930,933],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\TreasureHunt.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\TreasureHunt.tsx:33:13\n  31 |         if (tenantId) {\n  32 |             // eslint-disable-next-line react-hooks/set-state-in-effect\n> 33 |             setLoading(true);\n     |             ^^^^^^^^^^ Avoid calling setState() directly within an effect\n  34 |             api.get(\"/gamification/treasure-hunt\", { params: { tenantId } })\n  35 |                 .then(res => {\n  36 |                     setClues(res.data.clues || []);","line":33,"column":13,"nodeType":null,"endLine":33,"endColumn":23,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\VisitorProfile.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\VisualScannerPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\Welcome.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\WorkDetail.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'isFavorite'. Either include it or remove the dependency array.","line":76,"column":6,"nodeType":"ArrayExpression","endLine":76,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [id, isFavorite]","fix":{"range":[3263,3267],"text":"[id, isFavorite]"}}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":143,"column":92,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":143,"endColumn":95,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5481,5484],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5481,5484],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\WorksList.tsx","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1157,1160],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1157,1160],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":56,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":59,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1172,1175],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1172,1175],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\pages\\themes\\CasaFiatTheme.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\modules\\visitor\\services\\StampService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\services\\navigationService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\test\\setup.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\tests\\setup.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\tests\\translations.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\types\\auth.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\src\\utils\\url.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\test-connection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\luiza\\Documents\\PicWish\\museus-frontend\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]